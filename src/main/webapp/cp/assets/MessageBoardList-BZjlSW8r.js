import{d as A,r as b,o as G,b as v,c,w as a,h as e,a6 as ue,a2 as re,i as me,P as M,aF as h,aG as H,b3 as g,j as ie,k as i,g as F,aO as K,v as p,x as f,u as pe,ar as fe,I as ge,bi as ve,l as R,bs as be,aW as _e,b5 as z,m as ye,a3 as ce,bK as Be,bo as Ve,bp as $e,t as O,bm as ke,aZ as we,e as Ee,y as ze,aQ as Ce,X as Se,aP as Ue,bq as De,br as Ie}from"./index-__TSAjOL.js";import{E as Me}from"./el-pagination-BCmSIrki.js";import{E as qe,a as Te,b as Pe}from"./el-select-CPBsiljt.js";import{b as Le,E as Fe}from"./el-radio-group-B2Xrve8Z.js";/* empty css                        */import{E as Re}from"./el-popover-B2t_MYt0.js";import{d as W,u as he,c as Ne,a as Qe,b as Ye,e as je}from"./interaction-MowfY9gB.js";import{a as Oe,_ as Ae,b as Ge,c as He}from"./QueryItem.vue_vue_type_script_setup_true_lang-CDNlcHM_.js";import{E as Ke}from"./el-switch-Cg-m0Y0i.js";import{h as We}from"./config-BS48XX7b.js";import{T as Xe}from"./Tinymce-DiWOJB96.js";import{_ as Ze}from"./DialogForm.vue_vue_type_script_setup_true_lang-CYMSRniG.js";const Je={key:0},xe=A({name:"MessageBoardForm",__name:"MessageBoardForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(q){const C=b(),l=b({}),V=b([]),S=async()=>{V.value=await We()};return G(async()=>{S()}),(y,t)=>{const w=K,U=Te,$=qe,m=me,r=re,_=ie,D=Ke,T=Pe,E=ue;return v(),c(Ze,{values:l.value,"onUpdate:values":t[11]||(t[11]=u=>l.value=u),name:y.$t("menu.interaction.messageBoard"),"query-bean":i(Qe),"create-bean":i(Ne),"update-bean":i(he),"delete-bean":i(W),"bean-id":q.beanId,"bean-ids":q.beanIds,focus:C.value,"init-values":()=>{var u;return{typeId:(u=V.value[0])==null?void 0:u.id,userType:1,open:!0,status:0}},"to-values":u=>({...u}),perms:"messageBoard","model-value":q.modelValue,large:"","onUpdate:modelValue":t[12]||(t[12]=u=>y.$emit("update:modelValue",u)),onFinished:t[13]||(t[13]=()=>y.$emit("finished"))},{"header-status":a(({isEdit:u})=>[u?(v(),M(h,{key:0},[l.value.status!=null?(v(),M("span",Je,[l.value.status===0?(v(),c(w,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[p(f(y.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):l.value.status===1?(v(),c(w,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[p(f(y.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):l.value.status===2?(v(),c(w,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[p(f(y.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):(v(),c(w,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>t[14]||(t[14]=[p("unknown")])),_:1}))])):F("",!0)],64)):F("",!0)]),default:a(({isEdit:u})=>[e(E,null,{default:a(()=>[e(r,{span:24},{default:a(()=>[e(m,{prop:"typeId",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(g,{message:"messageBoard.type"})]),default:a(()=>[e($,{modelValue:l.value.typeId,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.typeId=o),class:"w-full"},{default:a(()=>[(v(!0),M(h,null,H(V.value,o=>(v(),c(U,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"title",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(g,{message:"messageBoard.title"})]),default:a(()=>[e(_,{ref_key:"focus",ref:C,modelValue:l.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.title=o),maxlength:"150"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"text",rules:{required:!0,message:()=>y.$t("v.required")}},{label:a(()=>[e(g,{message:"messageBoard.text"})]),default:a(()=>[e(_,{modelValue:l.value.text,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.text=o),type:"textarea",rows:8,maxlength:"65535"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),u?(v(),c(r,{key:0,span:24},{default:a(()=>[e(m,{prop:"replyText"},{label:a(()=>[e(g,{message:"messageBoard.replyText"})]),default:a(()=>[e(i(Xe),{modelValue:l.value.replyText,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.replyText=o),class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),e(r,{span:12},{default:a(()=>[e(m,{prop:"contact"},{label:a(()=>[e(g,{message:"messageBoard.contact"})]),default:a(()=>[e(_,{modelValue:l.value.contact,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.contact=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"nickname"},{label:a(()=>[e(g,{message:"messageBoard.nickname"})]),default:a(()=>[e(_,{modelValue:l.value.nickname,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.nickname=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"phone"},{label:a(()=>[e(g,{message:"messageBoard.phone"})]),default:a(()=>[e(_,{modelValue:l.value.phone,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.phone=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"email"},{label:a(()=>[e(g,{message:"messageBoard.email"})]),default:a(()=>[e(_,{modelValue:l.value.email,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.email=o),maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"address"},{label:a(()=>[e(g,{message:"messageBoard.address"})]),default:a(()=>[e(_,{modelValue:l.value.address,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.address=o),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"open"},{label:a(()=>[e(g,{message:"messageBoard.open"})]),default:a(()=>[e(D,{modelValue:l.value.open,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.open=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"recommended"},{label:a(()=>[e(g,{message:"messageBoard.recommended"})]),default:a(()=>[e(D,{modelValue:l.value.recommended,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.recommended=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replied"},{label:a(()=>[e(g,{message:"messageBoard.replied"})]),default:a(()=>[e(D,{"model-value":l.value.replied,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"ip"},{label:a(()=>[e(g,{message:"messageBoard.ip"})]),default:a(()=>[e(_,{"model-value":l.value.ip,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"user"},{label:a(()=>[e(g,{message:"messageBoard.user"})]),default:a(()=>{var o;return[e(_,{"model-value":(o=l.value.user)==null?void 0:o.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"created"},{label:a(()=>[e(g,{message:"messageBoard.created"})]),default:a(()=>[e(T,{"model-value":l.value.created,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replyUser"},{label:a(()=>[e(g,{message:"messageBoard.replyUser"})]),default:a(()=>{var o;return[e(_,{"model-value":(o=l.value.replyUser)==null?void 0:o.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replyDate"},{label:a(()=>[e(g,{message:"messageBoard.replyDate"})]),default:a(()=>[e(T,{"model-value":l.value.replyDate,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value"])}}}),ea={class:"mb-3"},aa={class:"space-x-2"},la={class:"app-block"},va=A({name:"MessageBoardList",__name:"MessageBoardList",setup(q){var Y;const{t:C}=pe(),l=b({}),V=b(),S=b(1),y=b(10),t=b(0),w=b(),U=b([]),$=b([]),m=b(!1),r=b(!1),_=b(),D=fe(()=>U.value.map(s=>s.id)),T=ge(),E=b(Number((Y=T.query.status)!=null?Y:"-1")),u=async()=>{m.value=!0;try{const{content:s,totalElements:n}=await Ye({...ve(l.value),Q_EQ_status_Short:E.value!==-1?E.value:void 0,Q_OrderBy:V.value,page:S.value,pageSize:y.value});U.value=s,t.value=Number(n)}finally{m.value=!1}};G(u);const o=({column:s,prop:n,order:k})=>{var P;n&&k?V.value=((P=s.sortBy)!=null?P:n)+(k==="descending"?"_desc":""):V.value=void 0,u()},X=()=>u(),Z=()=>{w.value.clearSort(),be(l.value),V.value=void 0,u()},J=()=>{_.value=void 0,r.value=!0},N=s=>{_.value=s,r.value=!0},Q=async s=>{await W(s),u(),O.success(C("success"))},x=async(s,n)=>{await je(s,n),u(),O.success(C("success"))};return(s,n)=>{const k=ye,P=ce,ee=$e,ae=Ve,le=ke,j=Re,L=Le,se=Fe,B=Ce,I=K,te=Ue,oe=Me,de=ze;return v(),M("div",null,[R("div",ea,[e(i(Ae),{params:l.value,onSearch:X,onReset:Z},{default:a(()=>[e(i(Oe),{label:s.$t("messageBoard.title"),name:"Q_Contains_title"},null,8,["label"])]),_:1},8,["params"])]),R("div",aa,[e(k,{type:"primary",disabled:i(z)("messageBoard:create"),icon:i(_e),onClick:n[0]||(n[0]=()=>J())},{default:a(()=>[p(f(s.$t("add")),1)]),_:1},8,["disabled","icon"]),e(le,{disabled:$.value.length<=0||i(z)("messageBoard:updateStatus")},{dropdown:a(()=>[e(ae,null,{default:a(()=>[(v(),M(h,null,H([0,1,2],d=>e(ee,{key:d,onClick:()=>x($.value.map(ne=>ne.id),d)},{default:a(()=>[p(f(s.$t("messageBoard.status.".concat(d))),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:a(()=>[e(k,{disabled:$.value.length<=0||i(z)("messageBoard:updateStatus")},{default:a(()=>[p(f(s.$t("messageBoard.op.status")),1),e(P,{class:"el-icon--right"},{default:a(()=>[e(i(Be))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["disabled"]),e(j,{title:s.$t("confirmDelete"),onConfirm:n[1]||(n[1]=()=>Q($.value.map(d=>d.id)))},{reference:a(()=>[e(k,{disabled:$.value.length<=0||i(z)("messageBoard:delete"),icon:i(we)},{default:a(()=>[p(f(s.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(i(Ge),{name:"messageBoard"})]),e(se,{modelValue:E.value,"onUpdate:modelValue":n[2]||(n[2]=d=>E.value=d),class:"mt-3",onChange:n[3]||(n[3]=()=>u())},{default:a(()=>[e(L,{value:-1},{default:a(()=>[p(f(s.$t("all")),1)]),_:1}),e(L,{value:0},{default:a(()=>[p(f(s.$t("messageBoard.status.0")),1)]),_:1}),e(L,{value:1},{default:a(()=>[p(f(s.$t("messageBoard.status.1")),1)]),_:1}),e(L,{value:2},{default:a(()=>[p(f(s.$t("messageBoard.status.2")),1)]),_:1})]),_:1},8,["modelValue"]),R("div",la,[Ee((v(),c(te,{ref_key:"table",ref:w,data:U.value,onSelectionChange:n[4]||(n[4]=d=>$.value=d),onRowDblclick:n[5]||(n[5]=d=>N(d.id)),onSortChange:o},{default:a(()=>[e(i(He),{name:"messageBoard"},{default:a(()=>[e(B,{type:"selection",width:"38"}),e(B,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(B,{property:"title",label:s.$t("messageBoard.title"),"min-width":"260",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(B,{property:"type.name",label:s.$t("messageBoard.type"),"min-width":"80","sort-by":"type@dict-name",sortable:"custom"},null,8,["label"]),e(B,{property:"user.username",label:s.$t("messageBoard.user"),"min-width":"80","sort-by":"user-username",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(B,{property:"created",label:s.$t("messageBoard.created"),"min-width":"120",sortable:"custom","show-overflow-tooltip":""},{default:a(({row:d})=>[p(f(i(Se)(d.created).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),e(B,{property:"replied",label:s.$t("messageBoard.replied"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[e(I,{type:d.replied?"success":"info",size:"small","disable-transitions":""},{default:a(()=>[p(f(s.$t(d.replied?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(B,{property:"status",label:s.$t("messageBoard.status"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[d.status===0?(v(),c(I,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[p(f(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):d.status===1?(v(),c(I,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[p(f(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):d.status===2?(v(),c(I,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[p(f(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):(v(),c(I,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>n[11]||(n[11]=[p("unknown")])),_:1}))]),_:1},8,["label"]),e(B,{label:s.$t("table.action")},{default:a(({row:d})=>[e(k,{type:"primary",disabled:i(z)("messageBoard:update"),size:"small",link:"",onClick:()=>N(d.id)},{default:a(()=>[p(f(s.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(j,{title:s.$t("confirmDelete"),onConfirm:()=>Q([d.id])},{reference:a(()=>[e(k,{type:"primary",disabled:i(z)("messageBoard:delete"),size:"small",link:""},{default:a(()=>[p(f(s.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[de,m.value]]),e(oe,{"current-page":S.value,"onUpdate:currentPage":n[6]||(n[6]=d=>S.value=d),"page-size":y.value,"onUpdate:pageSize":n[7]||(n[7]=d=>y.value=d),total:t.value,"page-sizes":i(Ie),layout:i(De),size:"small",background:"",class:"justify-end px-3 py-2",onSizeChange:n[8]||(n[8]=()=>u()),onCurrentChange:n[9]||(n[9]=()=>u())},null,8,["current-page","page-size","total","page-sizes","layout"])]),e(xe,{modelValue:r.value,"onUpdate:modelValue":n[10]||(n[10]=d=>r.value=d),"bean-id":_.value,"bean-ids":D.value,onFinished:u},null,8,["modelValue","bean-id","bean-ids"])])}}});export{va as default};
