import{d as R,u as B,r as E,Y as D,o as k,X as r,a0 as m,b,P as C,l as s,h as c,w as u,aF as x,aG as N,v as S,x as V,a2 as z,a6 as P}from"./index-__TSAjOL.js";import{b as F,E as I}from"./el-radio-group-B2Xrve8Z.js";/* empty css                        */import{c as L,d as q}from"./stat-Cegt4dzu.js";const G={class:"p-3 mt-3 app-block"},O={class:"p-3 mt-3 app-block"},W={class:"p-3 mt-3 app-block"},A=R({__name:"VisitRegion",setup($){const{t:d,n:f}=B(),p=E("last30day"),v=e=>{switch(e){case"today":return r().format("YYYY-MM-DD");case"yesterday":return r().subtract(1,"day").format("YYYY-MM-DD");case"last7day":return r().subtract(6,"day").format("YYYY-MM-DD");case"last30day":return r().subtract(29,"day").format("YYYY-MM-DD");case"lastYear":return r().subtract(1,"year").format("YYYY-MM-DD");default:return}},Y=e=>e==="yesterday"?r().subtract(1,"day").format("YYYY-MM-DD"):r().format("YYYY-MM-DD"),_=D(),M=async e=>{const n=await L({begin:v(e),end:Y(e)}),i=n.reduce((t,y)=>t+Number(y.pvCount),0),l={title:{text:d("menu.stat.visitCountry"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>f(t*100/i,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitCountry"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:Number(t.pvCount),name:t.name}))}]},o=_.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(l),window.addEventListener("resize",function(){a&&a.resize()})},g=D(),w=async e=>{const n=await q({begin:v(e),end:Y(e)}),i=n.reduce((t,y)=>t+Number(y.pvCount),0),l={title:{text:d("menu.stat.visitProvince"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>f(t*100/i,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitProvince"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:Number(t.pvCount),name:t.name}))}]},o=g.value;if(o==null)return;let a=m.getInstanceByDom(o);a==null&&(a=m.init(o)),a.setOption(l),window.addEventListener("resize",function(){a&&a.resize()})},h=async e=>{M(e),w(e)};return k(async()=>{h(p.value)}),(e,n)=>{const i=F,l=I,o=z,a=P;return b(),C("div",null,[s("div",G,[s("div",null,[c(l,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=t=>p.value=t),onChange:n[1]||(n[1]=t=>h(t))},{default:u(()=>[(b(),C(x,null,N(["today","yesterday","last7day","last30day","lastYear","all"],t=>c(i,{key:t,value:t},{default:u(()=>[S(V(e.$t("visit.".concat(t))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])]),c(a,{gutter:12},{default:u(()=>[c(o,{span:12},{default:u(()=>[s("div",O,[s("div",{ref_key:"countryChartRef",ref:_,class:"h-80"},null,512)])]),_:1}),c(o,{span:12},{default:u(()=>[s("div",W,[s("div",{ref_key:"provinceChartRef",ref:g,class:"h-80"},null,512)])]),_:1})]),_:1})])}}});export{A as default};
