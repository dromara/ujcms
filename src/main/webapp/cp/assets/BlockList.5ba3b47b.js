var G=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var N=(e,s,m)=>s in e?G(e,s,{enumerable:!0,configurable:!0,writable:!0,value:m}):e[s]=m,z=(e,s)=>{for(var m in s||(s={}))Z.call(s,m)&&N(e,m,s[m]);if(L)for(var m of L(s))x.call(s,m)&&N(e,m,s[m]);return e},j=(e,s)=>X(e,Y(s));import{g as O,D as g,m as p,o as b,j as y,w as i,n as l,q as H,A as ee,F as le,v as C,J as h,y as c,u as ae,i as oe,L as te,x as F,k as u,ac as ie,aj as ne,K as se,ai as de,ab as me}from"./vendor.6c10456e.js";import{_ as re,p as D,d as ue,r as pe,o as be}from"./index.7a0e1ff0.js";import{A as ce,B as fe,C as ge,D as R,c as he,E as $e}from"./config.5989ee23.js";import{_ as Ve,b as ke,a as ye,c as Ie}from"./QueryItem.08153dac.js";import{_ as _e}from"./ListMove.8a454c07.js";import{_ as ve}from"./DialogForm.54cc25ff.js";const we=O({components:{DialogForm:ve},props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(){const e=g();return{queryBlock:ce,createBlock:fe,updateBlock:ge,deleteBlock:R,focus:e}}});function qe(e,s,m,v,W,B){const $=p("el-input"),r=p("el-form-item"),w=p("el-radio"),U=p("el-radio-group"),q=p("el-switch"),I=p("el-input-number"),V=p("dialog-form");return b(),y(V,{name:e.$t("menu.config.block"),queryBean:e.queryBlock,createBean:e.createBlock,updateBean:e.updateBlock,deleteBean:e.deleteBlock,beanId:e.beanId,beanIds:e.beanIds,focus:e.focus,initValues:a=>({scope:0,withImage:!1,imageWidth:300,imageHeight:200,mobileImageWidth:300,mobileImageHeight:200,withMobileImage:!1,enabled:!0}),toValues:a=>z({},a),perms:"block","model-value":e.modelValue,"onUpdate:modelValue":s[0]||(s[0]=a=>e.$emit("update:modelValue",a)),onFinished:s[1]||(s[1]=a=>e.$emit("finished"))},{default:i(({values:a})=>[l(r,{prop:"name",label:e.$t("block.name"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l($,{modelValue:a.name,"onUpdate:modelValue":n=>a.name=n,ref:"focus",maxlength:"50"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),l(r,{prop:"alias",label:e.$t("block.alias"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l($,{modelValue:a.alias,"onUpdate:modelValue":n=>a.alias=n,maxlength:"50"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),l(r,{prop:"scope",label:e.$t("block.scope"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(U,{modelValue:a.scope,"onUpdate:modelValue":n=>a.scope=n},{default:i(()=>[(b(),H(le,null,ee([0,2],n=>l(w,{key:n,label:n},{default:i(()=>[h(c(e.$t(`block.scope.${n}`)),1)]),_:2},1032,["label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),l(r,{prop:"withDescription",label:e.$t("block.withDescription"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(q,{modelValue:a.withDescription,"onUpdate:modelValue":n=>a.withDescription=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),l(r,{prop:"withImage",label:e.$t("block.withImage"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(q,{modelValue:a.withImage,"onUpdate:modelValue":n=>a.withImage=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),a.withImage?(b(),y(r,{key:0,prop:"imageWidth",label:e.$t("block.imageWidth"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(I,{modelValue:a.imageWidth,"onUpdate:modelValue":n=>a.imageWidth=n,min:0,max:65535},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"])):C("",!0),a.withImage?(b(),y(r,{key:1,prop:"imageHeight",label:e.$t("block.imageHeight"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(I,{modelValue:a.imageHeight,"onUpdate:modelValue":n=>a.imageHeight=n,min:0,max:65535},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"])):C("",!0),l(r,{prop:"withMobileImage",label:e.$t("block.withMobileImage"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(q,{modelValue:a.withMobileImage,"onUpdate:modelValue":n=>a.withMobileImage=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"]),a.withMobileImage?(b(),y(r,{key:2,prop:"mobileImageWidth",label:e.$t("block.mobileImageWidth"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(I,{modelValue:a.mobileImageWidth,"onUpdate:modelValue":n=>a.mobileImageWidth=n,min:16,max:65535},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"])):C("",!0),a.withMobileImage?(b(),y(r,{key:3,prop:"mobileImageHeight",label:e.$t("block.mobileImageHeight"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(I,{modelValue:a.mobileImageHeight,"onUpdate:modelValue":n=>a.mobileImageHeight=n,min:16,max:65535},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"])):C("",!0),l(r,{prop:"enabled",label:e.$t("block.enabled"),rules:{required:!0,message:()=>e.$t("v.required")}},{default:i(()=>[l(q,{modelValue:a.enabled,"onUpdate:modelValue":n=>a.enabled=n},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label","rules"])]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","focus","initValues","toValues","model-value"])}var Be=re(we,[["render",qe]]);const Ue={class:"mb-3"},De={class:"app-block mt-3"},Me={key:1,class:"ml-2"},Ce={key:1,class:"ml-2"},Le=O({setup(e){const{t:s}=ae(),m=g({}),v=g(),W=g(),B=g([]),$=g([]),r=g(!1),w=g(!1),U=g(),q=oe(()=>B.value.map(o=>o.id)),I=g(!1),V=async()=>{r.value=!0;try{B.value=await he(j(z({},ue(m.value)),{Q_OrderBy:v.value})),I.value=Object.values(m.value).filter(o=>o!==void 0&&o!=="").length>0||v.value!==void 0}finally{r.value=!1}};te(V);const a=({column:o,prop:d,order:k})=>{var _;d?v.value=((_=o.sortBy)!=null?_:d)+(k==="descending"?"_desc":""):v.value=void 0,V()},n=()=>V(),P=()=>{W.value.clearSort(),pe(m.value),v.value=void 0,V()},Q=()=>{U.value=void 0,w.value=!0},A=o=>{U.value=o,w.value=!0},E=async o=>{await R(o),V(),se.success(s("success"))},J=async(o,d)=>{const k=be(o,B.value,d);await $e(k.map(_=>_.id))};return(o,d)=>{const k=p("el-button"),_=p("el-popconfirm"),f=p("el-table-column"),M=p("el-tag"),K=p("el-table"),T=de("loading");return b(),H("div",null,[F("div",Ue,[l(u(Ve),{params:m.value,onSearch:n,onReset:P},{default:i(()=>[l(u(ye),{label:o.$t("block.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),F("div",null,[l(k,{type:"primary",disabled:u(D)("block:create"),icon:u(ie),onClick:d[0]||(d[0]=t=>Q())},{default:i(()=>[h(c(o.$t("add")),1)]),_:1},8,["disabled","icon"]),l(_,{title:o.$t("confirmDelete"),onConfirm:d[1]||(d[1]=t=>E($.value.map(S=>S.id)))},{reference:i(()=>[l(k,{disabled:$.value.length<=0||u(D)("block:delete"),icon:u(me)},{default:i(()=>[h(c(o.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),l(_e,{disabled:$.value.length<=0||I.value||u(D)("org:update"),onMove:d[2]||(d[2]=t=>J($.value,t)),class:"ml-2"},null,8,["disabled"]),l(u(ke),{name:"block",class:"ml-2"})]),F("div",De,[ne((b(),y(K,{ref_key:"table",ref:W,data:B.value,onSelectionChange:d[3]||(d[3]=t=>$.value=t),onRowDblclick:d[4]||(d[4]=t=>A(t.id)),onSortChange:a},{default:i(()=>[l(u(Ie),{name:"block"},{default:i(()=>[l(f,{type:"selection",width:"45"}),l(f,{property:"id",label:"ID",width:"64",sortable:"custom"}),l(f,{property:"name",label:o.$t("block.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),l(f,{property:"alias",label:o.$t("block.alias"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),l(f,{property:"scope",label:o.$t("block.scope"),sortable:"custom",formatter:t=>o.$t(`block.scope.${t.scope}`)},null,8,["label","formatter"]),l(f,{property:"withDescription",label:o.$t("block.withDescription"),sortable:"custom"},{default:i(({row:t})=>[l(M,{type:t.withDescription?"success":"info",size:"small"},{default:i(()=>[h(c(o.$t(t.withDescription?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(f,{property:"withImage",label:o.$t("block.withImage"),sortable:"custom"},{default:i(({row:t})=>[t.withImage?(b(),H("span",Me,c(`${t.imageWidth} * ${t.imageHeight}`),1)):(b(),y(M,{key:0,type:t.withImage?"success":"info",size:"small"},{default:i(()=>[h(c(o.$t(t.withImage?"yes":"no")),1)]),_:2},1032,["type"]))]),_:1},8,["label"]),l(f,{property:"withMobileImage",label:o.$t("block.withMobileImage"),sortable:"custom","min-width":"120",display:"none"},{default:i(({row:t})=>[t.withMobileImage?(b(),H("span",Ce,c(`${t.mobileImageWidth} * ${t.mobileImageHeight}`),1)):(b(),y(M,{key:0,type:t.withMobileImage?"success":"info",size:"small"},{default:i(()=>[h(c(o.$t(t.withMobileImage?"yes":"no")),1)]),_:2},1032,["type"]))]),_:1},8,["label"]),l(f,{property:"enabled",label:o.$t("block.enabled"),sortable:"custom"},{default:i(({row:t})=>[l(M,{type:t.enabled?"success":"info",size:"small"},{default:i(()=>[h(c(o.$t(t.enabled?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(f,{label:o.$t("table.action")},{default:i(({row:t})=>[l(k,{type:"text",disabled:u(D)("block:update"),onClick:S=>A(t.id),size:"small"},{default:i(()=>[h(c(o.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),l(_,{title:o.$t("confirmDelete"),onConfirm:S=>E([t.id])},{reference:i(()=>[l(k,{type:"text",disabled:u(D)("block:delete"),size:"small"},{default:i(()=>[h(c(o.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[T,r.value]])]),l(Be,{modelValue:w.value,"onUpdate:modelValue":d[5]||(d[5]=t=>w.value=t),beanId:U.value,beanIds:u(q),onFinished:V},null,8,["modelValue","beanId","beanIds"])])}}});export{Le as default};
