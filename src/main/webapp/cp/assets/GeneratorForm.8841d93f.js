var oe=Object.defineProperty,ue=Object.defineProperties;var de=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var G=(k,t,f)=>t in k?oe(k,t,{enumerable:!0,configurable:!0,writable:!0,value:f}):k[t]=f,Q=(k,t)=>{for(var f in t||(t={}))re.call(t,f)&&G(k,f,t[f]);if(O)for(var f of O(t))ie.call(t,f)&&G(k,f,t[f]);return k},W=(k,t)=>ue(k,de(t));import{g as K,m as p,o as y,j as v,w as a,n as e,v as V,J as m,y as r,x as C,k as d,u as x,D as g,i as me,L as ee,ai as ae,q as J,ab as pe,aj as te,e as X,K as z,I as R,F as ce,A as fe}from"./vendor.831f9fe0.js";import{g as be,u as _e}from"./config.925db2c2.js";import{s as ye,t as ge,v as Z,w as ve,x as ke,y as $e}from"./content.a6b15ed6.js";import{v as he,w as Ve,x as we,y as le,p as I,e as De,f as Ce,z as Se,d as Ie,r as Ue,A as qe}from"./index.e8481b3d.js";import{_ as Y}from"./LabelTip.0c3431b1.js";import{a as ze,_ as Be,b as He,c as Ae}from"./QueryItem.1f679edc.js";import{_ as Pe}from"./DialogForm.5bf7230d.js";const Re={class:"whitespace-pre-wrap"},Ye=K({props:{modelValue:{type:Boolean,required:!0},beanId:{required:!0},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(k){return(t,f)=>{const c=p("el-input"),b=p("el-form-item"),n=p("el-col"),h=p("el-date-picker"),L=p("el-option"),M=p("el-select"),S=p("el-tag"),B=p("el-row");return y(),v(Pe,{name:t.$t("menu.system.task"),queryBean:d(he),createBean:d(Ve),updateBean:d(we),deleteBean:d(le),beanId:k.beanId,beanIds:k.beanIds,initValues:()=>({user:{}}),toValues:l=>Q({},l),addable:!1,editable:!1,large:!0,perms:"task","model-value":k.modelValue,"onUpdate:modelValue":f[0]||(f[0]=l=>t.$emit("update:modelValue",l)),onFinished:f[1]||(f[1]=l=>t.$emit("finished"))},{default:a(({values:l})=>[e(B,null,{default:a(()=>[e(n,{span:12},{default:a(()=>[e(b,{prop:"name",label:t.$t("task.name")},{default:a(()=>[e(c,{modelValue:l.name,"onUpdate:modelValue":_=>l.name=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"user.username",label:t.$t("task.user")},{default:a(()=>[e(c,{modelValue:l.user.username,"onUpdate:modelValue":_=>l.user.username=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"beginDate",label:t.$t("task.beginDate")},{default:a(()=>[e(h,{modelValue:l.beginDate,"onUpdate:modelValue":_=>l.beginDate=_,type:"datetime"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"endDate",label:t.$t("task.endDate")},{default:a(()=>[e(h,{modelValue:l.endDate,"onUpdate:modelValue":_=>l.endDate=_,type:"datetime"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"current",label:t.$t("task.current")},{default:a(()=>[e(c,{modelValue:l.current,"onUpdate:modelValue":_=>l.current=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"processedIn",label:t.$t("task.processedIn")},{default:a(()=>[e(c,{modelValue:l.processedIn,"onUpdate:modelValue":_=>l.processedIn=_},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{prop:"type",label:t.$t("task.type")},{default:a(()=>[l.type?(y(),v(M,{key:0,modelValue:l.type,"onUpdate:modelValue":_=>l.type=_},{default:a(()=>[e(L,{value:l.type,label:t.$t(`task.type.${l.type}`)},null,8,["value","label"])]),_:2},1032,["modelValue","onUpdate:modelValue"])):V("",!0)]),_:2},1032,["label"])]),_:2},1024),e(n,{span:12},{default:a(()=>[e(b,{label:t.$t("task.status")},{default:a(()=>[l.status===0?(y(),v(S,{key:0,type:"info"},{default:a(()=>[m(r(t.$t(`task.status.${l.status}`)),1)]),_:2},1024)):V("",!0),l.status===1?(y(),v(S,{key:1},{default:a(()=>[m(r(t.$t(`task.status.${l.status}`)),1)]),_:2},1024)):V("",!0),l.status===2?(y(),v(S,{key:2,type:"danger"},{default:a(()=>[m(r(t.$t(`task.status.${l.status}`)),1)]),_:2},1024)):V("",!0),l.status===3?(y(),v(S,{key:3,type:"warning"},{default:a(()=>[m(r(t.$t(`task.status.${l.status}`)),1)]),_:2},1024)):V("",!0),l.status===4?(y(),v(S,{key:4,type:"success"},{default:a(()=>[m(r(t.$t(`task.status.${l.status}`)),1)]),_:2},1024)):V("",!0)]),_:2},1032,["label"])]),_:2},1024),l.errorInfo?(y(),v(n,{key:0,span:24},{default:a(()=>[e(b,{label:t.$t("task.errorInfo")},{default:a(()=>[C("pre",null,[C("code",Re,r(l.errorInfo),1)])]),_:2},1032,["label"])]),_:2},1024)):V("",!0)]),_:2},1024)]),_:1},8,["name","queryBean","createBean","updateBean","deleteBean","beanId","beanIds","initValues","toValues","model-value"])}}}),Le={class:"mb-3"},Me={class:"app-block mt-3"},Fe=K({setup(k,{expose:t}){const{t:f}=x(),c=g({}),b=g(),n=g(1),h=g(10),L=g(0),M=g(),S=g([]),B=g([]),l=g(!1),_=g(!1),E=g(),j=me(()=>S.value.map(s=>s.id)),u=async()=>{l.value=!0;try{const{content:s,totalElements:i}=await Se(W(Q({},Ie(c.value)),{Q_OrderBy:b.value,page:n.value,pageSize:h.value}));S.value=s,L.value=i}finally{l.value=!1}};ee(u);const w=({column:s,prop:i,order:H})=>{var A;i?b.value=((A=s.sortBy)!=null?A:i)+(H==="descending"?"_desc":""):b.value=void 0,u()},U=()=>u(),q=()=>{M.value.clearSort(),Ue(c.value),b.value=void 0,u()},F=s=>{E.value=s,_.value=!0},T=async s=>{await le(s),u(),z.success(f("success"))};return t({fetchData:u}),(s,i)=>{const H=p("el-button"),A=p("el-popconfirm"),D=p("el-table-column"),P=p("el-tag"),$=p("el-table"),se=p("el-pagination"),ne=ae("loading");return y(),J("div",null,[C("div",Le,[e(d(Be),{params:c.value,onSearch:U,onReset:q},{default:a(()=>[e(d(ze),{label:s.$t("task.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),C("div",null,[e(A,{title:s.$t("confirmDelete"),onConfirm:i[0]||(i[0]=o=>T(B.value.map(N=>N.id)))},{reference:a(()=>[e(H,{disabled:B.value.length<=0||d(I)("task:delete"),icon:d(pe)},{default:a(()=>[m(r(s.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(d(He),{name:"task",class:"ml-2"})]),C("div",Me,[te((y(),v($,{ref_key:"table",ref:M,data:S.value,onSelectionChange:i[1]||(i[1]=o=>B.value=o),onRowDblclick:i[2]||(i[2]=o=>F(o.id)),onSortChange:w},{default:a(()=>[e(d(Ae),{name:"task"},{default:a(()=>[e(D,{type:"selection",width:"45"}),e(D,{property:"id",label:"ID",width:"64",sortable:"custom"}),e(D,{property:"name",label:s.$t("task.name"),sortable:"custom","min-width":"150","show-overflow-tooltip":""},null,8,["label"]),e(D,{property:"beginDate",label:s.$t("task.beginDate"),sortable:"custom",width:"170"},{default:a(({row:o})=>[m(r(d(X)(o.beginDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(D,{property:"endDate",label:s.$t("task.endDate"),sortable:"custom",width:"170",display:"none"},{default:a(({row:o})=>[m(r(d(X)(o.endDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(D,{property:"current",label:s.$t("task.current"),"min-width":"70",align:"right"},null,8,["label"]),e(D,{property:"processedIn",label:s.$t("task.processedIn"),"min-width":"70",align:"right"},null,8,["label"]),e(D,{property:"user.username",label:s.$t("task.user"),"sort-by":"user-username",sortable:"custom","min-width":"80",align:"right"},null,8,["label"]),e(D,{property:"status",label:s.$t("task.status"),sortable:"custom",width:"80","show-overflow-tooltip":""},{default:a(({row:o})=>[o.status===0?(y(),v(P,{key:0,type:"info",size:"small"},{default:a(()=>[m(r(s.$t(`task.status.${o.status}`)),1)]),_:2},1024)):V("",!0),o.status===1?(y(),v(P,{key:1,size:"small"},{default:a(()=>[m(r(s.$t(`task.status.${o.status}`)),1)]),_:2},1024)):V("",!0),o.status===2?(y(),v(P,{key:2,type:"danger",size:"small"},{default:a(()=>[m(r(s.$t(`task.status.${o.status}`)),1)]),_:2},1024)):V("",!0),o.status===3?(y(),v(P,{key:3,type:"warning",size:"small"},{default:a(()=>[m(r(s.$t(`task.status.${o.status}`)),1)]),_:2},1024)):V("",!0),o.status===4?(y(),v(P,{key:4,type:"success",size:"small"},{default:a(()=>[m(r(s.$t(`task.status.${o.status}`)),1)]),_:2},1024)):V("",!0)]),_:1},8,["label"]),e(D,{label:s.$t("table.action")},{default:a(({row:o})=>[e(H,{type:"text",disabled:d(I)("task:show"),onClick:N=>F(o.id),size:"small"},{default:a(()=>[m(r(s.$t("detail")),1)]),_:2},1032,["disabled","onClick"]),e(A,{title:s.$t("confirmDelete"),onConfirm:N=>T([o.id])},{reference:a(()=>[e(H,{type:"text",disabled:d(I)("task:delete"),size:"small"},{default:a(()=>[m(r(s.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ne,l.value]]),e(se,{currentPage:n.value,"onUpdate:currentPage":i[3]||(i[3]=o=>n.value=o),pageSize:h.value,"onUpdate:pageSize":i[4]||(i[4]=o=>h.value=o),total:L.value,"page-sizes":d(De),layout:d(Ce),onSizeChange:i[5]||(i[5]=o=>u()),onCurrentChange:i[6]||(i[6]=o=>u()),small:"",background:"",class:"px-3 py-2 justify-end"},null,8,["currentPage","pageSize","total","page-sizes","layout"])]),e(Ye,{modelValue:_.value,"onUpdate:modelValue":i[7]||(i[7]=o=>_.value=o),beanId:E.value,beanIds:d(j),onFinished:u},null,8,["modelValue","beanId","beanIds"])])}}}),Te={class:"p-3 app-block"},Ee=C("span",{class:"mx-2"},"|",-1),je={class:"mt-3 p-3 app-block"},Ne={class:"pb-2 border-b text-gray-primary"},Qe=m(".html"),Je=m(".html"),Ke={class:"mt-3 p-3 app-block"},Oe={class:"text-gray-primary"},la=K({setup(k){const{t}=x(),f=g(),c=g({}),b=g(!1),n=g(!1),h=g(),L=async()=>{c.value=await be()};ee(async()=>{b.value=!0;try{await L()}finally{b.value=!1}});const M=async()=>{n.value=!0;try{await ye(),await h.value.fetchData(),z.success(t("success"))}finally{n.value=!1}},S=async()=>{n.value=!0;try{await ge(),await h.value.fetchData(),z.success(t("success"))}finally{n.value=!1}},B=async()=>{n.value=!0;try{await Z(),await h.value.fetchData(),z.success(t("success"))}finally{n.value=!1}},l=async()=>{n.value=!0;try{await ve(),z.success(t("success"))}finally{n.value=!1}},_=async()=>{n.value=!0;try{await ke(),await h.value.fetchData(),z.success(t("success"))}finally{n.value=!1}},E=async()=>{n.value=!0;try{await $e(),await h.value.fetchData(),z.success(t("success"))}finally{n.value=!1}},j=()=>{!f.value||f.value.validate(async u=>{if(!!u){b.value=!0;try{await _e(c.value),await Z(),await h.value.fetchData(),z.success(t("success"))}finally{b.value=!1}}})};return(u,w)=>{const U=p("el-button"),q=p("el-form-item"),F=p("el-form"),T=p("el-switch"),s=p("el-col"),i=p("el-input"),H=p("el-option"),A=p("el-select"),D=p("el-row"),P=ae("loading");return y(),J("div",null,[C("div",Te,[e(F,{"label-width":"200px"},{default:a(()=>[e(q,null,{label:a(()=>[e(Y,{message:"generator.fulltext"})]),default:a(()=>[e(U,{disabled:d(I)("generator:fulltext:reindexAll"),loading:n.value,onClick:R(M,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.fulltext.reindexAll")),1)]),_:1},8,["disabled","loading","onClick"]),d(qe)("generator:fulltext:reindexSite")?(y(),v(U,{key:0,disabled:d(I)("generator:fulltext:reindexSite"),loading:n.value,onClick:R(S,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.fulltext.reindexSite")),1)]),_:1},8,["disabled","loading","onClick"])):V("",!0)]),_:1}),e(q,null,{label:a(()=>[e(Y,{message:"generator.html"})]),default:a(()=>[e(U,{disabled:d(I)("generator:html"),loading:n.value,onClick:R(B,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.html.all")),1)]),_:1},8,["disabled","loading","onClick"]),Ee,e(U,{disabled:d(I)("generator:html"),loading:n.value,onClick:R(l,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.html.home")),1)]),_:1},8,["disabled","loading","onClick"]),e(U,{disabled:d(I)("generator:html"),loading:n.value,onClick:R(_,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.html.channel")),1)]),_:1},8,["disabled","loading","onClick"]),e(U,{disabled:d(I)("generator:html"),loading:n.value,onClick:R(E,["prevent"]),type:"primary",plain:""},{default:a(()=>[m(r(u.$t("generator.op.html.article")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1})]),_:1})]),C("div",je,[C("div",Ne,r(u.$t("site.settings.html")),1),te((y(),v(F,{class:"mt-3",ref_key:"form",ref:f,model:c.value,disabled:d(I)("siteSettings:html:update"),"label-width":"200px"},{default:a(()=>[e(D,null,{default:a(()=>[e(s,{span:12},{default:a(()=>[e(q,{prop:"enabled",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(Y,{message:"site.html.enabled"})]),default:a(()=>[e(T,{modelValue:c.value.enabled,"onUpdate:modelValue":w[0]||(w[0]=$=>c.value.enabled=$)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(q,{prop:"auto",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(Y,{message:"site.html.auto"})]),default:a(()=>[e(T,{modelValue:c.value.auto,"onUpdate:modelValue":w[1]||(w[1]=$=>c.value.auto=$)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(q,{prop:"channel",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(Y,{message:"site.html.channel"})]),default:a(()=>[e(i,{modelValue:c.value.channel,"onUpdate:modelValue":w[2]||(w[2]=$=>c.value.channel=$),maxlength:"100"},{append:a(()=>[Qe]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(q,{prop:"article",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(Y,{message:"site.html.article"})]),default:a(()=>[e(i,{modelValue:c.value.article,"onUpdate:modelValue":w[3]||(w[3]=$=>c.value.article=$),maxlength:"100"},{append:a(()=>[Je]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(q,{prop:"listPages",rules:{required:!0,message:()=>u.$t("v.required")}},{label:a(()=>[e(Y,{message:"site.html.listPages"})]),default:a(()=>[e(A,{modelValue:c.value.listPages,"onUpdate:modelValue":w[4]||(w[4]=$=>c.value.listPages=$),placeholder:"Select"},{default:a(()=>[(y(),J(ce,null,fe([{label:"1",value:1},{label:"3",value:3},{label:"10",value:10},{label:"100",value:100},{label:"1000",value:1e3},{label:"\u5168\u90E8",value:2147483647}],$=>e(H,{key:$.value,label:$.label,value:$.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1}),C("div",null,[e(U,{disabled:d(I)("siteSettings:html:update"),onClick:R(j,["prevent"]),type:"primary","native-type":"submit"},{default:a(()=>[m(r(u.$t("submit")),1)]),_:1},8,["disabled","onClick"])])]),_:1},8,["model","disabled"])),[[P,b.value]])]),C("div",Ke,[C("div",Oe,r(u.$t("generator.taskList")),1)]),e(Fe,{ref_key:"taskListRef",ref:h,class:"mt-3"},null,512)])}}});export{la as default};
