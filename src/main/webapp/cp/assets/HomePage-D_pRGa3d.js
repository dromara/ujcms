import{d as W,u as G,X as y,Y as A,r as x,o as Q,Z as R,$,a0 as j,a1 as X,b as c,P as f,h as t,w as s,c as b,a2 as Z,l as e,a3 as J,k as h,a4 as C,a5 as K,v as i,x as a,g as k,a6 as tt,a7 as et,a8 as st,Q as at,a9 as nt,aa as T}from"./index-__TSAjOL.js";import{d as lt}from"./duration-DvhP3yW3.js";import{q as ot,a as it,b as rt}from"./stat-Cegt4dzu.js";import{q as ut,a as dt,b as ct,c as vt}from"./content-BqI55UAh.js";import{q as ft}from"./interaction-MowfY9gB.js";const pt={class:"mb-3 shadow-md bg-warning-lighter"},_t={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},mt={class:"flex items-center"},yt={class:"mb-3 shadow-md bg-warning-lighter"},ht={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},gt={class:"flex items-center"},xt={class:"mb-3 shadow-md bg-warning-lighter"},wt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},bt={class:"flex items-center"},Ct={class:"mb-3 shadow-md bg-warning-lighter"},kt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},$t={class:"flex items-center"},jt={class:"mb-3 shadow-md bg-warning-lighter"},St={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},qt={class:"flex items-center"},Vt={class:"p-3 app-block"},Yt={class:"text-sm text-gray-secondary"},Dt={class:"flex items-end justify-between mt-1"},Rt={class:"text-3xl text-primary"},Mt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},Pt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},At={class:"p-3 app-block"},Tt={class:"text-sm text-gray-secondary"},Bt={class:"flex items-end justify-between mt-1"},Nt={class:"text-3xl text-primary"},Ft={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},Et={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Ot={class:"p-3 app-block"},Lt={class:"text-sm text-gray-secondary"},zt={class:"flex items-end justify-between mt-1"},Ht={class:"text-3xl text-primary"},It={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},Ut={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Wt={class:"p-3 app-block"},Gt={class:"text-sm text-gray-secondary"},Qt={class:"flex items-end justify-between mt-1"},Xt={class:"text-3xl text-primary"},Zt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},Jt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Kt={class:"px-3 py-5 mt-3 app-block"},te={class:"flex p-3 mt-3 justify-evenly app-block"},ee={class:"h-64 w-60 text-primary"},se={class:"mt-2 text-center"},ae={class:"flex items-center justify-center mt-2"},ne={class:"text-3xl"},le={key:0},oe={key:1},ie={class:"mt-4 space-y-2 text-sm"},re={key:0},ue={key:1},de={key:0},ce={key:1},ve={key:0},fe={key:1},pe={class:"h-64 w-60 text-gray-secondary"},_e={class:"mt-2 text-center"},me={class:"flex items-center justify-center mt-2"},ye={class:"text-3xl"},he={key:0},ge={key:1},xe={class:"mt-4 space-y-2 text-sm"},we={key:0},be={key:1},Ce={key:0},ke={key:1},$e={key:0},je={key:1},Se={class:"p-3 mt-3 app-block"},Pe=W({__name:"HomePage",setup(qe){const{t:w,n:B}=G();y.extend(lt);const M=A(),N=async()=>{const n=await ot({begin:y().startOf("day").subtract(1,"day").format(),end:y().endOf("day").format()}),o={tooltip:{trigger:"axis"},legend:{data:[w("visitTrend.yesterdayPv"),w("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:w("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:n.filter(l=>y(l.date)<y().startOf("day")).map(l=>Number(l.pvCount))},{name:w("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:n.filter(l=>y(l.date)>=y().startOf("day")).map(l=>Number(l.pvCount))}]},v=M.value;if(v==null)return;let d=j.getInstanceByDom(v);d==null&&(d=j.init(v)),d.setOption(o),window.addEventListener("resize",function(){d&&d.resize()})},P=A(),F=async()=>{const n=await it({begin:y().subtract(30,"day").format("YYYY-MM-DD"),end:y().format("YYYY-MM-DD")}),o={title:{text:w("menu.stat.visitSource"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},tooltip:{trigger:"item",valueFormatter:l=>B(l)},series:[{name:w("menu.stat.visitSource"),type:"pie",radius:["44%","80%"],center:["40%","54%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1}},labelLine:{show:!1},data:n.map(l=>({value:Number(l.pvCount),name:w("visitSource.type.".concat(l.name))}))}]},v=P.value;if(v==null)return;let d=j.getInstanceByDom(v);d==null&&(d=j.init(v)),d.setOption(o),window.addEventListener("resize",function(){d&&d.resize()})},r=x({}),u=x({}),E=async()=>{const n=await rt({begin:y().subtract(30,"day").format("YYYY-MM-DD"),end:y().format("YYYY-MM-DD")});r.value=n.newVisitor,u.value=n.oldVisitor,r.value.pvCount=Number(r.value.pvCount),u.value.pvCount=Number(u.value.pvCount),r.value.uvCount=Number(r.value.uvCount),u.value.uvCount=Number(u.value.uvCount);const o=r.value.uvCount+u.value.uvCount;o>0?(r.value.proportion=r.value.uvCount*100/o,u.value.proportion=u.value.uvCount*100/o):(r.value.proportion=50,u.value.proportion=50)},g=x({}),O=async()=>{g.value=await X()},S=x(0),L=async()=>{$.epRank>=1&&(S.value=await ut())},q=x(0),z=async()=>{$.epRank>=1&&(q.value=await dt())},V=x(0),H=async()=>{V.value=await ft()},Y=x(0),I=async()=>{$.epRank>=3&&(Y.value=await ct())},D=x(0),U=async()=>{$.epRank>=3&&(D.value=await vt())};return Q(async()=>{R("articleReview:list")&&(L(),z()),R("formReview:list")&&(I(),U()),R("messageBoard:list")&&H(),N(),F(),E(),O()}),(n,o)=>{const v=J,d=K,l=Z,m=tt;return c(),f("div",null,[t(m,{gutter:12},{default:s(()=>[S.value>0?(c(),b(l,{key:0,span:6},{default:s(()=>[e("div",pt,[e("div",_t,[e("div",mt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[0]||(o[0]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[i(a(n.$t("todo.pendingArticle")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[1]||(o[1]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[i(a(S.value),1)]),_:1})])])])]),_:1})):k("",!0),q.value>0?(c(),b(l,{key:1,span:6},{default:s(()=>[e("div",yt,[e("div",ht,[e("div",gt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[2]||(o[2]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[i(a(n.$t("todo.rejectedArticle")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[3]||(o[3]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[i(a(q.value),1)]),_:1})])])])]),_:1})):k("",!0),Y.value>0?(c(),b(l,{key:2,span:6},{default:s(()=>[e("div",xt,[e("div",wt,[e("div",bt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[4]||(o[4]=()=>n.$router.push({path:"/content/form-review"}))},{default:s(()=>[i(a(n.$t("todo.pendingForm")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[5]||(o[5]=()=>n.$router.push({path:"/content/form-review"}))},{default:s(()=>[i(a(Y.value),1)]),_:1})])])])]),_:1})):k("",!0),D.value>0?(c(),b(l,{key:3,span:6},{default:s(()=>[e("div",Ct,[e("div",kt,[e("div",$t,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[6]||(o[6]=()=>n.$router.push({path:"/content/form",query:{status:22}}))},{default:s(()=>[i(a(n.$t("todo.rejectedForm")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[7]||(o[7]=()=>n.$router.push({path:"/content/form",query:{status:22}}))},{default:s(()=>[i(a(D.value),1)]),_:1})])])])]),_:1})):k("",!0),V.value>0?(c(),b(l,{key:4,span:6},{default:s(()=>[e("div",jt,[e("div",St,[e("div",qt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[8]||(o[8]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[i(a(n.$t("todo.unreviewedMessageBoard")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[9]||(o[9]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[i(a(V.value),1)]),_:1})])])])]),_:1})):k("",!0)]),_:1}),t(m,{gutter:12},{default:s(()=>[t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Vt,[e("div",Yt,a(n.$t("contentStat.article")),1),e("div",Dt,[e("div",Rt,a((p=g.value.article)==null?void 0:p.total),1),e("div",Mt,[t(v,null,{default:s(()=>[t(h(et))]),_:1})])]),e("div",Pt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.article)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",At,[e("div",Tt,a(n.$t("contentStat.channel")),1),e("div",Bt,[e("div",Nt,a((p=g.value.channel)==null?void 0:p.total),1),e("div",Ft,[t(v,null,{default:s(()=>[t(h(st))]),_:1})])]),e("div",Et,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.channel)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Ot,[e("div",Lt,a(n.$t("contentStat.user")),1),e("div",zt,[e("div",Ht,a((p=g.value.user)==null?void 0:p.total),1),e("div",It,[t(v,null,{default:s(()=>[t(h(at))]),_:1})])]),e("div",Ut,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.user)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Wt,[e("div",Gt,a(n.$t("contentStat.attachment")),1),e("div",Qt,[e("div",Xt,a((p=g.value.attachment)==null?void 0:p.total),1),e("div",Zt,[t(v,null,{default:s(()=>[t(h(nt))]),_:1})])]),e("div",Jt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.attachment)==null?void 0:_.last7day),1)])])]}),_:1})]),_:1}),e("div",Kt,[e("div",{ref_key:"trendChart",ref:M,class:"h-64"},null,512)]),t(m,{gutter:12},{default:s(()=>[t(l,{span:12},{default:s(()=>{var p,_;return[e("div",te,[e("div",ee,[e("div",se,a(n.$t("visitVisitor.newVisitor")),1),e("div",ae,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(T))]),_:1}),e("span",ne,[r.value.uvCount>0?(c(),f("span",le,a(n.$n((p=r.value.proportion)!=null?p:0,"decimal")),1)):(c(),f("span",oe,"-")),o[10]||(o[10]=i("% "))])]),e("div",ie,[t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(r.value.pvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(r.value.uvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",re,a(n.$n(r.value.bounceCount*100/r.value.uvCount,"decimal"))+"%",1)):(c(),f("span",ue,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",de,a(h(y).duration(r.value.duration/r.value.uvCount,"seconds").format("HH:mm:ss")),1)):(c(),f("span",ce,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",ve,a(n.$n(r.value.pvCount/r.value.uvCount,"decimal")),1)):(c(),f("span",fe,"-"))]),_:1})]),_:1})])]),e("div",pe,[e("div",_e,a(n.$t("visitVisitor.oldVisitor")),1),e("div",me,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(T))]),_:1}),e("span",ye,[u.value.uvCount>0?(c(),f("span",he,a(n.$n((_=u.value.proportion)!=null?_:0,"decimal")),1)):(c(),f("span",ge,"-")),o[11]||(o[11]=i("% "))])]),e("div",xe,[t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(u.value.pvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(u.value.uvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",we,a(n.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(c(),f("span",be,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",Ce,a(h(y).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(c(),f("span",ke,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",$e,a(n.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(c(),f("span",je,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(l,{span:12},{default:s(()=>[e("div",Se,[e("div",{ref_key:"sourceTypeChart",ref:P,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{Pe as default};
