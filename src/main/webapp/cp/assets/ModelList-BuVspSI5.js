import{d as j,r as y,b as r,c as g,w as t,h as e,i as de,j as oe,P as U,aF as S,aG as z,v as q,x as M,k as d,A as ue,u as ne,B as ce,$ as te,E as ge,aP as $e,aQ as _e,b6 as Ee,g as k,l as K,m as ie,n as ke,t as me,z as Ue,O as be,b3 as X,aD as Me,a2 as Ce,ay as ye,a3 as we,bb as qe,b8 as Ie,b9 as Fe,_ as Le,ar as He,o as De,bi as Oe,bs as ze,aW as Re,b5 as A,aZ as Be,bI as Ne,e as We,y as Ae,aO as Ke}from"./index-DiyxZ9gY.js";import{E as se,a as Pe,b as he}from"./el-radio-group-3iEWUNV9.js";/* empty css                        */import{E as Je}from"./el-popover-B-PHJYDd.js";import{M as Te,N as Y,O as Qe,P as pe,c as je,q as Ge,Q as Ze}from"./config-C0MmAqff.js";import{a as Xe,_ as Ye,b as xe,c as el}from"./QueryItem.vue_vue_type_script_setup_true_lang-C8NUyNWU.js";import{_ as ll}from"./ListMove.vue_vue_type_script_setup_true_lang-CHagpDmg.js";import{E as re,a as fe}from"./el-select-Fa4N2NlQ.js";/* empty css                 */import{_ as al}from"./DialogForm.vue_vue_type_script_setup_true_lang-BWkTpKxX.js";import{E as Se}from"./el-switch-D_ifMf8o.js";import{g as ve,m as Z}from"./data-CZKK3H3H.js";import{b as tl,E as dl,c as ol,a as ul}from"./el-main-5QdO0yNq.js";import{d as Ve}from"./vuedraggable.umd-B10H_zYq.js";import{a as nl,_ as il}from"./FieldItem.vue_vue_type_script_setup_true_lang-CPUHkrvu.js";import{a as ml}from"./el-input-number-BwGcALb9.js";import{C as sl}from"./content-wcwZylI0.js";import"./sortable.esm-DEaZq8gs.js";/* empty css                          */import"./Tinymce-Bqhh0BNv.js";import"./FileListUpload.vue_vue_type_style_index_0_scoped_b3a09e2e_lang-CkAMyu44.js";import"./BaseUpload.vue_vue_type_style_index_0_scoped_248c0508_lang-D0YU9Mkv.js";import"./BaseUpload-D3CKR8nb.js";import"./position-DVxlJM6I.js";const pl=j({name:"ModelForm",__name:"ModelForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0},modelType:{type:String,required:!0}},emits:{"update:modelValue":null,finished:null},setup(L){const B=y(),l=y({});return(h,b)=>{const D=oe,n=de,o=Pe,E=se,p=fe,$=re;return r(),g(al,{values:l.value,"onUpdate:values":b[3]||(b[3]=s=>l.value=s),name:h.$t("menu.config.model"),"query-bean":d(pe),"create-bean":d(Qe),"update-bean":d(Y),"delete-bean":d(Te),"bean-id":L.beanId,"bean-ids":L.beanIds,focus:B.value,"init-values":()=>({type:L.modelType,scope:0}),"to-values":s=>({...s}),"disable-delete":s=>s.id<=10,perms:"model","model-value":L.modelValue,"onUpdate:modelValue":b[4]||(b[4]=s=>h.$emit("update:modelValue",s)),onFinished:b[5]||(b[5]=()=>h.$emit("finished"))},{default:t(({})=>[e(n,{prop:"name",label:h.$t("model.name"),rules:{required:!0,message:()=>h.$t("v.required")}},{default:t(()=>[e(D,{ref_key:"focus",ref:B,modelValue:l.value.name,"onUpdate:modelValue":b[0]||(b[0]=s=>l.value.name=s),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(n,{prop:"scope",label:h.$t("model.scope"),rules:{required:!0,message:()=>h.$t("v.required")}},{default:t(()=>[e(E,{modelValue:l.value.scope,"onUpdate:modelValue":b[1]||(b[1]=s=>l.value.scope=s),disabled:l.value.id<10},{default:t(()=>[(r(),U(S,null,z([0,2],s=>e(o,{key:s,value:s},{default:t(()=>[q(M(h.$t("model.scope.".concat(s))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","disabled"])]),_:1},8,["label","rules"]),e(n,{prop:"type",label:h.$t("model.type")},{default:t(()=>[e($,{modelValue:l.value.type,"onUpdate:modelValue":b[2]||(b[2]=s=>l.value.type=s),disabled:""},{default:t(()=>[e(p,{value:L.modelType,label:h.$t("model.type.".concat(L.modelType))},null,8,["value","label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","disable-delete","model-value"])}}}),rl={class:"mt-3"},fl=j({name:"ModelSystemFields",__name:"ModelSystemFields",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null}},emits:{"update:modelValue":null},setup(L,{emit:B}){const l=L,h=B,{beanId:b,modelValue:D}=ue(l),{t:n}=ne(),o=y({}),E=y(!1),p=y([]),$=y([]);ce(D,async()=>{var i;if(D.value&&b.value){o.value=await pe(b.value);const I=ve()[o.value.type];p.value=Z(I.mains.filter(c=>{var v;return te.epRank>=((v=c.epRank)!=null?v:0)}),o.value.mains,o.value.type),((i=I.asides)==null?void 0:i.length)>0&&($.value=Z(I.asides.filter(c=>{var v;return te.epRank>=((v=c.epRank)!=null?v:0)}),o.value.asides,o.value.type))}});const s=async()=>{E.value=!0;try{p.value=p.value.map(i=>({...i,name:i.name===""?null:i.name})),$.value=$.value.map(i=>({...i,name:i.name===""?null:i.name})),await Y({...o.value,mains:JSON.stringify(p.value),asides:JSON.stringify($.value)}),me.success(n("success"))}finally{E.value=!1,h("update:modelValue",!1)}},C=()=>{var I;const i=ve()[o.value.type];p.value=Z(i.mains,null,o.value.type),((I=i.asides)==null?void 0:I.length)>0&&($.value=Z(i.asides,null,o.value.type))};return(i,I)=>{const c=_e,v=oe,a=Se,F=fe,O=re,J=Ee,P=$e,_=ie,T=ge,R=Ue;return r(),g(R,{title:i.$t("model.fun.systemFields"),"model-value":L.modelValue,top:"5vh",width:"1024px","onUpdate:modelValue":I[0]||(I[0]=m=>i.$emit("update:modelValue",m))},{default:t(()=>[e(T,null,{default:t(()=>[e(P,{data:p.value},{default:t(()=>[e(c,{prop:"code",label:i.$t("model.field.code"),"min-width":"110"},null,8,["label"]),e(c,{prop:"name",label:i.$t("model.field.name"),"min-width":"140"},{default:t(({row:m})=>[e(v,{modelValue:m.name,"onUpdate:modelValue":u=>m.name=u,placeholder:i.$t(m.label),class:"w-11/12"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),e(c,{prop:"show",label:i.$t("model.field.show")},{default:t(({row:m})=>[e(a,{modelValue:m.show,"onUpdate:modelValue":u=>m.show=u,disabled:m.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(c,{prop:"double",label:i.$t("model.field.double")},{default:t(({row:m})=>[e(a,{modelValue:m.double,"onUpdate:modelValue":u=>m.double=u},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),e(c,{prop:"required",label:i.$t("model.field.required")},{default:t(({row:m})=>[e(a,{modelValue:m.required,"onUpdate:modelValue":u=>m.required=u,disabled:m.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(c,{label:i.$t("model.field.attribute"),"min-width":"180"},{default:t(({row:m})=>[m.type==="image"?(r(),U(S,{key:0},[e(v,{modelValue:m.imageHeight,"onUpdate:modelValue":u=>m.imageHeight=u,modelModifiers:{number:!0}},{prepend:t(()=>[q(M(i.$t("model.field.imageHeight")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(v,{modelValue:m.imageWidth,"onUpdate:modelValue":u=>m.imageWidth=u,modelModifiers:{number:!0}},{prepend:t(()=>[q(M(i.$t("model.field.imageWidth")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(O,{modelValue:m.imageMode,"onUpdate:modelValue":u=>m.imageMode=u,placeholder:i.$t("model.field.imageMode"),class:"w-full"},{default:t(()=>[(r(),U(S,null,z(["manual","cut","resize","none"],u=>e(F,{key:u,value:u,label:i.$t("model.field.imageMode.".concat(u))},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])],64)):m.type==="imageList"?(r(),U(S,{key:1},[e(v,{modelValue:m.imageMaxHeight,"onUpdate:modelValue":u=>m.imageMaxHeight=u,modelModifiers:{number:!0}},{prepend:t(()=>[q(M(i.$t("model.field.imageMaxHeight")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(v,{modelValue:m.imageMaxWidth,"onUpdate:modelValue":u=>m.imageMaxWidth=u,modelModifiers:{number:!0}},{prepend:t(()=>[q(M(i.$t("model.field.imageMaxWidth")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"]),e(O,{modelValue:m.imageListType,"onUpdate:modelValue":u=>m.imageListType=u,placeholder:i.$t("model.field.imageListType"),class:"w-full"},{default:t(()=>[(r(),U(S,null,z(["pictureCard","picture"],u=>e(F,{key:u,value:u,label:i.$t("model.field.imageListType.".concat(u))},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])],64)):m.type==="editor"?(r(),U(S,{key:2},[e(O,{modelValue:m.editorType,"onUpdate:modelValue":u=>m.editorType=u,placeholder:i.$t("model.field.editorType"),class:"w-full"},{default:t(()=>[(r(),U(S,null,z([1,2],u=>e(F,{key:u,value:u,label:i.$t("model.field.editorType.".concat(u))},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),e(J,{modelValue:m.editorSwitch,"onUpdate:modelValue":u=>m.editorSwitch=u},{default:t(()=>[q(M(i.$t("model.field.editorSwitch")),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],64)):k("",!0)]),_:1},8,["label"])]),_:1},8,["data"]),$.value.length>0?(r(),g(P,{key:0,data:$.value,class:"mt-5"},{default:t(()=>[e(c,{prop:"code",label:i.$t("model.field.code"),"min-width":"100"},null,8,["label"]),e(c,{prop:"name",label:i.$t("model.field.name"),"min-width":"120"},{default:t(({row:m})=>[e(v,{modelValue:m.name,"onUpdate:modelValue":u=>m.name=u,placeholder:i.$t(m.label),class:"w-11/12"},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),e(c,{prop:"show",label:i.$t("model.field.show")},{default:t(({row:m})=>[e(a,{modelValue:m.show,"onUpdate:modelValue":u=>m.show=u,disabled:m.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"]),e(c,{prop:"required",label:i.$t("model.field.required")},{default:t(({row:m})=>[e(a,{modelValue:m.required,"onUpdate:modelValue":u=>m.required=u,disabled:m.must},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1},8,["label"])]),_:1},8,["data"])):k("",!0),K("div",rl,[e(_,{loading:E.value,type:"primary","native-type":"submit",onClick:ke(s,["prevent"])},{default:t(()=>[q(M(i.$t("save")),1)]),_:1},8,["loading"]),e(_,{onClick:C},{default:t(()=>[q(M(i.$t("restoreInitialSettings")),1)]),_:1})])]),_:1})]),_:1},8,["title","model-value"])}}}),bl=j({__name:"FieldAttribute",props:{selected:{type:Object,required:!0}},setup(L){const B=L,{selected:l}=ue(B),h=y([]),b=y([]);be(async()=>{l.value.type==="date"&&!l.value.dateType&&(l.value.dateType="date"),l.value.type==="switch"&&!l.value.inactiveValue&&(l.value.inactiveValue="0"),l.value.type==="switch"&&!l.value.activeValue&&(l.value.activeValue="1"),["radio","checkbox"].includes(l.value.type)&&!l.value.checkStyle&&(l.value.checkStyle="default"),["checkbox","multipleSelect"].includes(l.value.type)&&!l.value.defaultValue&&(l.value.defaultValue=[]),["checkbox","multipleSelect"].includes(l.value.type)&&(l.value.multiple=!0),["radio","checkbox","select","multipleSelect"].includes(l.value.type)&&(h.value=await je())}),be(async()=>{l.value.dictTypeId!=null&&(b.value=await sl({typeId:l.value.dictTypeId}))});const D=n=>{var o;l.value.defaultValue=l.value.multiple?[]:void 0,l.value.defaultValueKey=l.value.multiple?[]:void 0,l.value.dataType=((o=h.value.find(E=>E.id===n))==null?void 0:o.dataType)===1?"number":"string"};return(n,o)=>{const E=oe,p=de,$=Se,s=ml,C=fe,i=re,I=nl,c=he,v=se;return r(),U(S,null,[e(p,{prop:"code",label:n.$t("model.field.code"),rules:[{required:!0,message:()=>n.$t("v.required")},{validator:(a,F,O)=>{if(!/^[a-zA-Z0-9]+$/.test(F)){O(n.$t("model.field.error.invalidCode"));return}O()}}]},{default:t(()=>[e(E,{modelValue:d(l).code,"onUpdate:modelValue":o[0]||(o[0]=a=>d(l).code=a),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),e(p,{prop:"name",label:n.$t("model.field.name"),rules:{required:!0,message:()=>n.$t("v.required")}},{default:t(()=>[e(E,{modelValue:d(l).name,"onUpdate:modelValue":o[1]||(o[1]=a=>d(l).name=a),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"]),["tinyEditor","textarea"].includes(d(l).type)?(r(),g(p,{key:0,prop:"clob",label:n.$t("model.field.clob")},{label:t(()=>[e(X,{message:"model.field.clob",help:""})]),default:t(()=>[e($,{modelValue:d(l).clob,"onUpdate:modelValue":o[2]||(o[2]=a=>d(l).clob=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),e(p,{prop:"double",label:n.$t("model.field.double")},{default:t(()=>[e($,{modelValue:d(l).double,"onUpdate:modelValue":o[3]||(o[3]=a=>d(l).double=a)},null,8,["modelValue"])]),_:1},8,["label"]),["text","textarea","number","date","color","slider","switch","radio","checkbox","select","multipleSelect"].includes(d(l).type)?(r(),g(p,{key:1,prop:"required",label:n.$t("model.field.showInList")},{default:t(()=>[e($,{modelValue:d(l).showInList,"onUpdate:modelValue":o[4]||(o[4]=a=>d(l).showInList=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),e(p,{prop:"required",label:n.$t("model.field.required")},{default:t(()=>[e($,{modelValue:d(l).required,"onUpdate:modelValue":o[5]||(o[5]=a=>d(l).required=a)},null,8,["modelValue"])]),_:1},8,["label"]),["text","textarea","number","select","multipleSelect","videoUpload","audioUpload","fileUpload","tinyEditor"].includes(d(l).type)?(r(),g(p,{key:2,prop:"placeholder",label:n.$t("model.field.placeholder")},{default:t(()=>[e(E,{modelValue:d(l).placeholder,"onUpdate:modelValue":o[6]||(o[6]=a=>d(l).placeholder=a),maxlength:"100"},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["text","textarea"].includes(d(l).type)?(r(),U(S,{key:3},[e(p,{prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e(E,{modelValue:d(l).defaultValue,"onUpdate:modelValue":o[7]||(o[7]=a=>d(l).defaultValue=a),maxlength:"100"},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"minlength",label:n.$t("model.field.minlength")},{default:t(()=>[e(s,{modelValue:d(l).minlength,"onUpdate:modelValue":o[8]||(o[8]=a=>d(l).minlength=a),min:1},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"maxlength",label:n.$t("model.field.maxlength")},{default:t(()=>[e(s,{modelValue:d(l).maxlength,"onUpdate:modelValue":o[9]||(o[9]=a=>d(l).maxlength=a),min:1},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),["textarea"].includes(d(l).type)?(r(),g(p,{key:4,prop:"rows",label:n.$t("model.field.rows")},{default:t(()=>[e(s,{modelValue:d(l).rows,"onUpdate:modelValue":o[10]||(o[10]=a=>d(l).rows=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["number","slider"].includes(d(l).type)?(r(),U(S,{key:5},[e(p,{prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e(s,{modelValue:d(l).defaultValue,"onUpdate:modelValue":o[11]||(o[11]=a=>d(l).defaultValue=a),min:d(l).min,max:d(l).max},null,8,["modelValue","min","max"])]),_:1},8,["label"]),e(p,{prop:"min",label:n.$t("model.field.min")},{default:t(()=>[e(s,{modelValue:d(l).min,"onUpdate:modelValue":o[12]||(o[12]=a=>d(l).min=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"max",label:n.$t("model.field.max")},{default:t(()=>[e(s,{modelValue:d(l).max,"onUpdate:modelValue":o[13]||(o[13]=a=>d(l).max=a)},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"step",label:n.$t("model.field.step")},{default:t(()=>[e(s,{modelValue:d(l).step,"onUpdate:modelValue":o[14]||(o[14]=a=>d(l).step=a)},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),["number"].includes(d(l).type)?(r(),g(p,{key:6,prop:"precision",label:n.$t("model.field.precision")},{default:t(()=>[e(s,{modelValue:d(l).precision,"onUpdate:modelValue":o[15]||(o[15]=a=>d(l).precision=a),precision:0,min:0,max:4},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["slider"].includes(d(l).type)?(r(),g(p,{key:7,prop:"showInput",label:n.$t("model.field.showInput")},{default:t(()=>[e($,{modelValue:d(l).showInput,"onUpdate:modelValue":o[16]||(o[16]=a=>d(l).showInput=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["date"].includes(d(l).type)?(r(),g(p,{key:8,prop:"dateType",label:n.$t("model.field.dateType")},{default:t(()=>[e(i,{modelValue:d(l).dateType,"onUpdate:modelValue":o[17]||(o[17]=a=>d(l).dateType=a)},{default:t(()=>[(r(),U(S,null,z(["date","datetime"],a=>e(C,{key:a,label:n.$t("model.field.dateType.".concat(a)),value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])):k("",!0),["color"].includes(d(l).type)?(r(),g(p,{key:9,prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e(I,{modelValue:d(l).defaultValue,"onUpdate:modelValue":o[18]||(o[18]=a=>d(l).defaultValue=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["switch"].includes(d(l).type)?(r(),g(p,{key:10,prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e($,{modelValue:d(l).defaultValue,"onUpdate:modelValue":o[19]||(o[19]=a=>d(l).defaultValue=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["radio","checkbox"].includes(d(l).type)?(r(),g(p,{key:11,prop:"checkStyle",label:n.$t("model.field.checkStyle")},{default:t(()=>[e(v,{modelValue:d(l).checkStyle,"onUpdate:modelValue":o[20]||(o[20]=a=>d(l).checkStyle=a)},{default:t(()=>[(r(),U(S,null,z(["default","button"],a=>e(c,{key:a,value:a},{default:t(()=>[q(M(n.$t("model.field.checkStyle.".concat(a))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])):k("",!0),["select","multipleSelect"].includes(d(l).type)?(r(),g(p,{key:12,prop:"clearable",label:n.$t("model.field.clearable")},{default:t(()=>[e($,{modelValue:d(l).clearable,"onUpdate:modelValue":o[21]||(o[21]=a=>d(l).clearable=a)},null,8,["modelValue"])]),_:1},8,["label"])):k("",!0),["radio","checkbox","select","multipleSelect"].includes(d(l).type)?(r(),U(S,{key:13},[e(p,{prop:"dictTypeId",label:n.$t("model.field.dictType"),rules:{required:!0,message:()=>n.$t("v.required")}},{default:t(()=>[e(i,{modelValue:d(l).dictTypeId,"onUpdate:modelValue":o[22]||(o[22]=a=>d(l).dictTypeId=a),class:"w-full",onChange:o[23]||(o[23]=a=>D(a))},{default:t(()=>[(r(!0),U(S,null,z(h.value,a=>(r(),g(C,{key:a.id,value:a.id,label:"".concat(a.name,"(").concat(a.alias,")")},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label","rules"]),e(p,{prop:"dataType",label:n.$t("model.field.dataType")},{default:t(()=>[e(i,{modelValue:d(l).dataType,"onUpdate:modelValue":o[24]||(o[24]=a=>d(l).dataType=a),class:"w-full",disabled:""},{default:t(()=>[(r(),U(S,null,z(["string","number"],a=>e(C,{key:a,value:a,label:n.$t("model.field.dataType.".concat(a))},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),["radio","select"].includes(d(l).type)?(r(),g(p,{key:14,prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e(i,{modelValue:d(l).defaultValueKey,"onUpdate:modelValue":o[25]||(o[25]=a=>d(l).defaultValueKey=a),clearable:"",class:"w-full",onChange:o[26]||(o[26]=a=>{var F;return d(l).defaultValue=(F=b.value.find(O=>O.value===a))==null?void 0:F.name})},{default:t(()=>[(r(!0),U(S,null,z(b.value,a=>(r(),g(C,{key:a.id,value:a.value,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):k("",!0),["checkbox","multipleSelect"].includes(d(l).type)?(r(),g(p,{key:15,prop:"defaultValue",label:n.$t("model.field.defaultValue")},{default:t(()=>[e(i,{modelValue:d(l).defaultValueKey,"onUpdate:modelValue":o[27]||(o[27]=a=>d(l).defaultValueKey=a),clearable:"",class:"w-full",multiple:"",onChange:o[28]||(o[28]=a=>d(l).defaultValue=b.value.filter(F=>a.indexOf(F.value)!==-1).map(F=>F.name))},{default:t(()=>[(r(!0),U(S,null,z(b.value,a=>(r(),g(C,{key:a.id,value:a.value,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])):k("",!0),["imageUpload"].includes(d(l).type)?(r(),U(S,{key:16},[e(p,{prop:"imageWidth",label:n.$t("model.field.imageWidth")},{default:t(()=>[e(s,{modelValue:d(l).imageWidth,"onUpdate:modelValue":o[29]||(o[29]=a=>d(l).imageWidth=a),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"imageHeight",label:n.$t("model.field.imageHeight")},{default:t(()=>[e(s,{modelValue:d(l).imageHeight,"onUpdate:modelValue":o[30]||(o[30]=a=>d(l).imageHeight=a),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"imageMode",label:n.$t("model.field.imageMode")},{default:t(()=>[e(i,{modelValue:d(l).imageMode,"onUpdate:modelValue":o[31]||(o[31]=a=>d(l).imageMode=a),clearable:"",class:"w-full"},{default:t(()=>[(r(),U(S,null,z(["cut","resize","manual","none"],a=>e(C,{key:a,value:a,label:n.$t("model.field.imageMode.".concat(a))},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0),["imageUpload","videoUpload","audioUpload","fileUpload"].includes(d(l).type)?(r(),U(S,{key:17},[e(p,{prop:"fileAccept"},{label:t(()=>[e(X,{message:"model.field.fileAccept",help:"","fix-width":!1})]),default:t(()=>[e(E,{modelValue:d(l).fileAccept,"onUpdate:modelValue":o[32]||(o[32]=a=>d(l).fileAccept=a),maxlength:"255"},null,8,["modelValue"])]),_:1}),e(p,{prop:"fileMaxSize",rules:{type:"number",min:0,max:65535,message:()=>n.$t("v.range",{min:0,max:65535})}},{label:t(()=>[e(X,{message:"model.field.fileMaxSize",help:"","fix-width":!1})]),default:t(()=>[e(E,{modelValue:d(l).fileMaxSize,"onUpdate:modelValue":o[33]||(o[33]=a=>d(l).fileMaxSize=a),modelModifiers:{number:!0},maxlength:"5"},null,8,["modelValue"])]),_:1},8,["rules"])],64)):k("",!0),["tinyEditor"].includes(d(l).type)?(r(),U(S,{key:18},[e(p,{prop:"minHeight",label:n.$t("model.field.minHeight")},{default:t(()=>[e(s,{modelValue:d(l).minHeight,"onUpdate:modelValue":o[34]||(o[34]=a=>d(l).minHeight=a),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(p,{prop:"maxHeight",label:n.$t("model.field.maxHeight")},{default:t(()=>[e(s,{modelValue:d(l).maxHeight,"onUpdate:modelValue":o[35]||(o[35]=a=>d(l).maxHeight=a),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"])],64)):k("",!0)],64)}}}),yl={class:"dialog-full"},vl={class:"drag-component"},Vl=["onClick"],cl=["onClick"],gl=j({name:"ModelCustomFields",__name:"ModelCustomFields",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null}},emits:{"update:modelValue":null},setup(L,{emit:B}){const l=L,h=B,{beanId:b,modelValue:D}=ue(l),{t:n}=ne(),o=y({}),E=y({}),p=y(),$=y(!1),s=y(),C=y(),i=y("attribute"),I=y(!1),c=y([{label:n("model.fieldType.text"),type:"text"},{label:n("model.fieldType.textarea"),type:"textarea"},{label:n("model.fieldType.number"),type:"number"},{label:n("model.fieldType.slider"),type:"slider"},{label:n("model.fieldType.date"),type:"date"},{label:n("model.fieldType.color"),type:"color"},{label:n("model.fieldType.radio"),type:"radio"},{label:n("model.fieldType.checkbox"),type:"checkbox"},{label:n("model.fieldType.select"),type:"select"},{label:n("model.fieldType.multipleSelect"),type:"multipleSelect"},{label:n("model.fieldType.switch"),type:"switch"},{label:n("model.fieldType.imageUpload"),type:"imageUpload"},{label:n("model.fieldType.videoUpload"),type:"videoUpload"},{label:n("model.fieldType.audioUpload"),type:"audioUpload"},{label:n("model.fieldType.fileUpload"),type:"fileUpload"},{label:n("model.fieldType.tinyEditor"),type:"tinyEditor"}]),v=y([]);ce(D,async()=>{D.value&&(b==null?void 0:b.value)!=null&&(o.value=await pe(b.value),v.value=JSON.parse(o.value.customs||"[]"),v.value.length>0?[s.value]=v.value:s.value=void 0)});const a=async _=>{if(!s.value){s.value=_;return}p.value.validate(T=>{T&&(s.value=_)})},F=_=>{const T={code:"field".concat(Date.now()),type:_.type,name:_.label,double:!1,dataType:["number","slider"].indexOf(_.type)!==-1?"number":"string",clob:["tinyEditor"].indexOf(_.type)!==-1};return C.value=T,T},O=_=>{_.from!==_.to&&(s.value=C.value)},J=_=>{const T=v.value.indexOf(_);v.value.splice(T,1);const{length:R}=v.value;R<=0?s.value=void 0:T<R?s.value=v.value[T]:s.value=v.value[R-1]},P=async()=>{I.value=!0;try{v.value.length>0?p.value.validate(async _=>{_&&await Y({...o.value,customs:JSON.stringify(v.value)})}):await Y({...o.value,customs:JSON.stringify(v.value)}),me.success(n("success"))}finally{I.value=!1,h("update:modelValue",!1)}};return(_,T)=>{const R=Me,m=dl,u=ie,V=ol,H=de,N=we,x=Ce,G=ge,W=ul,Q=tl,ee=Fe,le=Ie,f=Ue;return r(),U("div",yl,[e(f,{title:_.$t("model.fun.customFields"),"model-value":L.modelValue,"destroy-on-close":"",fullscreen:"","onUpdate:modelValue":T[3]||(T[3]=w=>_.$emit("update:modelValue",w))},{default:t(()=>[e(Q,{class:"border-t",style:{height:"calc(100vh - 65px)"}},{default:t(()=>[e(m,{width:"240px"},{default:t(()=>[e(R,{class:"h-full"},{default:t(()=>[e(d(Ve),{list:c.value,group:{name:"components",pull:"clone",put:!1},sort:!1,clone:F,"item-key":"label",onEnd:O},{item:t(({element:w})=>[K("div",vl,M(w.label),1)]),_:1},8,["list"])]),_:1})]),_:1}),e(Q,{class:"border-l border-r"},{default:t(()=>[e(V,{height:"auto",class:"px-2 py-1"},{default:t(()=>[e(u,{loading:I.value,type:"primary",onClick:ke(P,["prevent"])},{default:t(()=>[q(M(_.$t("save")),1)]),_:1},8,["loading"])]),_:1}),e(W,{class:"p-0 border-t"},{default:t(()=>[e(R,{class:"h-full p-2 drawing-board"},{default:t(()=>[e(G,{model:E.value,"label-width":"150px",class:"h-full"},{default:t(()=>[e(d(Ve),{list:v.value,class:"content-start min-h-full mx-0",tag:"el-row","component-data":{gutter:8},animation:250,group:"components","item-key":"code",onStart:T[0]||(T[0]=()=>$.value=!0),onEnd:T[1]||(T[1]=()=>$.value=!1)},{item:t(({element:w})=>[e(x,{span:w.double?12:24,class:"relative"},{default:t(()=>[e(H,{required:w.required,"show-message":!1,class:"py-3 mb-0"},{label:t(()=>[e(X,{label:w.name},null,8,["label"])]),default:t(()=>[e(il,{modelValue:w.defaultValue,"onUpdate:modelValue":ae=>w.defaultValue=ae,"model-key":w.defaultValueKey,"onUpdate:modelKey":ae=>w.defaultValueKey=ae,field:w},null,8,["modelValue","onUpdate:modelValue","model-key","onUpdate:modelKey","field"])]),_:2},1032,["required"]),K("div",{class:ye(["drag-mask",!$.value&&s.value!==w?"hover:opacity-10":null,s.value===w?"drag-mask-selected":null]),onClick:()=>a(w)},null,10,Vl),K("div",{class:ye(["drag-close",s.value!==w?"hidden":null]),onClick:()=>J(w)},[e(N,{class:"text-danger"},{default:t(()=>[e(d(qe))]),_:1})],10,cl)]),_:2},1032,["span"])]),_:1},8,["list"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),e(m,{class:"w-64 right-panel"},{default:t(()=>[e(R,{class:"h-full pt-0.5 pb-3"},{default:t(()=>[e(le,{modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=w=>i.value=w),stretch:""},{default:t(()=>[e(ee,{label:_.$t("model.attribute"),name:"attribute",class:"px-2"},{default:t(()=>[e(G,{ref_key:"selectedForm",ref:p,model:s.value},{default:t(()=>[s.value?(r(),g(bl,{key:0,selected:s.value},null,8,["selected"])):k("",!0)]),_:1},8,["model"])]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title","model-value"])])}}}),$l=Le(gl,[["__scopeId","data-v-bca848c2"]]),_l={class:"mb-3"},kl={class:"app-block"},Ql=j({name:"ModelList",__name:"ModelList",setup(L){const{t:B}=ne(),l=y({}),h=y("article"),b=y(),D=y(),n=y([]),o=y([]),E=y(!1),p=y(!1),$=y(!1),s=y(!1),C=y(),i=He(()=>n.value.map(u=>u.id)),I=y(!1),c=async()=>{E.value=!0;try{n.value=await Ge({...Oe(l.value),type:h.value,Q_OrderBy:b.value}),I.value=Object.values(l.value).filter(u=>u!==void 0&&u!=="").length>0||b.value!==void 0}finally{E.value=!1}};De(c);const v=({column:u,prop:V,order:H})=>{var N;V&&H?b.value=((N=u.sortBy)!=null?N:V)+(H==="descending"?"_desc":""):b.value=void 0,c()},a=()=>c(),F=()=>{D.value.clearSort(),ze(l.value),b.value=void 0,c()},O=u=>{C.value=u,$.value=!0},J=u=>{C.value=u,s.value=!0},P=()=>{C.value=void 0,p.value=!0},_=u=>{C.value=u,p.value=!0},T=async u=>{await Te(u),c(),me.success(B("success"))},R=async(u,V)=>{const H=Ne(u,n.value,V);await Ze(H.map(N=>N.id))},m=u=>u.id>10;return(u,V)=>{const H=ie,N=Je,x=he,G=se,W=_e,Q=Ke,ee=$e,le=Ae;return r(),U("div",null,[K("div",_l,[e(d(Ye),{params:l.value,onSearch:a,onReset:F},{default:t(()=>[e(d(Xe),{label:u.$t("model.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),K("div",null,[e(H,{type:"primary",disabled:d(A)("model:create"),icon:d(Re),onClick:V[0]||(V[0]=()=>P())},{default:t(()=>[q(M(u.$t("add")),1)]),_:1},8,["disabled","icon"]),e(N,{title:u.$t("confirmDelete"),onConfirm:V[1]||(V[1]=()=>T(o.value.map(f=>f.id)))},{reference:t(()=>[e(H,{disabled:o.value.length<=0||d(A)("model:delete"),icon:d(Be)},{default:t(()=>[q(M(u.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(ll,{disabled:o.value.length<=0||I.value||d(A)("org:update"),class:"ml-2",onMove:V[2]||(V[2]=f=>R(o.value,f))},null,8,["disabled"]),e(d(xe),{name:"model",class:"ml-2"})]),e(G,{modelValue:h.value,"onUpdate:modelValue":V[3]||(V[3]=f=>h.value=f),class:"mt-3",onChange:V[4]||(V[4]=()=>c())},{default:t(()=>[(r(!0),U(S,null,z(d(te).epRank>=3?["article","channel","form","site","global"]:["article","channel","site","global"],f=>(r(),g(x,{key:f,value:f},{default:t(()=>[q(M(u.$t("model.type.".concat(f))),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),K("div",kl,[We((r(),g(ee,{ref_key:"table",ref:D,data:n.value,onSelectionChange:V[5]||(V[5]=f=>o.value=f),onRowDblclick:V[6]||(V[6]=f=>_(f.id)),onSortChange:v},{default:t(()=>[e(d(el),{name:"model"},{default:t(()=>[e(W,{type:"selection",selectable:m,width:"45"}),e(W,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(W,{property:"name",label:u.$t("model.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(W,{property:"type",label:u.$t("model.type"),sortable:"custom",formatter:f=>u.$t("model.type.".concat(f.type))},null,8,["label","formatter"]),e(W,{property:"scope",label:u.$t("model.scope"),sortable:"custom"},{default:t(({row:f})=>[f.scope===2?(r(),g(Q,{key:0,type:"success",size:"small"},{default:t(()=>[q(M(u.$t("model.scope.".concat(f.scope))),1)]),_:2},1024)):(r(),g(Q,{key:1,type:"info",size:"small"},{default:t(()=>[q(M(u.$t("model.scope.".concat(f.scope))),1)]),_:2},1024))]),_:1},8,["label"]),e(W,{label:u.$t("table.action")},{default:t(({row:f})=>[e(H,{type:"primary",disabled:d(A)("model:update"),size:"small",link:"",onClick:()=>_(f.id)},{default:t(()=>[q(M(u.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),["form","global","site"].includes(f.type)?k("",!0):(r(),g(H,{key:0,type:"primary",disabled:d(A)("model:update"),size:"small",link:"",onClick:()=>O(f.id)},{default:t(()=>[q(M(u.$t("model.fun.systemFields")),1)]),_:2},1032,["disabled","onClick"])),e(H,{type:"primary",disabled:d(A)("model:update"),size:"small",link:"",onClick:()=>J(f.id)},{default:t(()=>[q(M(u.$t("model.fun.customFields")),1)]),_:2},1032,["disabled","onClick"]),m(f)?(r(),g(N,{key:1,title:u.$t("confirmDelete"),onConfirm:()=>T([f.id])},{reference:t(()=>[e(H,{type:"primary",disabled:d(A)("model:delete"),size:"small",link:""},{default:t(()=>[q(M(u.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])):k("",!0)]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[le,E.value]])]),e(pl,{modelValue:p.value,"onUpdate:modelValue":V[7]||(V[7]=f=>p.value=f),"bean-id":C.value,"bean-ids":i.value,"model-type":h.value,onFinished:c},null,8,["modelValue","bean-id","bean-ids","model-type"]),e(fl,{modelValue:$.value,"onUpdate:modelValue":V[8]||(V[8]=f=>$.value=f),"bean-id":C.value},null,8,["modelValue","bean-id"]),e($l,{modelValue:s.value,"onUpdate:modelValue":V[9]||(V[9]=f=>s.value=f),"bean-id":C.value},null,8,["modelValue","bean-id"])])}}});export{Ql as default};
