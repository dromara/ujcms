import{d2 as x,d as I,p as U,ac as V,r as O,b,e as g,I as C,i as _,w as h,j as u,d3 as A,l as j,t as q,k as E,a9 as B,aa as N,u as F,v as Q,cI as R,aL as T,m as z,d4 as D,ci as G,ak as H,a$ as J,f as w,b1 as K,bc as W}from"./index-CfDPjNFe.js";const M=(a,c)=>{for(let n=0,s=a.length;n<s;)c.findIndex(f=>f.title===a[n].title)===-1?(a.splice(n,1),s-=1):n+=1;return c.forEach((n,s)=>{a.findIndex(f=>f.title===n.title)===-1&&a.splice(s,0,{...n})}),a},L=x("ujcmsColumnSettings",{state:()=>({originSettings:{},crrrentSettings:{}}),actions:{getCurrentSettings(a){return this.crrrentSettings[a]||(this.crrrentSettings[a]=[]),this.crrrentSettings[a]},setCurrentSettings(a,c){this.crrrentSettings[a]=c},getOriginSettings(a){return this.originSettings[a]||(this.originSettings[a]=[]),this.originSettings[a]},setOriginSettings(a,c){this.originSettings[a]=c}},persist:{paths:["crrrentSettings"]}}),X={class:"inline-flex align-middle"},Y=["divided"],ne=I({__name:"ColumnSetting",props:{name:{type:String,required:!0}},setup(a){const c=a,{name:n}=U(c),s=L(),f=V(()=>s.getCurrentSettings(n.value)),i=V(()=>s.getOriginSettings(n.value)),r=V(()=>M(f.value,i.value)),y=O(!1),m=()=>{s.setCurrentSettings(n.value,M([],i.value))};return(d,e)=>{const l=b("el-icon"),t=b("el-tooltip"),o=b("el-button"),v=b("el-checkbox"),p=b("el-drawer");return g(),C("div",X,[_(t,{content:d.$t("table.columnsSetting"),placement:"top"},{default:h(()=>[_(l,{class:"text-lg cursor-pointer text-gray-regular",onClick:e[0]||(e[0]=()=>y.value=!0)},{default:h(()=>[_(u(A))]),_:1})]),_:1},8,["content"]),_(p,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=$=>y.value=$),title:d.$t("table.columnsSetting"),size:375},{default:h(()=>[_(o,{class:"mb-1",round:"",onClick:m},{default:h(()=>[j(q(d.$t("reset")),1)]),_:1}),E("ul",null,[(g(!0),C(B,null,N(r.value,($,k)=>(g(),C("li",{key:$.title,divided:k===0},[_(v,{modelValue:$.display,"onUpdate:modelValue":S=>$.display=S},{default:h(()=>[j(q($.title),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])],8,Y))),128))])]),_:1},8,["modelValue","title"])])}}}),ae=I({name:"ColumnList",props:{name:{type:String,required:!0}},setup(a,{slots:c}){const{name:n}=U(a),{t:s}=F(),f=V(()=>{var e,l;return(l=(e=c.default)==null?void 0:e.call(c).flatMap(t=>{var o;return((o=t.children)==null?void 0:o.length)>0?t.children:t}))!=null?l:[]}),i=e=>(e==null?void 0:e.type)==="selection"?s("table.selection"):e==null?void 0:e.label,r=L(),y=V(()=>f.value.map(e=>{var l;return{title:i(e.props),display:((l=e.props)==null?void 0:l.display)!=="none"}}));Q([n,y],()=>{r.setOriginSettings(n.value,y.value)},{deep:!0,immediate:!0});const m=V(()=>r.getCurrentSettings(n.value));return{columns:V(()=>f.value.filter(e=>{var t,o;const l=m.value.find(v=>i(e.props)===v.title);return(o=l==null?void 0:l.display)!=null?o:((t=e.props)==null?void 0:t.display)!=="none"}).map(e=>({...e,key:i(e.props)})).sort((e,l)=>{let t=m.value.findIndex(v=>v.title===i(e));t<0&&(t=f.value.findIndex(v=>i(v)===i(e)));let o=m.value.findIndex(v=>v.title===i(l));return o<0&&(o=f.value.findIndex(v=>i(v)===i(l))),t-o}))}},render(){return this.columns}}),Z=I({name:"QueryInput",props:{inputs:{type:Array,required:!0},name:{type:String,required:!0}},setup(a){const{inputs:c,name:n}=U(a);return()=>c.value.find(s=>s.props.name===n.value)}}),P={class:"flex"},ee={class:"space-y-1"},se=I({__name:"QueryForm",props:{params:{type:Object,required:!0}},emits:{search:null,reset:null},setup(a){const c=a,{params:n}=U(c),s=R();G("params",n);const f=V(()=>{var e,l;return(l=(e=s.default)==null?void 0:e.call(s).flatMap(t=>{var o;return((o=t.children)==null?void 0:o.length)>0?t.children:t}).flatMap(t=>{var o;return((o=t.children)==null?void 0:o.length)>0?t.children:t}).filter(t=>{var o;return((o=t.props)==null?void 0:o.name)!=null}))!=null?l:[]}),i=V(()=>f.value.map(e=>{var l,t;return{label:(l=e.props)==null?void 0:l.label,name:(t=e.props)==null?void 0:t.name}})),r=O([]),y=V(()=>i.value.filter(e=>!r.value.includes(e.name))),m=()=>{Object.keys(n.value).forEach(e=>{!r.value.includes(e)&&r.value.findIndex(l=>l.split(",").includes(e))===-1&&delete n.value[e]})};Q(i,()=>{const[e]=i.value;if(r.value.length>0){const l=i.value.map(t=>t.name);r.value.filter(t=>l.includes(t)),Object.keys(n.value).forEach(t=>{!l.includes(t)&&l.findIndex(o=>o.split(",").includes(t))===-1&&delete n.value[t]})}r.value.length===0&&(r.value=[e.name])},{deep:!0,immediate:!0});const d=e=>{if(e===0){const[l]=y.value;r.value[r.value.length]=l.name}else r.value.splice(e,1),m()};return(e,l)=>{const t=b("el-button"),o=b("el-option"),v=b("el-select"),p=b("el-button-group");return g(),C("form",P,[E("div",ee,[(g(!0),C(B,null,N(r.value,($,k)=>(g(),C("div",{key:$,class:"flex"},[_(t,{icon:k==0?u(H):u(J),disabled:k<=0&&y.value.length<=0,circle:"",onClick:()=>d(k)},null,8,["icon","disabled","onClick"]),_(v,{modelValue:r.value[k],"onUpdate:modelValue":S=>r.value[k]=S,class:"w-36",onChange:l[0]||(l[0]=()=>m())},{default:h(()=>[(g(!0),C(B,null,N(i.value.filter(S=>S.name===r.value[k]||y.value.includes(S)),S=>(g(),w(o,{key:S.name,label:S.label,value:S.name},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"]),_(Z,{inputs:f.value,name:r.value[k]},null,8,["inputs","name"])]))),128))]),E("div",null,[_(p,{class:"ml-2"},{default:h(()=>[_(t,{"native-type":"submit",icon:u(T),onClick:l[1]||(l[1]=z(()=>e.$emit("search"),["prevent"]))},{default:h(()=>[j(q(e.$t("search")),1)]),_:1},8,["icon"]),_(t,{icon:u(D),onClick:l[2]||(l[2]=()=>e.$emit("reset"))},{default:h(()=>[j(q(e.$t("reset")),1)]),_:1},8,["icon"])]),_:1})])])}}}),te={key:0,class:"inline-block"},oe=I({name:"QueryItem",__name:"QueryItem",props:{label:{type:String,required:!0},name:{type:String,required:!0},type:{type:String,default:null},options:{type:Object,default:null},multiple:{type:Boolean,default:!0}},setup(a){const c=a,n=K("params"),{name:s}=U(c),[f,i]=s.value.split(","),r=O(f),y=O(i);return(m,d)=>{const e=b("el-input-number"),l=b("el-date-picker"),t=b("el-option"),o=b("el-select"),v=b("el-input");return W(m.$slots,"default",{},()=>[a.type==="number"?(g(),C("div",te,[_(e,{modelValue:u(n)[r.value],"onUpdate:modelValue":d[0]||(d[0]=p=>u(n)[r.value]=p),placeholder:m.$t("begin.number"),class:"w-48"},null,8,["modelValue","placeholder"]),_(e,{modelValue:u(n)[y.value],"onUpdate:modelValue":d[1]||(d[1]=p=>u(n)[y.value]=p),placeholder:m.$t("end.number"),class:"w-48"},null,8,["modelValue","placeholder"])])):a.type==="date"?(g(),w(l,{key:1,modelValue:u(n)[u(s)],"onUpdate:modelValue":d[2]||(d[2]=p=>u(n)[u(s)]=p),type:"daterange","start-placeholder":m.$t("begin.date"),"end-placeholder":m.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):a.type==="datetime"?(g(),w(l,{key:2,modelValue:u(n)[u(s)],"onUpdate:modelValue":d[3]||(d[3]=p=>u(n)[u(s)]=p),type:"datetimerange","start-placeholder":m.$t("begin.date"),"end-placeholder":m.$t("end.date"),class:"w-96"},null,8,["modelValue","start-placeholder","end-placeholder"])):a.options?(g(),w(o,{key:3,modelValue:u(n)[u(s)],"onUpdate:modelValue":d[4]||(d[4]=p=>u(n)[u(s)]=p),multiple:a.multiple,class:"w-96"},{default:h(()=>[(g(!0),C(B,null,N(a.options,p=>(g(),w(t,{key:p.value,label:p.label,value:p.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","multiple"])):(g(),w(v,{key:4,modelValue:u(n)[u(s)],"onUpdate:modelValue":d[5]||(d[5]=p=>u(n)[u(s)]=p),class:"w-96"},null,8,["modelValue"]))])}}});export{se as _,oe as a,ne as b,ae as c};
