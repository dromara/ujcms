import{d as G,r as y,b as v,e as c,f as g,w as a,i as e,h as $,l as f,t as i,k as w,j as d,u as K,ac as ae,o as O,c as X,I as j,g as W,aD as le,aE as te,E as U,at as S,ah as se,U as Q,aJ as ne,aK as ue,aq as P,m as R,a9 as oe,aa as re,aX as de}from"./index-DgUB5rOh.js";import{d as ie,u as me}from"./config-1OSOhRPa.js";import{a2 as pe,a3 as fe,a4 as J,a5 as ve,a6 as be,a7 as ce}from"./content-DyUbEBXm.js";import{i as ye,j as ge,u as _e,k as Z,l as ke}from"./system-NfXIedzB.js";import{a as $e,_ as he,b as Ve,c as we}from"./QueryItem.vue_vue_type_script_setup_true_lang-B3tRvAfo.js";import{_ as De}from"./DialogForm.vue_vue_type_script_setup_true_lang-Judg_DCV.js";const Se={class:"whitespace-pre-wrap"},Ce=G({name:"TaskForm",__name:"TaskForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(Y){const l=y({});return(m,t)=>{const _=v("el-input"),n=v("el-form-item"),b=v("el-col"),z=v("el-date-picker"),L=v("el-option"),H=v("el-select"),D=v("el-tag"),T=v("el-row");return c(),g(De,{values:l.value,"onUpdate:values":t[7]||(t[7]=r=>l.value=r),name:m.$t("menu.system.task"),"query-bean":d(ye),"create-bean":d(ge),"update-bean":d(_e),"delete-bean":d(Z),"bean-id":Y.beanId,"bean-ids":Y.beanIds,"init-values":()=>({user:{}}),"to-values":r=>({...r}),"disable-edit":()=>!0,addable:!1,perms:"task","model-value":Y.modelValue,large:"","onUpdate:modelValue":t[8]||(t[8]=r=>m.$emit("update:modelValue",r)),onFinished:t[9]||(t[9]=()=>m.$emit("finished"))},{default:a(({})=>[e(T,null,{default:a(()=>[e(b,{span:12},{default:a(()=>[e(n,{prop:"name",label:m.$t("task.name")},{default:a(()=>[e(_,{modelValue:l.value.name,"onUpdate:modelValue":t[0]||(t[0]=r=>l.value.name=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"user.username",label:m.$t("task.user")},{default:a(()=>[e(_,{modelValue:l.value.user.username,"onUpdate:modelValue":t[1]||(t[1]=r=>l.value.user.username=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"beginDate",label:m.$t("task.beginDate")},{default:a(()=>[e(z,{modelValue:l.value.beginDate,"onUpdate:modelValue":t[2]||(t[2]=r=>l.value.beginDate=r),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"endDate",label:m.$t("task.endDate")},{default:a(()=>[e(z,{modelValue:l.value.endDate,"onUpdate:modelValue":t[3]||(t[3]=r=>l.value.endDate=r),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"current",label:m.$t("task.current")},{default:a(()=>[e(_,{modelValue:l.value.current,"onUpdate:modelValue":t[4]||(t[4]=r=>l.value.current=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"processedIn",label:m.$t("task.processedIn")},{default:a(()=>[e(_,{modelValue:l.value.processedIn,"onUpdate:modelValue":t[5]||(t[5]=r=>l.value.processedIn=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{prop:"type",label:m.$t("task.type")},{default:a(()=>[l.value.type?(c(),g(H,{key:0,modelValue:l.value.type,"onUpdate:modelValue":t[6]||(t[6]=r=>l.value.type=r)},{default:a(()=>[e(L,{value:l.value.type,label:m.$t("task.type.".concat(l.value.type))},null,8,["value","label"])]),_:1},8,["modelValue"])):$("",!0)]),_:1},8,["label"])]),_:1}),e(b,{span:12},{default:a(()=>[e(n,{label:m.$t("task.status")},{default:a(()=>[l.value.status===0?(c(),g(D,{key:0,type:"info"},{default:a(()=>[f(i(m.$t("task.status.".concat(l.value.status))),1)]),_:1})):$("",!0),l.value.status===1?(c(),g(D,{key:1},{default:a(()=>[f(i(m.$t("task.status.".concat(l.value.status))),1)]),_:1})):$("",!0),l.value.status===2?(c(),g(D,{key:2,type:"danger"},{default:a(()=>[f(i(m.$t("task.status.".concat(l.value.status))),1)]),_:1})):$("",!0),l.value.status===3?(c(),g(D,{key:3,type:"warning"},{default:a(()=>[f(i(m.$t("task.status.".concat(l.value.status))),1)]),_:1})):$("",!0),l.value.status===4?(c(),g(D,{key:4,type:"success"},{default:a(()=>[f(i(m.$t("task.status.".concat(l.value.status))),1)]),_:1})):$("",!0)]),_:1},8,["label"])]),_:1}),l.value.errorInfo?(c(),g(b,{key:0,span:24},{default:a(()=>[e(n,{label:m.$t("task.errorInfo")},{default:a(()=>[w("pre",null,[w("code",Se,i(l.value.errorInfo),1)])]),_:1},8,["label"])]),_:1})):$("",!0)]),_:1})]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","to-values","model-value"])}}}),Ie={class:"mb-3"},qe={class:"mt-3 app-block"},Ue=G({name:"TaskList",__name:"TaskList",setup(Y,{expose:l}){const{t:m}=K(),t=y({}),_=y(),n=y(1),b=y(10),z=y(0),L=y(),H=y([]),D=y([]),T=y(!1),r=y(!1),E=y(),N=ae(()=>H.value.map(s=>s.id)),o=async()=>{T.value=!0;try{const{content:s,totalElements:p}=await ke({...le(t.value),Q_OrderBy:_.value,page:n.value,pageSize:b.value});H.value=s,z.value=Number(p)}finally{T.value=!1}};O(o);const h=({column:s,prop:p,order:q})=>{var A;p&&q?_.value=((A=s.sortBy)!=null?A:p)+(q==="descending"?"_desc":""):_.value=void 0,o()},C=()=>o(),I=()=>{L.value.clearSort(),te(t.value),_.value=void 0,o()},B=s=>{E.value=s,r.value=!0},M=async s=>{await Z(s),o(),U.success(m("success"))};return l({fetchData:o}),(s,p)=>{const q=v("el-button"),A=v("el-popconfirm"),V=v("el-table-column"),F=v("el-tag"),k=v("el-table"),x=v("el-pagination"),ee=X("loading");return c(),j("div",null,[w("div",Ie,[e(d(he),{params:t.value,onSearch:C,onReset:I},{default:a(()=>[e(d($e),{label:s.$t("task.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),w("div",null,[e(A,{title:s.$t("confirmDelete"),onConfirm:p[0]||(p[0]=()=>M(D.value.map(u=>u.id)))},{reference:a(()=>[e(q,{disabled:D.value.length<=0||d(S)("task:delete"),icon:d(se)},{default:a(()=>[f(i(s.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(d(Ve),{name:"task",class:"ml-2"})]),w("div",qe,[W((c(),g(k,{ref_key:"table",ref:L,data:H.value,onSelectionChange:p[1]||(p[1]=u=>D.value=u),onRowDblclick:p[2]||(p[2]=u=>B(u.id)),onSortChange:h},{default:a(()=>[e(d(we),{name:"task"},{default:a(()=>[e(V,{type:"selection",width:"38"}),e(V,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(V,{property:"name",label:s.$t("task.name"),sortable:"custom","min-width":"150","show-overflow-tooltip":""},null,8,["label"]),e(V,{property:"beginDate",label:s.$t("task.beginDate"),sortable:"custom",width:"170"},{default:a(({row:u})=>[f(i(d(Q)(u.beginDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(V,{property:"endDate",label:s.$t("task.endDate"),sortable:"custom",width:"170",display:"none"},{default:a(({row:u})=>[f(i(d(Q)(u.endDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e(V,{property:"current",label:s.$t("task.current"),"min-width":"70",align:"right"},null,8,["label"]),e(V,{property:"processedIn",label:s.$t("task.processedIn"),"min-width":"70",align:"right"},null,8,["label"]),e(V,{property:"user.username",label:s.$t("task.user"),"sort-by":"user-username",sortable:"custom","min-width":"80",align:"right"},null,8,["label"]),e(V,{property:"status",label:s.$t("task.status"),sortable:"custom",width:"80","show-overflow-tooltip":""},{default:a(({row:u})=>[u.status===0?(c(),g(F,{key:0,type:"info",size:"small"},{default:a(()=>[f(i(s.$t("task.status.".concat(u.status))),1)]),_:2},1024)):$("",!0),u.status===1?(c(),g(F,{key:1,size:"small"},{default:a(()=>[f(i(s.$t("task.status.".concat(u.status))),1)]),_:2},1024)):$("",!0),u.status===2?(c(),g(F,{key:2,type:"danger",size:"small"},{default:a(()=>[f(i(s.$t("task.status.".concat(u.status))),1)]),_:2},1024)):$("",!0),u.status===3?(c(),g(F,{key:3,type:"warning",size:"small"},{default:a(()=>[f(i(s.$t("task.status.".concat(u.status))),1)]),_:2},1024)):$("",!0),u.status===4?(c(),g(F,{key:4,type:"success",size:"small"},{default:a(()=>[f(i(s.$t("task.status.".concat(u.status))),1)]),_:2},1024)):$("",!0)]),_:1},8,["label"]),e(V,{label:s.$t("table.action")},{default:a(({row:u})=>[e(q,{type:"primary",disabled:d(S)("task:show"),size:"small",link:"",onClick:()=>B(u.id)},{default:a(()=>[f(i(s.$t("detail")),1)]),_:2},1032,["disabled","onClick"]),e(A,{title:s.$t("confirmDelete"),onConfirm:()=>M([u.id])},{reference:a(()=>[e(q,{type:"primary",disabled:d(S)("task:delete"),size:"small",link:""},{default:a(()=>[f(i(s.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[ee,T.value]]),e(x,{"current-page":n.value,"onUpdate:currentPage":p[3]||(p[3]=u=>n.value=u),pageSize:b.value,"onUpdate:pageSize":p[4]||(p[4]=u=>b.value=u),total:z.value,"page-sizes":d(ne),layout:d(ue),small:"",background:"",class:"justify-end px-3 py-2",onSizeChange:p[5]||(p[5]=()=>o()),onCurrentChange:p[6]||(p[6]=()=>o())},null,8,["current-page","pageSize","total","page-sizes","layout"])]),e(Ce,{modelValue:r.value,"onUpdate:modelValue":p[7]||(p[7]=u=>r.value=u),"bean-id":E.value,"bean-ids":N.value,onFinished:o},null,8,["modelValue","bean-id","bean-ids"])])}}}),ze={class:"p-3 app-block"},He=w("span",{class:"mx-2"},"|",-1),Te={class:"p-3 mt-3 app-block"},Ae={class:"pb-2 border-b text-gray-primary"},Fe={class:"p-3 mt-3 app-block"},Pe={class:"text-gray-primary"},Ne=G({name:"GeneratorForm",__name:"GeneratorForm",setup(Y){const{t:l}=K(),m=y(),t=y({}),_=y(!1),n=y(!1),b=y(),z=async()=>{t.value=await ie()};O(async()=>{_.value=!0;try{await z()}finally{_.value=!1}});const L=async()=>{n.value=!0;try{await pe(),await b.value.fetchData(),U.success(l("success"))}finally{n.value=!1}},H=async()=>{n.value=!0;try{await fe(),await b.value.fetchData(),U.success(l("success"))}finally{n.value=!1}},D=async()=>{n.value=!0;try{await J(),await b.value.fetchData(),U.success(l("success"))}finally{n.value=!1}},T=async()=>{n.value=!0;try{await ve(),U.success(l("success"))}finally{n.value=!1}},r=async()=>{n.value=!0;try{await be(),await b.value.fetchData(),U.success(l("success"))}finally{n.value=!1}},E=async()=>{n.value=!0;try{await ce(),await b.value.fetchData(),U.success(l("success"))}finally{n.value=!1}},N=()=>{m.value&&m.value.validate(async o=>{if(o){_.value=!0;try{await me(t.value),await J(),await b.value.fetchData(),U.success(l("success"))}finally{_.value=!1}}})};return(o,h)=>{const C=v("el-button"),I=v("el-form-item"),B=v("el-form"),M=v("el-switch"),s=v("el-col"),p=v("el-input"),q=v("el-option"),A=v("el-select"),V=v("el-row"),F=X("loading");return c(),j("div",null,[w("div",ze,[e(B,{"label-width":"200px"},{default:a(()=>[e(I,null,{label:a(()=>[e(P,{message:"generator.fulltext",help:""})]),default:a(()=>[e(C,{disabled:d(S)("generator:fulltext:reindexAll"),loading:n.value,type:"primary",plain:"",onClick:R(L,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.fulltext.reindexAll")),1)]),_:1},8,["disabled","loading"]),d(de)("generator:fulltext:reindexSite")?(c(),g(C,{key:0,disabled:d(S)("generator:fulltext:reindexSite"),loading:n.value,type:"primary",plain:"",onClick:R(H,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.fulltext.reindexSite")),1)]),_:1},8,["disabled","loading"])):$("",!0)]),_:1}),e(I,null,{label:a(()=>[e(P,{message:"generator.html",help:""})]),default:a(()=>[e(C,{disabled:d(S)("generator:html"),loading:n.value,type:"primary",plain:"",onClick:R(D,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.html.all")),1)]),_:1},8,["disabled","loading"]),He,e(C,{disabled:d(S)("generator:html"),loading:n.value,type:"primary",plain:"",onClick:R(T,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.html.home")),1)]),_:1},8,["disabled","loading"]),e(C,{disabled:d(S)("generator:html"),loading:n.value,type:"primary",plain:"",onClick:R(r,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.html.channel")),1)]),_:1},8,["disabled","loading"]),e(C,{disabled:d(S)("generator:html"),loading:n.value,type:"primary",plain:"",onClick:R(E,["prevent"])},{default:a(()=>[f(i(o.$t("generator.op.html.article")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),w("div",Te,[w("div",Ae,i(o.$t("site.settings.html")),1),W((c(),g(B,{ref_key:"form",ref:m,class:"mt-3",model:t.value,disabled:d(S)("siteSettings:html:update"),"label-width":"200px"},{default:a(()=>[e(V,null,{default:a(()=>[e(s,{span:12},{default:a(()=>[e(I,{prop:"enabled",rules:{required:!0,message:()=>o.$t("v.required")}},{label:a(()=>[e(P,{message:"site.html.enabled",help:""})]),default:a(()=>[e(M,{modelValue:t.value.enabled,"onUpdate:modelValue":h[0]||(h[0]=k=>t.value.enabled=k)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"auto",rules:{required:!0,message:()=>o.$t("v.required")}},{label:a(()=>[e(P,{message:"site.html.auto",help:""})]),default:a(()=>[e(M,{modelValue:t.value.auto,"onUpdate:modelValue":h[1]||(h[1]=k=>t.value.auto=k)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"channel",rules:{required:!0,message:()=>o.$t("v.required")}},{label:a(()=>[e(P,{message:"site.html.channel",help:""})]),default:a(()=>[e(p,{modelValue:t.value.channel,"onUpdate:modelValue":h[2]||(h[2]=k=>t.value.channel=k),maxlength:"100"},{append:a(()=>[f(".html")]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"article",rules:{required:!0,message:()=>o.$t("v.required")}},{label:a(()=>[e(P,{message:"site.html.article",help:""})]),default:a(()=>[e(p,{modelValue:t.value.article,"onUpdate:modelValue":h[3]||(h[3]=k=>t.value.article=k),maxlength:"100"},{append:a(()=>[f(".html")]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(s,{span:12},{default:a(()=>[e(I,{prop:"listPages",rules:{required:!0,message:()=>o.$t("v.required")}},{label:a(()=>[e(P,{message:"site.html.listPages",help:""})]),default:a(()=>[e(A,{modelValue:t.value.listPages,"onUpdate:modelValue":h[4]||(h[4]=k=>t.value.listPages=k),placeholder:"Select"},{default:a(()=>[(c(),j(oe,null,re([{label:"1",value:1},{label:"3",value:3},{label:"10",value:10},{label:"100",value:100},{label:"1000",value:1e3},{label:"全部",value:2147483647}],k=>e(q,{key:k.value,label:k.label,value:k.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1}),w("div",null,[e(C,{disabled:d(S)("siteSettings:html:update"),type:"primary","native-type":"submit",onClick:R(N,["prevent"])},{default:a(()=>[f(i(o.$t("submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model","disabled"])),[[F,_.value]])]),w("div",Fe,[w("div",Pe,i(o.$t("generator.taskList")),1)]),e(Ue,{ref_key:"taskListRef",ref:b,class:"mt-3"},null,512)])}}});export{Ne as default};
