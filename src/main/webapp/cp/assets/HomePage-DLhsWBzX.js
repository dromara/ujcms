import{d as G,u as K,S as y,T as P,r as x,o as X,U as M,V as $,W as j,X as Z,b as S,e as c,K as f,i as t,w as s,f as b,k as e,j as h,Y as C,n as i,t as a,h as k,Z as J,$ as Q,L as tt,a0 as et,a1 as B}from"./index-B6OoDg6B.js";import{d as st}from"./duration-Bs6V08tO.js";import{q as at,a as nt,b as lt}from"./stat-CFOZ0IOn.js";import{q as ot,a as it,b as rt,c as ut}from"./content-2hwtLvQa.js";import{q as dt}from"./interaction-BCiQ8biV.js";const ct={class:"mb-3 shadow-md bg-warning-lighter"},vt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},ft={class:"flex items-center"},pt={class:"mb-3 shadow-md bg-warning-lighter"},_t={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},mt={class:"flex items-center"},yt={class:"mb-3 shadow-md bg-warning-lighter"},ht={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},gt={class:"flex items-center"},xt={class:"mb-3 shadow-md bg-warning-lighter"},wt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},bt={class:"flex items-center"},Ct={class:"mb-3 shadow-md bg-warning-lighter"},kt={class:"flex items-center justify-between px-4 py-3 text-xl text-warning"},$t={class:"flex items-center"},jt={class:"p-3 app-block"},St={class:"text-sm text-gray-secondary"},Vt={class:"flex items-end justify-between mt-1"},qt={class:"text-3xl text-primary"},Yt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-primary"},Dt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Rt={class:"p-3 app-block"},Mt={class:"text-sm text-gray-secondary"},Tt={class:"flex items-end justify-between mt-1"},At={class:"text-3xl text-primary"},Pt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-warning"},Bt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Nt={class:"p-3 app-block"},Ft={class:"text-sm text-gray-secondary"},Ot={class:"flex items-end justify-between mt-1"},Lt={class:"text-3xl text-primary"},zt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-success"},Ht={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Ut={class:"p-3 app-block"},It={class:"text-sm text-gray-secondary"},Et={class:"flex items-end justify-between mt-1"},Wt={class:"text-3xl text-primary"},Gt={class:"flex items-center justify-center w-12 h-12 text-xl text-white rounded bg-danger"},Kt={class:"flex justify-between pt-2 mt-3 text-xs border-t text-gray-regular"},Xt={class:"px-3 py-5 mt-3 app-block"},Zt={class:"flex p-3 mt-3 justify-evenly app-block"},Jt={class:"h-64 w-60 text-primary"},Qt={class:"mt-2 text-center"},te={class:"flex items-center justify-center mt-2"},ee={class:"text-3xl"},se={key:0},ae={key:1},ne={class:"mt-4 space-y-2 text-sm"},le={key:0},oe={key:1},ie={key:0},re={key:1},ue={key:0},de={key:1},ce={class:"h-64 w-60 text-gray-secondary"},ve={class:"mt-2 text-center"},fe={class:"flex items-center justify-center mt-2"},pe={class:"text-3xl"},_e={key:0},me={key:1},ye={class:"mt-4 space-y-2 text-sm"},he={key:0},ge={key:1},xe={key:0},we={key:1},be={key:0},Ce={key:1},ke={class:"p-3 mt-3 app-block"},De=G({__name:"HomePage",setup($e){const{t:w,n:N}=K();y.extend(st);const T=P(),F=async()=>{const n=await at({begin:y().startOf("day").subtract(1,"day").format(),end:y().endOf("day").format()}),o={tooltip:{trigger:"axis"},legend:{data:[w("visitTrend.yesterdayPv"),w("visitTrend.todayPv")]},grid:{left:16,right:16,top:40,bottom:0,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:Array.from(Array(24).keys())},yAxis:{type:"value",minInterval:1},series:[{name:w("visitTrend.yesterdayPv"),type:"line",symbol:"circle",color:"#a0cfff",data:n.filter(l=>y(l.date)<y().startOf("day")).map(l=>Number(l.pvCount))},{name:w("visitTrend.todayPv"),type:"line",symbol:"circle",color:"#409eff",areaStyle:{color:"#ecf5ff"},data:n.filter(l=>y(l.date)>=y().startOf("day")).map(l=>Number(l.pvCount))}]},v=T.value;if(v==null)return;let d=j.getInstanceByDom(v);d==null&&(d=j.init(v)),d.setOption(o),window.addEventListener("resize",function(){d&&d.resize()})},A=P(),O=async()=>{const n=await nt({begin:y().subtract(30,"day").format("YYYY-MM-DD"),end:y().format("YYYY-MM-DD")}),o={title:{text:w("menu.stat.visitSource"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},tooltip:{trigger:"item",valueFormatter:l=>N(l)},series:[{name:w("menu.stat.visitSource"),type:"pie",radius:["44%","80%"],center:["40%","54%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:4,borderColor:"#fff",borderWidth:2},label:{show:!1},emphasis:{label:{show:!1}},labelLine:{show:!1},data:n.map(l=>({value:Number(l.pvCount),name:w("visitSource.type.".concat(l.name))}))}]},v=A.value;if(v==null)return;let d=j.getInstanceByDom(v);d==null&&(d=j.init(v)),d.setOption(o),window.addEventListener("resize",function(){d&&d.resize()})},r=x({}),u=x({}),L=async()=>{const n=await lt({begin:y().subtract(30,"day").format("YYYY-MM-DD"),end:y().format("YYYY-MM-DD")});r.value=n.newVisitor,u.value=n.oldVisitor,r.value.pvCount=Number(r.value.pvCount),u.value.pvCount=Number(u.value.pvCount),r.value.uvCount=Number(r.value.uvCount),u.value.uvCount=Number(u.value.uvCount);const o=r.value.uvCount+u.value.uvCount;o>0?(r.value.proportion=r.value.uvCount*100/o,u.value.proportion=u.value.uvCount*100/o):(r.value.proportion=50,u.value.proportion=50)},g=x({}),z=async()=>{g.value=await Z()},V=x(0),H=async()=>{$.epRank>=1&&(V.value=await ot())},q=x(0),U=async()=>{$.epRank>=1&&(q.value=await it())},Y=x(0),I=async()=>{Y.value=await dt()},D=x(0),E=async()=>{$.epRank>=3&&(D.value=await rt())},R=x(0),W=async()=>{$.epRank>=3&&(R.value=await ut())};return X(async()=>{M("articleReview:list")&&(H(),U()),M("formReview:list")&&(E(),W()),M("messageBoard:list")&&I(),F(),O(),L(),z()}),(n,o)=>{const v=S("el-icon"),d=S("el-link"),l=S("el-col"),m=S("el-row");return c(),f("div",null,[t(m,{gutter:12},{default:s(()=>[V.value>0?(c(),b(l,{key:0,span:6},{default:s(()=>[e("div",ct,[e("div",vt,[e("div",ft,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[0]||(o[0]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[i(a(n.$t("todo.pendingArticle")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[1]||(o[1]=()=>n.$router.push({path:"/content/article-review"}))},{default:s(()=>[i(a(V.value),1)]),_:1})])])])]),_:1})):k("",!0),q.value>0?(c(),b(l,{key:1,span:6},{default:s(()=>[e("div",pt,[e("div",_t,[e("div",mt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[2]||(o[2]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[i(a(n.$t("todo.rejectedArticle")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[3]||(o[3]=()=>n.$router.push({path:"/content/article",query:{status:22}}))},{default:s(()=>[i(a(q.value),1)]),_:1})])])])]),_:1})):k("",!0),D.value>0?(c(),b(l,{key:2,span:6},{default:s(()=>[e("div",yt,[e("div",ht,[e("div",gt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[4]||(o[4]=()=>n.$router.push({path:"/content/form-review"}))},{default:s(()=>[i(a(n.$t("todo.pendingForm")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[5]||(o[5]=()=>n.$router.push({path:"/content/form-review"}))},{default:s(()=>[i(a(D.value),1)]),_:1})])])])]),_:1})):k("",!0),R.value>0?(c(),b(l,{key:3,span:6},{default:s(()=>[e("div",xt,[e("div",wt,[e("div",bt,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[6]||(o[6]=()=>n.$router.push({path:"/content/form",query:{status:22}}))},{default:s(()=>[i(a(n.$t("todo.rejectedForm")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[7]||(o[7]=()=>n.$router.push({path:"/content/form",query:{status:22}}))},{default:s(()=>[i(a(R.value),1)]),_:1})])])])]),_:1})):k("",!0),Y.value>0?(c(),b(l,{key:4,span:6},{default:s(()=>[e("div",Ct,[e("div",kt,[e("div",$t,[t(v,null,{default:s(()=>[t(h(C))]),_:1}),t(d,{class:"ml-1 text-base",type:"warning",underline:!1,onClick:o[8]||(o[8]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[i(a(n.$t("todo.unreviewedMessageBoard")),1)]),_:1})]),e("div",null,[t(d,{class:"ml-1 text-xl",type:"warning",underline:!1,onClick:o[9]||(o[9]=()=>n.$router.push({path:"/interaction/message-board",query:{status:1}}))},{default:s(()=>[i(a(Y.value),1)]),_:1})])])])]),_:1})):k("",!0)]),_:1}),t(m,{gutter:12},{default:s(()=>[t(l,{span:6},{default:s(()=>{var p,_;return[e("div",jt,[e("div",St,a(n.$t("contentStat.article")),1),e("div",Vt,[e("div",qt,a((p=g.value.article)==null?void 0:p.total),1),e("div",Yt,[t(v,null,{default:s(()=>[t(h(J))]),_:1})])]),e("div",Dt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.article)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Rt,[e("div",Mt,a(n.$t("contentStat.channel")),1),e("div",Tt,[e("div",At,a((p=g.value.channel)==null?void 0:p.total),1),e("div",Pt,[t(v,null,{default:s(()=>[t(h(Q))]),_:1})])]),e("div",Bt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.channel)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Nt,[e("div",Ft,a(n.$t("contentStat.user")),1),e("div",Ot,[e("div",Lt,a((p=g.value.user)==null?void 0:p.total),1),e("div",zt,[t(v,null,{default:s(()=>[t(h(tt))]),_:1})])]),e("div",Ht,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.user)==null?void 0:_.last7day),1)])])]}),_:1}),t(l,{span:6},{default:s(()=>{var p,_;return[e("div",Ut,[e("div",It,a(n.$t("contentStat.attachment")),1),e("div",Et,[e("div",Wt,a((p=g.value.attachment)==null?void 0:p.total),1),e("div",Gt,[t(v,null,{default:s(()=>[t(h(et))]),_:1})])]),e("div",Kt,[e("div",null,a(n.$t("contentStat.last7day")),1),e("div",null,a((_=g.value.attachment)==null?void 0:_.last7day),1)])])]}),_:1})]),_:1}),e("div",Xt,[e("div",{ref_key:"trendChart",ref:T,class:"h-64"},null,512)]),t(m,{gutter:12},{default:s(()=>[t(l,{span:12},{default:s(()=>{var p,_;return[e("div",Zt,[e("div",Jt,[e("div",Qt,a(n.$t("visitVisitor.newVisitor")),1),e("div",te,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(B))]),_:1}),e("span",ee,[r.value.uvCount>0?(c(),f("span",se,a(n.$n((p=r.value.proportion)!=null?p:0,"decimal")),1)):(c(),f("span",ae,"-")),o[10]||(o[10]=i("% "))])]),e("div",ne,[t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(r.value.pvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(r.value.uvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",le,a(n.$n(r.value.bounceCount*100/r.value.uvCount,"decimal"))+"%",1)):(c(),f("span",oe,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",ie,a(h(y).duration(r.value.duration/r.value.uvCount,"seconds").format("HH:mm:ss")),1)):(c(),f("span",re,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[r.value.uvCount>0?(c(),f("span",ue,a(n.$n(r.value.pvCount/r.value.uvCount,"decimal")),1)):(c(),f("span",de,"-"))]),_:1})]),_:1})])]),e("div",ce,[e("div",ve,a(n.$t("visitVisitor.oldVisitor")),1),e("div",fe,[t(v,{class:"text-5xl"},{default:s(()=>[t(h(B))]),_:1}),e("span",pe,[u.value.uvCount>0?(c(),f("span",_e,a(n.$n((_=u.value.proportion)!=null?_:0,"decimal")),1)):(c(),f("span",me,"-")),o[11]||(o[11]=i("% "))])]),e("div",ye,[t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.pv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(u.value.pvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visitVisitor.uv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[i(a(u.value.uvCount),1)]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.bounceRate")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",he,a(n.$n(u.value.bounceCount*100/u.value.uvCount,"decimal"))+"%",1)):(c(),f("span",ge,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averageDuration")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",xe,a(h(y).duration(u.value.duration/u.value.uvCount,"seconds").format("HH:mm:ss")),1)):(c(),f("span",we,"-"))]),_:1})]),_:1}),t(m,{gutter:24},{default:s(()=>[t(l,{span:12,class:"text-right"},{default:s(()=>[i(a(n.$t("visit.averagePv")),1)]),_:1}),t(l,{span:12},{default:s(()=>[u.value.uvCount>0?(c(),f("span",be,a(n.$n(u.value.pvCount/u.value.uvCount,"decimal")),1)):(c(),f("span",Ce,"-"))]),_:1})]),_:1})])])])]}),_:1}),t(l,{span:12},{default:s(()=>[e("div",ke,[e("div",{ref_key:"sourceTypeChart",ref:A,class:"w-full h-64"},null,512)])]),_:1})]),_:1})])}}});export{De as default};
