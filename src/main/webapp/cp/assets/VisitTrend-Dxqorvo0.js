import{d as h,u as w,r as C,T as x,o as O,S as n,W as y,b as m,e as p,K as f,k as d,i as v,w as g,a7 as k,a8 as B,n as V,t as N}from"./index-B6OoDg6B.js";import{q as T}from"./stat-CFOZ0IOn.js";const D={class:"p-3 mt-3 app-block"},I=h({__name:"VisitTrend",setup(R){const{t:s}=w(),i=C("last30day"),b=e=>{switch(e){case"now":return n().subtract(2,"hour").format();case"today":return n().startOf("day").format();case"yesterday":return n().startOf("day").subtract(1,"day").format();case"last7day":return n().startOf("day").subtract(6,"day").format();case"last30day":return n().startOf("day").subtract(29,"day").format();case"lastYear":return n().startOf("day").subtract(1,"year").format();default:return}},_=e=>e==="now"?n().format():e==="yesterday"?n().endOf("day").subtract(1,"day").format():n().endOf("day").format(),u=x(),c=async e=>{const a=await T({begin:b(e),end:_(e)}),l={tooltip:{trigger:"axis"},legend:{data:[s("visit.pv"),s("visit.uv"),s("visit.ip")]},grid:{left:16,right:24,top:40,bottom:8,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:a.map(r=>r.dateString)},yAxis:{type:"value",minInterval:1},series:[{name:s("visit.pv"),type:"line",symbol:a.length>30?"none":"circle",data:a.map(r=>Number(r.pvCount))},{name:s("visit.uv"),type:"line",symbol:a.length>30?"none":"circle",data:a.map(r=>Number(r.uvCount))},{name:s("visit.ip"),type:"line",symbol:a.length>30?"none":"circle",data:a.map(r=>Number(r.ipCount))}]},o=u.value;if(o==null)return;let t=y.getInstanceByDom(o);t==null&&(t=y.init(o)),t.setOption(l),window.addEventListener("resize",function(){t&&t.resize()})};return O(async()=>{c(i.value)}),(e,a)=>{const l=m("el-radio-button"),o=m("el-radio-group");return p(),f("div",null,[d("div",D,[d("div",null,[v(o,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t),onChange:a[1]||(a[1]=t=>c(t))},{default:g(()=>[(p(),f(k,null,B(["now","today","yesterday","last7day","last30day","lastYear","all"],t=>v(l,{key:t,value:t},{default:g(()=>[V(N(e.$t("visit.".concat(t))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),d("div",{ref_key:"trendChart",ref:u,class:"h-80"},null,512)])])}}});export{I as default};
