import{d as q,r,b as k,c as D,w as l,h as e,i as j,j as x,b3 as M,k as t,u as W,ar as Z,o as G,bi as H,t as S,aw as J,P as K,l as h,bs as X,v as T,x as w,aW as Y,b5 as g,m as ee,aZ as ae,e as se,y as le,aQ as te,a3 as oe,ay as ne,bk as de,aP as re}from"./index-__TSAjOL.js";import{E as ie}from"./el-popover-B2t_MYt0.js";import{S as ue}from"./sortable.esm-DEaZq8gs.js";import{a7 as U,a8 as me,a9 as pe,aa as ce,h as be,ab as fe}from"./config-BS48XX7b.js";import{a as ve,_ as ye,b as ge,c as _e}from"./QueryItem.vue_vue_type_script_setup_true_lang-CDNlcHM_.js";import{_ as Be}from"./DialogForm.vue_vue_type_script_setup_true_lang-CYMSRniG.js";import"./el-select-CPBsiljt.js";import"./el-switch-Cg-m0Y0i.js";const Te=q({name:"MessageBoardTypeForm",__name:"MessageBoardTypeForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(_){const y=r(),i=r({});return(u,o)=>{const m=x,b=j;return k(),D(Be,{values:i.value,"onUpdate:values":o[2]||(o[2]=n=>i.value=n),name:u.$t("menu.config.messageBoardType"),"query-bean":t(ce),"create-bean":t(pe),"update-bean":t(me),"delete-bean":t(U),"bean-id":_.beanId,"bean-ids":_.beanIds,focus:y.value,"init-values":()=>({}),"to-values":n=>({...n}),"model-value":_.modelValue,perms:"messageBoardType","onUpdate:modelValue":o[3]||(o[3]=n=>u.$emit("update:modelValue",n)),onFinished:o[4]||(o[4]=()=>u.$emit("finished"))},{default:l(({})=>[e(b,{prop:"name",rules:{required:!0,message:()=>u.$t("v.required")}},{label:l(()=>[e(M,{message:"messageBoardType.name"})]),default:l(()=>[e(m,{ref_key:"focus",ref:y,modelValue:i.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>i.value.name=n),maxlength:"30"},null,8,["modelValue"])]),_:1},8,["rules"]),e(b,{prop:"description"},{label:l(()=>[e(M,{message:"messageBoardType.description"})]),default:l(()=>[e(m,{modelValue:i.value.description,"onUpdate:modelValue":o[1]||(o[1]=n=>i.value.description=n),type:"textarea",rows:3,maxlength:"300"},null,8,["modelValue"])]),_:1})]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","to-values","model-value"])}}}),we={class:"mb-3"},$e={class:"space-x-2"},Ve={class:"mt-3 app-block"},De=q({name:"MessageBoardTypeList",__name:"MessageBoardTypeList",setup(_){const{t:y}=W(),i=r({}),u=r(),o=r(),m=r([]),b=r([]),n=r(!1),B=r(!1),$=r(),F=Z(()=>m.value.map(a=>a.id)),C=r(!1),f=async()=>{n.value=!0;try{m.value=await be({...H(i.value),Q_OrderBy:u.value}),C.value=u.value!==void 0}finally{n.value=!1}};let V;const P=()=>{const a=document.querySelector("#dataTable .el-table__body-wrapper tbody");V=ue.create(a,{handle:".drag-handle",animation:200,chosenClass:"sortable-chosen",onEnd:async function(s){const{oldIndex:d,newIndex:c}=s;d!==c&&(await fe(m.value[d].id,m.value[c].id),m.value.splice(c,0,m.value.splice(d,1)[0]),S.success(y("success")))}})};G(()=>{f(),P()}),J(()=>{V!==void 0&&V.destroy()});const L=({column:a,prop:s,order:d})=>{var c;s&&d?u.value=((c=a.sortBy)!=null?c:s)+(d==="descending"?"_desc":""):u.value=void 0,f()},z=()=>f(),N=()=>{o.value.clearSort(),X(i.value),u.value=void 0,f()},Q=()=>{$.value=void 0,B.value=!0},I=a=>{$.value=a,B.value=!0},E=async a=>{await U(a),f(),S.success(y("success"))};return(a,s)=>{const d=ee,c=ie,v=te,R=oe,A=re,O=le;return k(),K("div",null,[h("div",we,[e(t(ye),{params:i.value,onSearch:z,onReset:s[0]||(s[0]=()=>N())},{default:l(()=>[e(t(ve),{label:a.$t("messageBoardType.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),h("div",$e,[e(d,{type:"primary",disabled:t(g)("messageBoardType:create"),icon:t(Y),onClick:s[1]||(s[1]=()=>Q())},{default:l(()=>[T(w(a.$t("add")),1)]),_:1},8,["disabled","icon"]),e(c,{title:a.$t("confirmDelete"),onConfirm:s[2]||(s[2]=()=>E(b.value.map(p=>p.id)))},{reference:l(()=>[e(d,{disabled:b.value.length<=0||t(g)("messageBoardType:delete"),icon:t(ae)},{default:l(()=>[T(w(a.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(t(ge),{name:"messageBoardType"})]),h("div",Ve,[se((k(),D(A,{id:"dataTable",ref_key:"table",ref:o,"row-key":"id",data:m.value,onSelectionChange:s[3]||(s[3]=p=>b.value=p),onRowDblclick:s[4]||(s[4]=p=>I(p.id)),onSortChange:L},{default:l(()=>[e(t(_e),{name:"messageBoardType"},{default:l(()=>[e(v,{type:"selection",width:"38"}),e(v,{width:"42"},{default:l(()=>[e(R,{class:ne(["text-lg align-middle",C.value||t(g)("messageBoardType:update")?["cursor-not-allowed","text-gray-disabled"]:["cursor-move","text-gray-secondary","drag-handle"]]),disalbed:""},{default:l(()=>[e(t(de))]),_:1},8,["class"])]),_:1}),e(v,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(v,{property:"name",label:a.$t("messageBoardType.name"),sortable:"custom","min-width":120,"show-overflow-tooltip":""},null,8,["label"]),e(v,{property:"description",label:a.$t("messageBoardType.description"),sortable:"custom","min-width":240,"show-overflow-tooltip":""},null,8,["label"]),e(v,{label:a.$t("table.action")},{default:l(({row:p})=>[e(d,{type:"primary",disabled:t(g)("messageBoardType:update"),size:"small",link:"",onClick:()=>I(p.id)},{default:l(()=>[T(w(a.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(c,{title:a.$t("confirmDelete"),onConfirm:()=>E([p.id])},{reference:l(()=>[e(d,{type:"primary",disabled:t(g)("messageBoardType:delete"),size:"small",link:""},{default:l(()=>[T(w(a.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[O,n.value]])]),e(Te,{modelValue:B.value,"onUpdate:modelValue":s[5]||(s[5]=p=>B.value=p),"bean-id":$.value,"bean-ids":F.value,onFinished:s[6]||(s[6]=()=>f())},null,8,["modelValue","bean-id","bean-ids"])])}}});export{De as default};
