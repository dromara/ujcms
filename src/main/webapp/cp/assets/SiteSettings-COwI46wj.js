import{d as me,u as pe,b4 as ve,r as g,ar as K,Z as h,$ as U,B as fe,o as ge,b as r,c as f,w as a,h as e,b8 as be,P as m,aF as p,aG as v,b9 as ye,e as Ve,E as _e,a6 as we,a2 as Se,i as ke,b3 as i,k,l as B,j as qe,f as $e,v as T,x as F,m as he,n as Ue,t as Ee,b5 as Ce,g as Le,y as Ie,_ as Be}from"./index-__TSAjOL.js";import{E as Te,a as Fe,b as We}from"./el-main-CxOwtB5j.js";import{E as ce,a as He,c as Me}from"./el-select-CPBsiljt.js";import{E as De}from"./el-divider-C5kIveuS.js";import{E as Re,_ as Ke}from"./FieldItem.vue_vue_type_script_setup_true_lang-B_vgS7r5.js";import{E as ze,a as Ae}from"./el-radio-group-B2Xrve8Z.js";/* empty css                 */import{E as Ne}from"./el-switch-Cg-m0Y0i.js";import{t as Pe}from"./tree-CFBn_SXc.js";import{F as xe,q as Oe,G as z,H as Ge,I as Je,J as je,K as Ye,L as Ze}from"./config-BS48XX7b.js";import{b as Qe}from"./user-Cc_GcFRq.js";import{a as A}from"./FileListUpload.vue_vue_type_style_index_0_scoped_b3a09e2e_lang-BDXrjCRY.js";import"./BaseUpload.vue_vue_type_style_index_0_scoped_248c0508_lang-XLXSgCOW.js";import"./vuedraggable.umd-BWOm6k_s.js";/* empty css                          *//* empty css                        */import"./content-BqI55UAh.js";import"./Tinymce-DiWOJB96.js";import"./BaseUpload-DtBZbJkV.js";import"./position-BrJTBGCI.js";import"./sortable.esm-DEaZq8gs.js";const Xe={class:"watermark-position"},el=["innerHTML"],ll={key:6},al=me({name:"SiteSettings",__name:"SiteSettings",emits:{"update:modelValue":null,finished:null},setup(tl){const{t:N}=pe(),P=ve(),W=g(),_=g(),t=g({}),q=g(!1),E=g(!1),x=g([]),C=g([]),L=g([]),c=g(),O=K(()=>L.value.find(s=>s.id===c.value)),G=K(()=>{var s;return JSON.parse(((s=O.value)==null?void 0:s.customs)||"[]")}),w=[];h("siteSettings:base:update")&&w.push("base"),h("siteSettings:watermark:update")&&w.push("watermark"),h("siteSettings:editor:update")&&(U.epRank>=2||U.epDisplay)&&w.push("editor"),h("siteSettings:messageBoard:update")&&w.push("messageBoard"),h("siteSettings:customs:update")&&w.push("customs");const d=g(w[0]),H=()=>{d.value==="watermark"?t.value=_.value.watermark:d.value==="editor"?(t.value=_.value.editor,t.value.typesetting==null&&(t.value.typesetting={fontFamily:"",fontSize:"",lineHeight:"",textIndent:!1,imageCenterAlign:!0,tableFullWidth:!0,emptyLine:"one",halfWidthCharConversion:!0})):d.value==="messageBoard"?t.value=_.value.messageBoard:d.value==="customs"?t.value=_.value.customs:t.value=_.value};fe(d,()=>H());const J=async()=>{C.value=await xe()},j=async()=>{x.value=Pe(await Qe())},Y=async()=>{L.value=await Oe({type:"site"})},M=async()=>{_.value=await z(),c.value=_.value.modelId};ge(async()=>{q.value=!0;try{await Promise.all([J(),j(),Y(),M()]),H()}finally{q.value=!1}});const Z=async()=>{q.value=!0;try{await M()}finally{q.value=!1}},Q=()=>{W.value.validate(async s=>{if(s){E.value=!0;try{d.value==="watermark"?await Ge(t.value):d.value==="editor"?await Je(t.value):d.value==="messageBoard"?await je(t.value):d.value==="customs"?await Ye(t.value):await Ze(t.value),P.currentSite=await z(),Ee.success(N("success"))}finally{E.value=!1}Z()}})};return(s,u)=>{const X=ye,ee=be,le=Te,S=Ne,o=ke,n=Se,D=Ae,R=ze,ae=Re,b=qe,$=we,te=$e,ue=De,y=He,V=ce,se=Me,oe=he,ne=_e,ie=Fe,re=We,de=Ie;return r(),f(re,null,{default:a(()=>[e(le,{width:"180px",class:"pr-3"},{default:a(()=>[e(ee,{modelValue:d.value,"onUpdate:modelValue":u[0]||(u[0]=l=>d.value=l),"tab-position":"left",stretch:"",class:"bg-white"},{default:a(()=>[(r(),m(p,null,v(w,l=>e(X,{key:l,name:l,label:s.$t("site.settings.".concat(l))},null,8,["name","label"])),64))]),_:1},8,["modelValue"])]),_:1}),e(ie,{class:"p-3 app-block"},{default:a(()=>[Ve((r(),f(ne,{ref_key:"form",ref:W,model:t.value,"label-width":"150px"},{default:a(()=>[d.value==="watermark"?(r(),f($,{key:0},{default:a(()=>[e(n,{span:24},{default:a(()=>[e(o,{prop:"enabled",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.watermark.enabled",help:""})]),default:a(()=>[e(S,{modelValue:t.value.enabled,"onUpdate:modelValue":u[1]||(u[1]=l=>t.value.enabled=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"overlay",label:s.$t("site.watermark.overlay"),rules:t.value.enabled?{required:!0,message:()=>s.$t("v.required")}:{}},{default:a(()=>[e(k(A),{modelValue:t.value.overlay,"onUpdate:modelValue":u[2]||(u[2]=l=>t.value.overlay=l)},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"position",label:s.$t("site.watermark.position"),rules:{required:!0,message:()=>s.$t("v.required")}},{default:a(()=>[e(R,{modelValue:t.value.position,"onUpdate:modelValue":u[3]||(u[3]=l=>t.value.position=l)},{default:a(()=>[B("div",Xe,[(r(),m(p,null,v(9,l=>e(D,{key:l,value:l,title:s.$t("site.watermark.position.".concat(l))},{default:a(()=>u[30]||(u[30]=[B("span",null,null,-1)])),_:2},1032,["value","title"])),64))])]),_:1},8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(n,{span:24},{default:a(()=>[e(o,{prop:"dissolve",label:s.$t("site.watermark.dissolve"),rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.watermark.dissolve",help:""})]),default:a(()=>[e(ae,{modelValue:t.value.dissolve,"onUpdate:modelValue":u[4]||(u[4]=l=>t.value.dissolve=l),min:0,max:100,"show-input":""},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"minWidth",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.watermark.minWidth",help:""})]),default:a(()=>[e(b,{modelValue:t.value.minWidth,"onUpdate:modelValue":u[5]||(u[5]=l=>t.value.minWidth=l),modelModifiers:{number:!0},min:1,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"minHeight",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.watermark.minHeight",help:""})]),default:a(()=>[e(b,{modelValue:t.value.minHeight,"onUpdate:modelValue":u[6]||(u[6]=l=>t.value.minHeight=l),modelModifiers:{number:!0},min:1,max:65535},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})):d.value==="editor"&&k(U).epRank<2?(r(),f(te,{key:1,type:"warning",closable:!1,"show-icon":!0},{title:a(()=>[B("span",{innerHTML:s.$t("error.enterprise")},null,8,el)]),_:1})):d.value==="editor"&&k(U).epRank>=2?(r(),m(p,{key:2},[e(ue,null,{default:a(()=>[T(F(s.$t("site.editor.typesetting")),1)]),_:1}),e($,null,{default:a(()=>[e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.fontFamily"},{label:a(()=>[e(i,{message:"site.editor.typesetting.fontFamily"})]),default:a(()=>[e(V,{modelValue:t.value.typesetting.fontFamily,"onUpdate:modelValue":u[7]||(u[7]=l=>t.value.typesetting.fontFamily=l)},{default:a(()=>[(r(),m(p,null,v([{value:"",label:"默认"},{value:"SimSun",label:"宋体"},{value:"Microsoft YaHei",label:"微软雅黑"},{value:"SimKai,KaiTi",label:"楷体"},{value:"SimHei",label:"黑体"},{value:"SimLi,LiSu",label:"隶书"},{value:"andale mono,times",label:"Andale Mono"},{value:"arial,helvetica,sans-serif",label:"Arial"},{value:"arial black,avant garde",label:"Arial Black"},{value:"comic sans ms,sans-serif",label:"Comic Sans MS"},{value:"helvetica",label:"Helvetica"},{value:"impact,chicago",label:"Impact"},{value:"times new roman,times",label:"Times New Roman"}],l=>e(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.fontSize"},{label:a(()=>[e(i,{message:"site.editor.typesetting.fontSize"})]),default:a(()=>[e(V,{modelValue:t.value.typesetting.fontSize,"onUpdate:modelValue":u[8]||(u[8]=l=>t.value.typesetting.fontSize=l)},{default:a(()=>[(r(),m(p,null,v([{value:"",label:"默认"},{value:"12px",label:"小五"},{value:"14px",label:"五号"},{value:"16px",label:"小四"},{value:"18px",label:"四号"},{value:"20px",label:"小三"},{value:"22px",label:"三号"},{value:"24px",label:"小二"},{value:"28px",label:"二号"}],l=>e(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.lineHeight"},{label:a(()=>[e(i,{message:"site.editor.typesetting.lineHeight"})]),default:a(()=>[e(V,{modelValue:t.value.typesetting.lineHeight,"onUpdate:modelValue":u[9]||(u[9]=l=>t.value.typesetting.lineHeight=l)},{default:a(()=>[(r(),m(p,null,v([{value:"",label:"默认"},{value:"1.0",label:"1.0"},{value:"1.1",label:"1.1"},{value:"1.2",label:"1.2"},{value:"1.3",label:"1.3"},{value:"1.4",label:"1.4"},{value:"1.5",label:"1.5"},{value:"2.0",label:"2.0"}],l=>e(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.emptyLine"},{label:a(()=>[e(i,{message:"site.editor.typesetting.emptyLine"})]),default:a(()=>[e(V,{modelValue:t.value.typesetting.emptyLine,"onUpdate:modelValue":u[10]||(u[10]=l=>t.value.typesetting.emptyLine=l)},{default:a(()=>[(r(),m(p,null,v([{value:"remain",label:"保留空行"},{value:"one",label:"合并为一行"},{value:"remove",label:"删除空行"}],l=>e(y,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.textIndent"},{label:a(()=>[e(i,{message:"site.editor.typesetting.textIndent"})]),default:a(()=>[e(S,{modelValue:t.value.typesetting.textIndent,"onUpdate:modelValue":u[11]||(u[11]=l=>t.value.typesetting.textIndent=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.imageCenterAlign"},{label:a(()=>[e(i,{message:"site.editor.typesetting.imageCenterAlign"})]),default:a(()=>[e(S,{modelValue:t.value.typesetting.imageCenterAlign,"onUpdate:modelValue":u[12]||(u[12]=l=>t.value.typesetting.imageCenterAlign=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.tableFullWidth"},{label:a(()=>[e(i,{message:"site.editor.typesetting.tableFullWidth"})]),default:a(()=>[e(S,{modelValue:t.value.typesetting.tableFullWidth,"onUpdate:modelValue":u[13]||(u[13]=l=>t.value.typesetting.tableFullWidth=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"typesetting.halfWidthCharConversion"},{label:a(()=>[e(i,{message:"site.editor.typesetting.halfWidthCharConversion"})]),default:a(()=>[e(S,{modelValue:t.value.typesetting.halfWidthCharConversion,"onUpdate:modelValue":u[14]||(u[14]=l=>t.value.typesetting.halfWidthCharConversion=l)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):d.value==="messageBoard"?(r(),f($,{key:3},{default:a(()=>[e(n,{span:12},{default:a(()=>[e(o,{prop:"enabled",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.messageBoard.enabled"})]),default:a(()=>[e(S,{modelValue:t.value.enabled,"onUpdate:modelValue":u[15]||(u[15]=l=>t.value.enabled=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"loginRequired",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.messageBoard.loginRequired"})]),default:a(()=>[e(S,{modelValue:t.value.loginRequired,"onUpdate:modelValue":u[16]||(u[16]=l=>t.value.loginRequired=l)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1})):d.value==="customs"?(r(),f($,{key:4},{default:a(()=>[(r(!0),m(p,null,v(G.value,l=>(r(),f(n,{key:l.code,span:l.double?12:24},{default:a(()=>[e(o,{prop:l.code,rules:l.required?{required:!0,message:()=>s.$t("v.required")}:void 0},{label:a(()=>[e(i,{label:l.name},null,8,["label"])]),default:a(()=>[e(Ke,{modelValue:t.value[l.code],"onUpdate:modelValue":I=>t.value[l.code]=I,"model-key":t.value[l.code+"Key"],"onUpdate:modelKey":I=>t.value[l.code+"Key"]=I,field:l},null,8,["modelValue","onUpdate:modelValue","model-key","onUpdate:modelKey","field"])]),_:2},1032,["prop","rules"])]),_:2},1032,["span"]))),128))]),_:1})):(r(),f($,{key:5},{default:a(()=>[e(n,{span:12},{default:a(()=>[e(o,{prop:"name",label:s.$t("site.name"),rules:{required:!0,message:()=>s.$t("v.required")}},{default:a(()=>[e(b,{ref:"focus",modelValue:t.value.name,"onUpdate:modelValue":u[17]||(u[17]=l=>t.value.name=l),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["label","rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"protocol",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.protocol",help:""})]),default:a(()=>[e(V,{modelValue:t.value.protocol,"onUpdate:modelValue":u[18]||(u[18]=l=>t.value.protocol=l),class:"w-full"},{default:a(()=>[(r(),m(p,null,v(["http","https"],l=>e(y,{key:l,label:l,value:l},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"domain",rules:[{required:!0,message:()=>s.$t("v.required")},{pattern:/^[a-z0-9-.]*$/,message:()=>s.$t("site.error.domainPattern")},{pattern:/^(?!(uploads|templates|WEB-INF|cp)$).*/i,message:()=>s.$t("site.error.excludesPattern")}]},{label:a(()=>[e(i,{message:"site.domain",help:""})]),default:a(()=>[e(b,{modelValue:t.value.domain,"onUpdate:modelValue":u[19]||(u[19]=l=>t.value.domain=l),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"subDir",rules:[{pattern:/^[\w-]*$/,message:()=>s.$t("site.error.subDirPattern")},{pattern:/^(?!(uploads|templates|WEB-INF|cp)$).*/i,message:()=>s.$t("site.error.excludesPattern")}]},{label:a(()=>[e(i,{message:"site.subDir",help:""})]),default:a(()=>[e(b,{modelValue:t.value.subDir,"onUpdate:modelValue":u[20]||(u[20]=l=>t.value.subDir=l),maxlength:"50"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"theme",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.theme",help:""})]),default:a(()=>[e(V,{modelValue:t.value.theme,"onUpdate:modelValue":u[21]||(u[21]=l=>t.value.theme=l),class:"w-full"},{default:a(()=>[(r(!0),m(p,null,v(C.value,l=>(r(),f(y,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"mobileTheme",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.mobileTheme",help:""})]),default:a(()=>[e(V,{modelValue:t.value.mobileTheme,"onUpdate:modelValue":u[22]||(u[22]=l=>t.value.mobileTheme=l),class:"w-full"},{default:a(()=>[(r(!0),m(p,null,v(C.value,l=>(r(),f(y,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"modelId",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.model",help:""})]),default:a(()=>[e(V,{modelValue:t.value.modelId,"onUpdate:modelValue":u[23]||(u[23]=l=>t.value.modelId=l),class:"w-full"},{default:a(()=>[(r(!0),m(p,null,v(L.value,l=>(r(),f(y,{key:l.id,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:24},{default:a(()=>[e(o,{prop:"logo"},{label:a(()=>[e(i,{message:"site.logo",help:""})]),default:a(()=>[e(k(A),{modelValue:t.value.logo,"onUpdate:modelValue":u[24]||(u[24]=l=>t.value.logo=l)},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"seoTitle"},{label:a(()=>[e(i,{message:"site.seoTitle",help:""})]),default:a(()=>[e(b,{modelValue:t.value.seoTitle,"onUpdate:modelValue":u[25]||(u[25]=l=>t.value.seoTitle=l),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"seoKeywords"},{label:a(()=>[e(i,{message:"site.seoKeywords",help:""})]),default:a(()=>[e(b,{modelValue:t.value.seoKeywords,"onUpdate:modelValue":u[26]||(u[26]=l=>t.value.seoKeywords=l),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:24},{default:a(()=>[e(o,{prop:"seoDescription"},{label:a(()=>[e(i,{message:"site.seoDescription",help:""})]),default:a(()=>[e(b,{modelValue:t.value.seoDescription,"onUpdate:modelValue":u[27]||(u[27]=l=>t.value.seoDescription=l),type:"textarea",rows:3,maxlength:"1000"},null,8,["modelValue"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"pageSize",rules:{required:!0,message:()=>s.$t("v.required")}},{label:a(()=>[e(i,{message:"site.pageSize",help:""})]),default:a(()=>[e(se,{modelValue:t.value.pageSize,"onUpdate:modelValue":u[28]||(u[28]=l=>t.value.pageSize=l),min:1,max:200},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{prop:"status"},{label:a(()=>[e(i,{message:"site.status",help:""})]),default:a(()=>[e(R,{modelValue:t.value.status,"onUpdate:modelValue":u[29]||(u[29]=l=>t.value.status=l)},{default:a(()=>[(r(),m(p,null,v([0,1],l=>e(D,{key:l,value:l},{default:a(()=>[T(F(s.$t("site.status.".concat(l))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})),d.value!=="editor"||k(U).epRank>=1?(r(),m("div",ll,[e(oe,{disabled:k(Ce)("siteSettings:".concat(d.value,":update")),loading:E.value,type:"primary","native-type":"submit",onClick:Ue(Q,["prevent"])},{default:a(()=>[T(F(s.$t("save")),1)]),_:1},8,["disabled","loading"])])):Le("",!0)]),_:1},8,["model"])),[[de,q.value]])]),_:1})]),_:1})}}}),hl=Be(al,[["__scopeId","data-v-f4b31cf8"]]);export{hl as default};
