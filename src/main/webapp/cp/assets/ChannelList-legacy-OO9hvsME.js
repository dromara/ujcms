System.register(["./index-legacy-Dn378GZk.js","./el-main-legacy-DCNSY1wY.js","./el-popover-legacy-DS1ey-DB.js","./el-tree-legacy-DXZLVg4P.js","./el-switch-legacy-CJu_GaeZ.js","./sortable.esm-legacy-xUcotENm.js","./tree-legacy-D1Cv8xKE.js","./content-legacy-mGlTTE-V.js","./system-legacy-BlGzEuB8.js","./QueryItem.vue_vue_type_script_setup_true_lang-legacy-X61T56A1.js","./el-select-legacy-BR_8Webd.js","./el-tree-select-legacy-DtvNVgrC.js","./el-radio-group-legacy-Bo0xKR1q.js","./el-radio-legacy-DPwh4a3j.js","./config-legacy-DvEG9oKg.js","./data-legacy-Ddf9C88u.js","./FieldItem.vue_vue_type_script_setup_true_lang-legacy-FLpBpGbO.js","./DialogForm.vue_vue_type_script_setup_true_lang-legacy-CIId0m1t.js","./Tinymce-legacy-c_Ar6L-9.js","./TuiEditor-legacy-DzfoQ5uc.js","./FileListUpload.vue_vue_type_style_index_0_scoped_b3a09e2e_lang-legacy-rgJAACf3.js","./BaseUpload.vue_vue_type_style_index_0_scoped_248c0508_lang-legacy-CKxOBGSm.js","./vuedraggable.umd-legacy-ISFTCR-2.js","./el-checkbox-group-legacy-CFEJ959H.js","./el-radio-button-legacy-C-wGwFOO.js","./BaseUpload-legacy-BZSNhk5x.js","./position-legacy-qRsP4k9q.js","./index-legacy-CDx1Huws.js"],(function(e,l){"use strict";var a,n,u,t,d,o,s,r,i,c,v,m,p,h,b,y,f,g,_,V,k,w,$,C,q,T,x,U,M,K,S,I,j,D,E,P,z,F,R,B,Q,O,L,N,H,J,W,Z,A,G,X,Y,ee,le,ae,ne,ue,te,de,oe,se,re,ie,ce,ve,me,pe,he,be,ye,fe,ge,_e,Ve,ke,we,$e,Ce,qe,Te,xe,Ue,Me,Ke,Se,Ie,je,De,Ee,Pe,ze,Fe,Re,Be,Qe,Oe,Le,Ne,He,Je,We,Ze,Ae,Ge,Xe,Ye;return{setters:[e=>{a=e.d,n=e.A,u=e.r,t=e.ar,d=e.$,o=e.B,s=e.b,r=e.c,i=e.w,c=e.h,v=e.a6,m=e.a2,p=e.i,h=e.j,b=e.k,y=e.b3,f=e.b6,g=e.v,_=e.x,V=e.g,k=e.P,w=e.aF,$=e.aG,C=e.l,q=e.b8,T=e.b9,x=e.aM,U=e.u,M=e.e,K=e.y,S=e.f,I=e.m,j=e.t,D=e.z,E=e.aR,P=e.o,z=e.bt,F=e.bi,R=e.aw,B=e.aD,Q=e.bu,O=e.aH,L=e.bv,N=e.Z,H=e.aW,J=e.b5,W=e.aZ,Z=e.bw,A=e.bx,G=e.by,X=e.a3,Y=e.bz,ee=e.aP,le=e.aQ,ae=e.a5,ne=e.ay,ue=e.bk,te=e.bs},e=>{de=e.E,oe=e.a,se=e.b},e=>{re=e.E},e=>{ie=e.E},e=>{ce=e.E},e=>{ve=e.S},e=>{me=e.c,pe=e.d,he=e.t,be=e.f},e=>{ye=e.H,fe=e.I,ge=e.e,_e=e.J,Ve=e.d,ke=e.K,we=e.L,$e=e.M,Ce=e.N,qe=e.O,Te=e.P,xe=e.Q,Ue=e.R,Me=e.S,Ke=e.T},e=>{Se=e.e,Ie=e.f},e=>{je=e._,De=e.a,Ee=e.b,Pe=e.c},e=>{ze=e.E,Fe=e.a,Re=e.c},e=>{Be=e.E},e=>{Qe=e.E,Oe=e.a},null,e=>{Le=e.q,Ne=e.b},e=>{He=e.a,Je=e.m,We=e.g},e=>{Ze=e._},e=>{Ae=e._},e=>{Ge=e.T},e=>{Xe=e.T},e=>{Ye=e.a},null,null,null,null,null,null,null],execute:function(){var l=document.createElement("style");l.textContent=".sortable-chosen td{border-top-width:2px;--tw-border-opacity: 1;border-top-color:rgb(243 209 158 / var(--tw-border-opacity, 1))}\n/*$vite$:1*/",document.head.appendChild(l);const el={class:"w-full"},ll=a({name:"ChannelForm",__name:"ChannelForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0},parent:{type:Object,default:null}},emits:{"update:modelValue":null,finished:null},setup(e,{emit:l}){const a=e,x=l,{modelValue:U,parent:M}=n(a),K=u(),S=u({}),I=u([]),j=u([]),D=u([]),E=u([]),P=u([]),z=u([]),F=u([]),R=u([]),B=u(),Q=t((()=>E.value.find((e=>e.id===B.value)))),O=t((()=>He(Je(We().channel.mains,Q.value?.mains,"channel")))),L=t((()=>He(Je(We().channel.asides,Q.value?.asides,"channel")))),N=t((()=>JSON.parse(Q.value?.customs||"[]"))),H=t((()=>{const e=me(D.value,S.value.id);return d.allChannelPermission?e:pe(e,z.value)})),J=async()=>{D.value=he(await Ve())},W=async()=>{await J(),x("finished")};o(U,(()=>{U.value&&(B.value=M.value?.articleModelId??E.value[0]?.id,(async()=>{z.value=await ye()})(),(async()=>{E.value=await Le({type:"channel"}),null==B.value&&E.value.length>0&&(B.value=E.value[0].id)})(),(async()=>{P.value=await Le({type:"article"})})(),(async()=>{F.value=await fe()})(),(async()=>{R.value=await ge()})(),(async()=>{d.epRank>0&&(I.value=await Se({category:"sys_article",deployed:!0}))})(),(async()=>{d.epRank>=3&&(j.value=await Ne())})())})),o(N,(()=>{Z(S.value.customs)}));const Z=e=>(N.value.forEach((l=>{null==e[l.code]&&(e[l.code]=l.defaultValue,null!=l.defaultValueKey&&(e[l.code+"Key"]=l.defaultValueKey))})),e);return(l,a)=>{const n=h,u=p,t=m,o=f,x=Fe,U=ze,D=ce,Q=Oe,Z=Qe,A=v,G=Be,X=Re,Y=T,ee=q;return s(),r(Ae,{values:S.value,"onUpdate:values":a[29]||(a[29]=e=>S.value=e),name:l.$t("menu.content.channel"),"query-bean":b(Ce),"create-bean":b($e),"update-bean":b(we),"delete-bean":b(ke),"bean-id":e.beanId,"bean-ids":e.beanIds,focus:K.value,"init-values":(e,l)=>({parentId:l?e?.parentId:b(M)?.id??e?.parentId,type:1,channelModelId:e?.channelModelId??b(M)?.channelModelId??E.value[0]?.id,articleModelId:e?.articleModelId??b(M)?.articleModelId??P.value[0]?.id,nav:e?.nav??b(M)?.nav??!0,book:!1,real:e?.real??b(M)?.real??!0,channelTemplate:e?.channelTemplate??b(M)?.channelTemplate??F.value[0],articleTemplate:e?.articleTemplate??b(M)?.articleTemplate??R.value[0],pageSize:10,allowComment:e?.allowComment??b(M)?.allowComment??!0,allowContribute:e?.allowContribute??b(M)?.allowContribute??!0,allowSearch:e?.allowSearch??b(M)?.allowSearch??!0,orderDesc:e?.orderDesc??b(M)?.orderDesc??!0,customs:{}}),"to-values":e=>({...e}),perms:"channel","model-value":e.modelValue,"disable-edit":e=>!b(d).allChannelPermission&&null!=e.id&&!z.value.includes(e.id),"label-width":"120px",large:"","onUpdate:modelValue":a[30]||(a[30]=e=>l.$emit("update:modelValue",e)),onFinished:W,onBeanChange:a[31]||(a[31]=async e=>{B.value=e?.channelModelId??b(M)?.channelModelId??P.value[0]?.id,await J()})},{default:i((({bean:e,isEdit:v})=>[c(A,null,{default:i((()=>[c(t,{span:18},{default:i((()=>[c(A,null,{default:i((()=>[c(t,{span:O.value.name.double?12:24},{default:i((()=>[c(u,{prop:"name",label:O.value.name.name??l.$t("channel.name"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:i((()=>[c(n,{ref_key:"focus",ref:K,modelValue:S.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>S.value.name=e),maxlength:"50"},null,8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"]),c(t,{span:O.value.alias.double?12:24},{default:i((()=>[c(u,{prop:"alias",rules:[{required:!0,message:()=>l.$t("v.required")},{pattern:/^[\w-]*$/,message:()=>l.$t("channel.error.aliasPattern")},{asyncValidator:async(a,n,u)=>{n!==e.alias&&await b(_e)(n)?u(l.$t("channel.error.aliasExist")):u()}}]},{label:i((()=>[c(y,{label:O.value.alias.name??l.$t("channel.alias"),message:"channel.alias",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.alias,"onUpdate:modelValue":a[1]||(a[1]=e=>S.value.alias=e),maxlength:"50"},null,8,["modelValue"])])),_:2},1032,["rules"])])),_:2},1032,["span"]),3===S.value.type?(s(),r(t,{key:0,span:O.value.linkUrl.double?12:24},{default:i((()=>[c(u,{prop:"linkUrl",rules:[{required:!0,message:()=>l.$t("v.required")},{pattern:/^(http|\/).*$/,message:()=>l.$t("channel.error.linkUrl")}]},{label:i((()=>[c(y,{label:O.value.linkUrl.name??l.$t("channel.linkUrl"),message:"channel.linkUrl",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.linkUrl,"onUpdate:modelValue":a[3]||(a[3]=e=>S.value.linkUrl=e),maxlength:"255"},{append:i((()=>[c(o,{modelValue:S.value.targetBlank,"onUpdate:modelValue":a[2]||(a[2]=e=>S.value.targetBlank=e)},{default:i((()=>[g(_(l.$t("channel.targetBlank")),1)])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),S.value.type<3?(s(),k(w,{key:1},[O.value.seoTitle.show?(s(),r(t,{key:0,span:O.value.seoTitle.double?12:24},{default:i((()=>[c(u,{prop:"seoTitle",rules:O.value.seoTitle.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.seoTitle.name??l.$t("channel.seoTitle"),message:"channel.seoTitle",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.seoTitle,"onUpdate:modelValue":a[4]||(a[4]=e=>S.value.seoTitle=e),maxlength:"150"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),O.value.seoKeywords.show?(s(),r(t,{key:1,span:O.value.seoKeywords.double?12:24},{default:i((()=>[c(u,{prop:"seoKeywords",rules:O.value.seoKeywords.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.seoKeywords.name??l.$t("channel.seoKeywords"),message:"channel.seoKeywords",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.seoKeywords,"onUpdate:modelValue":a[5]||(a[5]=e=>S.value.seoKeywords=e),maxlength:"150"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),O.value.seoDescription.show?(s(),r(t,{key:2,span:O.value.seoDescription.double?12:24},{default:i((()=>[c(u,{prop:"seoDescription",rules:O.value.seoDescription.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.seoDescription.name??l.$t("channel.seoDescription"),message:"channel.seoDescription",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.seoDescription,"onUpdate:modelValue":a[6]||(a[6]=e=>S.value.seoDescription=e),maxlength:"1000"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0)],64)):V("",!0),O.value.image.show?(s(),r(t,{key:2,span:O.value.image.double?12:24},{default:i((()=>[c(u,{prop:"image",label:O.value.image.name??l.$t("channel.image"),rules:O.value.image.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:i((()=>[c(b(Ye),{modelValue:S.value.image,"onUpdate:modelValue":a[7]||(a[7]=e=>S.value.image=e),height:O.value.image.imageHeight,width:O.value.image.imageWidth,mode:O.value.image.imageMode},null,8,["modelValue","height","width","mode"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0),O.value.channelModel.show?(s(),r(t,{key:3,span:O.value.channelModel.double?12:24},{default:i((()=>[c(u,{prop:"channelModelId",label:O.value.channelModel.name??l.$t("channel.channelModel"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:i((()=>[c(U,{modelValue:S.value.channelModelId,"onUpdate:modelValue":a[8]||(a[8]=e=>S.value.channelModelId=e),class:"w-full",onChange:a[9]||(a[9]=e=>{B.value=e})},{default:i((()=>[(s(!0),k(w,null,$(E.value,(e=>(s(),r(x,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0),O.value.articleModel.show?(s(),r(t,{key:4,span:O.value.articleModel.double?12:24},{default:i((()=>[c(u,{prop:"articleModelId",label:O.value.articleModel.name??l.$t("channel.articleModel"),rules:{required:!0,message:()=>l.$t("v.required")}},{default:i((()=>[c(U,{modelValue:S.value.articleModelId,"onUpdate:modelValue":a[10]||(a[10]=e=>S.value.articleModelId=e),class:"w-full"},{default:i((()=>[(s(!0),k(w,null,$(P.value,(e=>(s(),r(x,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0),O.value.channelTemplate.show?(s(),r(t,{key:5,span:O.value.channelTemplate.double?12:24},{default:i((()=>[c(u,{prop:"channelTemplate",label:O.value.channelTemplate.name??l.$t("channel.channelTemplate"),rules:O.value.channelTemplate.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:i((()=>[c(U,{modelValue:S.value.channelTemplate,"onUpdate:modelValue":a[11]||(a[11]=e=>S.value.channelTemplate=e),class:"w-full"},{default:i((()=>[(s(!0),k(w,null,$(F.value,(e=>(s(),r(x,{key:e,label:e+".html",value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0),O.value.articleTemplate.show?(s(),r(t,{key:6,span:O.value.articleTemplate.double?12:24},{default:i((()=>[c(u,{prop:"articleTemplate",label:O.value.articleTemplate.name??l.$t("channel.articleTemplate"),rules:O.value.articleTemplate.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:i((()=>[c(U,{modelValue:S.value.articleTemplate,"onUpdate:modelValue":a[12]||(a[12]=e=>S.value.articleTemplate=e),class:"w-full"},{default:i((()=>[(s(!0),k(w,null,$(R.value,(e=>(s(),r(x,{key:e,label:e+".html",value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0),O.value.nav.show?(s(),r(t,{key:7,span:O.value.nav.double?12:24},{default:i((()=>[c(u,{prop:"nav",rules:O.value.nav.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.nav.name??l.$t("channel.nav"),message:"channel.nav",help:""},null,8,["label"])])),default:i((()=>[c(D,{modelValue:S.value.nav,"onUpdate:modelValue":a[13]||(a[13]=e=>S.value.nav=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),O.value.real.show?(s(),r(t,{key:8,span:O.value.real.double?12:24},{default:i((()=>[c(u,{prop:"real",rules:O.value.real.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.real.name??l.$t("channel.real"),message:"channel.real",help:""},null,8,["label"])])),default:i((()=>[c(D,{modelValue:S.value.real,"onUpdate:modelValue":a[14]||(a[14]=e=>S.value.real=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),O.value.allowSearch.show?(s(),r(t,{key:9,span:O.value.allowSearch.double?12:24},{default:i((()=>[c(u,{prop:"allowSearch",rules:O.value.allowSearch.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.allowSearch.name??l.$t("channel.allowSearch"),message:"channel.allowSearch",help:""},null,8,["label"])])),default:i((()=>[c(D,{modelValue:S.value.allowSearch,"onUpdate:modelValue":a[15]||(a[15]=e=>S.value.allowSearch=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),O.value.book.show?(s(),r(t,{key:10,span:O.value.book.double?12:24},{default:i((()=>[c(u,{prop:"book",rules:O.value.book.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:O.value.book.name??l.$t("channel.book"),message:"channel.book",help:""},null,8,["label"])])),default:i((()=>[c(D,{modelValue:S.value.book,"onUpdate:modelValue":a[16]||(a[16]=e=>S.value.book=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1},8,["span"])):V("",!0),(s(!0),k(w,null,$(N.value,(e=>(s(),r(t,{key:e.code,span:e.double?12:24},{default:i((()=>[c(u,{prop:`customs.${e.code}`,rules:e.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{label:i((()=>[c(y,{label:e.name},null,8,["label"])])),default:i((()=>[c(Ze,{modelValue:S.value.customs[e.code],"onUpdate:modelValue":l=>S.value.customs[e.code]=l,"model-key":S.value.customs[e.code+"Key"],"onUpdate:modelKey":l=>S.value.customs[e.code+"Key"]=l,field:e},null,8,["modelValue","onUpdate:modelValue","model-key","onUpdate:modelKey","field"])])),_:2},1032,["prop","rules"])])),_:2},1032,["span"])))),128)),2===S.value.type?(s(),r(t,{key:11,span:O.value.text.double?12:24},{default:i((()=>[c(u,{prop:"text",label:O.value.text.name??l.$t("channel.text"),rules:O.value.text.required?{required:!0,message:()=>l.$t("v.required")}:void 0},{default:i((()=>[C("div",el,[O.value.text.editorSwitch?(s(),r(Z,{key:0,modelValue:S.value.editorType,"onUpdate:modelValue":a[17]||(a[17]=e=>S.value.editorType=e),class:"mr-6",onChange:a[18]||(a[18]=()=>S.value.markdown="")},{default:i((()=>[(s(),k(w,null,$([1,2],(e=>c(Q,{key:e,value:e},{default:i((()=>[g(_(l.$t(`model.field.editorType.${e}`)),1)])),_:2},1032,["value"]))),64))])),_:1},8,["modelValue"])):V("",!0),2===S.value.editorType?(s(),r(b(Xe),{key:1,modelValue:S.value.markdown,"onUpdate:modelValue":a[19]||(a[19]=e=>S.value.markdown=e),html:S.value.text,"onUpdate:html":a[20]||(a[20]=e=>S.value.text=e),class:"leading-6"},null,8,["modelValue","html"])):(s(),r(b(Ge),{key:2,ref:"tinyText",modelValue:S.value.text,"onUpdate:modelValue":a[21]||(a[21]=e=>S.value.text=e)},null,8,["modelValue"]))])])),_:1},8,["label","rules"])])),_:1},8,["span"])):V("",!0)])),_:2},1024)])),_:2},1024),c(t,{span:6},{default:i((()=>[c(ee,{type:"border-card",class:"ml-5"},{default:i((()=>[c(Y,{label:l.$t("channel.tabs.setting")},{default:i((()=>[c(u,{prop:"parentId",label:L.value.parent.name??l.$t("channel.parent"),"label-position":"top"},{default:i((()=>[c(G,{modelValue:S.value.parentId,"onUpdate:modelValue":a[22]||(a[22]=e=>S.value.parentId=e),data:H.value,"node-key":"id",props:{label:"name",disabled:"disabled"},"render-after-expand":!1,disabled:v,placeholder:"","check-strictly":"",clearable:"",class:"w-full"},null,8,["modelValue","data","disabled"])])),_:2},1032,["label"]),c(u,{prop:"type",label:L.value.type.name??l.$t("channel.type"),rules:{required:!0,message:()=>l.$t("v.required")},"label-position":"top"},{default:i((()=>[c(U,{modelValue:S.value.type,"onUpdate:modelValue":a[23]||(a[23]=e=>S.value.type=e),class:"w-full"},{default:i((()=>[(s(),k(w,null,$([1,2,3,4],(e=>c(x,{key:e,label:l.$t(`channel.type.${e}`),value:e},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"]),c(u,{prop:"processKey",label:L.value.processKey.name??l.$t("channel.processKey"),rules:L.value.processKey.required?{required:!0,message:()=>l.$t("v.required")}:void 0,"label-position":"top"},{default:i((()=>[c(U,{modelValue:S.value.processKey,"onUpdate:modelValue":a[24]||(a[24]=e=>S.value.processKey=e),clearable:"",class:"w-full"},{default:i((()=>[(s(!0),k(w,null,$(I.value,(e=>(s(),r(x,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"]),b(d).epRank>=3&&L.value.performanceType.show?(s(),r(u,{key:0,prop:"performanceType",label:L.value.performanceType.name??l.$t("channel.performanceType"),rules:L.value.performanceType.required?{required:!0,message:()=>l.$t("v.required")}:void 0,"label-position":"top"},{default:i((()=>[c(U,{modelValue:S.value.performanceTypeId,"onUpdate:modelValue":a[25]||(a[25]=e=>S.value.performanceTypeId=e),clearable:"",class:"w-full"},{default:i((()=>[(s(!0),k(w,null,$(j.value,(e=>(s(),r(x,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label","rules"])):V("",!0),L.value.channelStaticPath.show?(s(),r(u,{key:1,prop:"channelStaticPath",label:L.value.channelStaticPath.name??l.$t("channel.channelStaticPath"),rules:L.value.channelStaticPath.required?{required:!0,message:()=>l.$t("v.required")}:void 0,"label-position":"top"},{label:i((()=>[c(y,{label:L.value.channelStaticPath.name??l.$t("channel.channelStaticPath"),message:"channel.channelStaticPath",help:""},null,8,["label"])])),default:i((()=>[c(n,{modelValue:S.value.channelStaticPath,"onUpdate:modelValue":a[26]||(a[26]=e=>S.value.channelStaticPath=e),maxlength:"100"},{append:i((()=>a[32]||(a[32]=[g(".html")]))),_:1},8,["modelValue"])])),_:1},8,["label","rules"])):V("",!0),c(u,{prop:"pageSize",label:L.value.pageSize.name??l.$t("channel.pageSize"),rules:{required:!0,message:()=>l.$t("v.required")},"label-position":"top"},{default:i((()=>[c(X,{modelValue:S.value.pageSize,"onUpdate:modelValue":a[27]||(a[27]=e=>S.value.pageSize=e),min:1,max:200},null,8,["modelValue"])])),_:1},8,["label","rules"]),c(u,{prop:"orderDesc",rules:{required:!0,message:()=>l.$t("v.required")},"label-position":"top"},{label:i((()=>[c(y,{label:L.value.orderDesc.name??l.$t("channel.orderDesc"),message:"channel.orderDesc",help:""},null,8,["label"])])),default:i((()=>[c(D,{modelValue:S.value.orderDesc,"onUpdate:modelValue":a[28]||(a[28]=e=>S.value.orderDesc=e)},null,8,["modelValue"])])),_:1},8,["rules"])])),_:2},1032,["label"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value","disable-edit"])}}}),al={class:"text-lg text-center"},nl={class:"flex items-center justify-center"},ul={class:"text-lg text-center"},tl={class:"mt-5"},dl=a({name:"ChannelMoveForm",__name:"ChannelMoveForm",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:E({"update:modelValue":null,finished:null},["update:modelValue"]),setup(e){const l=x(e,"modelValue"),{t:a}=U(),n=u(!1),t=u([]),d=u([]),p=u(),h=u(),b=u("inner"),y=u(),f=async()=>{n.value=!0;try{const e=await Ve(),l=[];e.forEach((e=>{l.push({...e})})),t.value=he(e),d.value=he(l)}finally{n.value=!1}};o(l,(async()=>{l.value&&f()}));const q=(e,l,a)=>{l=l||a.includes(e.id),e.disabled=l,e.children?.forEach((e=>{q(e,l,a)}))},T=()=>{y.value=void 0;const e=p.value.getCheckedKeys();e.includes(h.value.getCheckedKeys()[0])&&h.value.setCheckedKeys([]),d.value.forEach((l=>{q(l,!1,e)}))},E=(e,l)=>{y.value=void 0,l.checkedKeys.length>1&&h.value.setCheckedKeys([e.id])};return(e,u)=>{const o=ie,q=m,x=Fe,U=ze,P=v,z=S,F=I,R=D,B=K;return s(),r(R,{modelValue:l.value,"onUpdate:modelValue":u[2]||(u[2]=e=>l.value=e),title:e.$t("channel.op.batchMove"),width:"768",top:"5vh",onClose:u[3]||(u[3]=l=>e.$emit("finished"))},{default:i((()=>[c(P,{gutter:20},{default:i((()=>[c(q,{span:12},{default:i((()=>[C("div",al,_(e.$t("channel.batchMove.srcChannel")),1),M(c(o,{ref_key:"srcTree",ref:p,data:t.value,props:{label:"name"},"node-key":"id","show-checkbox":"","check-strictly":"",onCheck:T},null,8,["data"]),[[B,n.value]])])),_:1}),c(q,{span:12},{default:i((()=>[C("div",nl,[C("div",ul,_(e.$t("channel.batchMove.moveTo")),1),c(U,{modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=e=>b.value=e),class:"w-32 ml-2"},{default:i((()=>[(s(),k(w,null,$(["inner","before","after"],(l=>c(x,{key:l,label:e.$t(`channel.batchMove.moveTo.${l}`),value:l},null,8,["label","value"]))),64))])),_:1},8,["modelValue"])]),M(c(o,{ref_key:"targetTree",ref:h,data:d.value,props:{label:"name"},"node-key":"id","show-checkbox":"","check-strictly":"",onCheck:E},null,8,["data"]),[[B,n.value]])])),_:1})])),_:1}),C("div",tl,[y.value?(s(),r(z,{key:0,title:y.value,type:"error",closeable:!1,class:"mb-2"},null,8,["title"])):V("",!0),c(F,{type:"primary",onClick:u[1]||(u[1]=()=>(async()=>{const e=p.value.getCheckedKeys();if(e.length<=0)return void(y.value=a("channel.error.srcChannelRequired"));const l=h.value.getCheckedKeys()[0];null!=l?(await qe(e,l,b.value),f(),j.success(a("success"))):y.value=a("channel.error.moveToChannelRequired")})())},{default:i((()=>[g(_(e.$t("submit")),1)])),_:1})])])),_:1},8,["modelValue","title"])}}}),ol={class:"text-lg text-center"},sl={class:"flex items-center justify-center"},rl={class:"text-lg text-center"},il={class:"mt-5"},cl=a({name:"ChannelMergeForm",__name:"ChannelMergeForm",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:E({"update:modelValue":null,finished:null},["update:modelValue"]),setup(e){const l=x(e,"modelValue"),{t:a}=U(),n=u(!1),t=u([]),d=u([]),p=u(),h=u(),b=u(),y=async()=>{n.value=!0;try{const e=await Ve(),l=[];e.forEach((e=>{l.push({...e})})),t.value=he(e),d.value=he(l)}finally{n.value=!1}};o(l,(async()=>{l.value&&y()}));const f=(e,l,a)=>{l=l||a.includes(e.id),e.disabled=l,e.children?.forEach((e=>{f(e,l,a)}))},k=()=>{b.value=void 0;const e=p.value.getCheckedKeys();e.includes(h.value.getCheckedKeys()[0])&&h.value.setCheckedKeys([]),d.value.forEach((l=>{f(l,!1,e)}))},w=(e,l)=>{b.value=void 0,l.checkedKeys.length>1&&h.value.setCheckedKeys([e.id])};return(e,u)=>{const o=ie,f=m,$=v,q=S,T=I,x=D,U=K;return s(),r(x,{modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=e=>l.value=e),title:e.$t("channel.op.batchMerge"),width:"768",top:"5vh",onClose:u[2]||(u[2]=l=>e.$emit("finished"))},{default:i((()=>[c($,{gutter:20},{default:i((()=>[c(f,{span:12},{default:i((()=>[C("div",ol,_(e.$t("channel.batchMerge.srcChannel")),1),M(c(o,{ref_key:"srcTree",ref:p,data:t.value,props:{label:"name"},"node-key":"id","show-checkbox":"",onCheck:k},null,8,["data"]),[[U,n.value]])])),_:1}),c(f,{span:12},{default:i((()=>[C("div",sl,[C("div",rl,_(e.$t("channel.batchMerge.mergeTo")),1)]),M(c(o,{ref_key:"targetTree",ref:h,data:d.value,props:{label:"name"},"node-key":"id","show-checkbox":"","check-strictly":"",onCheck:w},null,8,["data"]),[[U,n.value]])])),_:1})])),_:1}),C("div",il,[b.value?(s(),r(q,{key:0,title:b.value,type:"error",closeable:!1,class:"mb-2"},null,8,["title"])):V("",!0),c(T,{type:"primary",onClick:u[0]||(u[0]=()=>(async()=>{const e=p.value.getCheckedKeys();if(e.length<=0)return void(b.value=a("channel.error.srcChannelRequired"));const l=h.value.getCheckedKeys()[0];null!=l?(await Te(e,l),y(),j.success(a("success"))):b.value=a("channel.error.moveToChannelRequired")})())},{default:i((()=>[g(_(e.$t("submit")),1)])),_:1})])])),_:1},8,["modelValue","title"])}}}),vl={class:"flex justify-between mx-2 mt-1"},ml={class:"mb-3"},pl={class:"mt-3 app-block"};e("default",a({name:"ChannelList",__name:"ChannelList",setup(e){const{t:l}=U(),a=u({}),n=u(),v=u(),m=u([]),p=u([]),y=u(!1),f=u(!1),V=u(),k=u(),w=t((()=>be(m.value).map((e=>e.id)))),$=u([]),q=u([]),T=u(!1),x=u(!1),S=u(),D=u([]),E=u(!1),me=u(),pe=u(),fe=u(!1),ge=u(!1),_e=e=>d.allChannelPermission||$.value.includes(e.id);o(me,(e=>{S.value.filter(e)}));const we=async()=>{E.value=!0;try{D.value=he(await Ve()),z((()=>{null!=me.value&&S.value.filter(me.value),S.value.setCurrentKey(pe.value?.id)}))}finally{E.value=!1}},$e=async()=>{y.value=!0;try{T.value=void 0!==n.value;const e=Object.values(a.value).filter((e=>void 0!==e&&""!==e)).length>0;m.value=await Ve({...F(a.value),parentId:pe.value?.id,isIncludeSelf:!0,isIncludeChildren:e,Q_OrderBy:n.value}),e||T.value||(m.value=he(m.value))}finally{y.value=!1}},Ce=()=>{we(),$e()},qe=async()=>{$.value=await ye()};let Te;P((()=>{Ce(),(async()=>{d.epRank>0&&(q.value=await Ie({category:"sys_article",latestVersion:!0}))})(),qe(),(()=>{const e=document.querySelector("#dataTable .el-table__body-wrapper tbody");Te=ve.create(e,{handle:".drag-handle",draggable:".drag-draggable",animation:200,chosenClass:"sortable-chosen",onEnd:async function(e){const{oldIndex:a,newIndex:n}=e;if(a!==n){let e=a,u=n,t=m.value;const d=t[0]?.children;d?.length>0&&(t=d,e-=1,u-=1),await xe(t[e].id,t[u].id,e>u?"before":"after"),we(),t.splice(u,0,t.splice(e,1)[0]),j.success(l("success"))}}})})()})),R((()=>{void 0!==Te&&Te.destroy()}));const Se=({column:e,prop:l,order:a})=>{n.value=l&&a?(e.sortBy??l)+("descending"===a?"_desc":""):void 0,Ce()},ze=()=>{Ce(),qe()},Fe=()=>$e(),Re=()=>{v.value.clearSort(),te(a.value),n.value=void 0,$e()},Be=e=>{k.value=void 0,V.value=e??pe.value,f.value=!0},Qe=e=>{N("channel:update")&&(k.value=e,V.value=null,f.value=!0)},Oe=async e=>{await ke(e),Ce(),j.success(l("success"))},Le=async(e,l,a)=>{"none"!==a&&(await xe(e.data.id,l.data.id,a),$e())},Ne=async e=>{x.value?(pe.value!=e.parent&&(pe.value=e.parent,await $e()),Qe(e.id)):(pe.value=e,Fe())},He=(e,l)=>!e||l.name.includes(e),Je=()=>{S.value.setCurrentKey(null),pe.value=void 0,Fe()};return(e,n)=>{const u=h,t=I,d=ce,o=O,$=ie,U=B,P=de,z=re,F=X,R=le,te=ae,ve=ee,he=oe,be=se,ye=K;return s(),r(be,null,{default:i((()=>[c(P,{width:"220px",class:"pr-3"},{default:i((()=>[c(U,{class:"p-2 bg-white rounded-sm"},{default:i((()=>[c(u,{modelValue:me.value,"onUpdate:modelValue":n[0]||(n[0]=e=>me.value=e),"suffix-icon":b(Q),size:"small"},null,8,["modelValue","suffix-icon"]),C("div",vl,[c(t,{type:null==pe.value?"primary":void 0,link:"",onClick:Je},{default:i((()=>[g(_(e.$t("channel.root")),1)])),_:1},8,["type"]),c(o,{content:e.$t("editMode"),placement:"top"},{default:i((()=>[c(d,{modelValue:x.value,"onUpdate:modelValue":n[1]||(n[1]=e=>x.value=e),"active-action-icon":b(L),"inactive-action-icon":b(L)},null,8,["modelValue","active-action-icon","inactive-action-icon"])])),_:1},8,["content"])]),M(c($,{ref_key:"channelTree",ref:S,data:D.value,props:{label:"name"},"expand-on-click-node":!1,"node-key":"id","highlight-current":"",draggable:b(N)("channel:update"),"filter-node-method":He,onNodeClick:Ne,onNodeDragEnd:Le},null,8,["data","draggable"]),[[ye,E.value]])])),_:1})])),_:1}),c(he,{class:"p-0"},{default:i((()=>[C("div",ml,[c(b(je),{params:a.value,onSearch:Fe,onReset:Re},{default:i((()=>[c(b(De),{label:e.$t("channel.name"),name:"Q_Contains_name"},null,8,["label"]),c(b(De),{label:e.$t("channel.alias"),name:"Q_Contains_alias"},null,8,["label"])])),_:1},8,["params"])]),C("div",null,[c(t,{type:"primary",disabled:b(J)("channel:create"),icon:b(H),onClick:n[2]||(n[2]=()=>Be(void 0))},{default:i((()=>[g(_(e.$t("add")),1)])),_:1},8,["disabled","icon"]),c(z,{title:e.$t("confirmDelete"),onConfirm:n[3]||(n[3]=()=>Oe(p.value.map((e=>e.id))))},{reference:i((()=>[c(t,{disabled:p.value.length<=0||b(J)("channel:delete"),icon:b(W)},{default:i((()=>[g(_(e.$t("delete")),1)])),_:1},8,["disabled","icon"])])),_:1},8,["title"]),c(t,{disabled:b(J)("channel:update"),icon:b(Z),onClick:n[4]||(n[4]=()=>fe.value=!0)},{default:i((()=>[g(_(e.$t("channel.op.batchMove")),1)])),_:1},8,["disabled","icon"]),c(t,{disabled:b(J)("channel:update"),icon:b(A),onClick:n[5]||(n[5]=()=>ge.value=!0)},{default:i((()=>[g(_(e.$t("channel.op.batchMerge")),1)])),_:1},8,["disabled","icon"]),c(t,{disabled:b(J)("channel:tidyTree"),icon:b(G),onClick:n[6]||(n[6]=()=>(async()=>{await Ue(),Ce(),j.success(l("success"))})())},{default:i((()=>[g(_(e.$t("tidyTree")),1)])),_:1},8,["disabled","icon"]),c(o,{placement:"top",content:e.$t("tidyTree.tooltip")},{default:i((()=>[c(F,{class:"ml-1 text-base align-text-bottom"},{default:i((()=>[c(b(Y))])),_:1})])),_:1},8,["content"]),c(b(Ee),{name:"channel",class:"ml-2"})]),C("div",pl,[M((s(),r(ve,{id:"dataTable",ref_key:"table",ref:v,"row-key":"id","default-expand-all":"",data:m.value,"row-class-name":({row:e})=>e.children?.length>0?void 0:"drag-draggable",onSelectionChange:n[7]||(n[7]=e=>p.value=e),onRowDblclick:n[8]||(n[8]=e=>Qe(e.id)),onSortChange:Se},{default:i((()=>[c(b(Pe),{name:"channel"},{default:i((()=>[c(R,{type:"selection",selectable:_e,width:"45"}),c(R,{property:"name",label:e.$t("channel.name"),"min-width":"80",sortable:"custom"},{default:i((({row:e})=>[c(te,{href:e.url,target:"_blank",type:"primary"},{default:i((()=>[g(_(e.name),1)])),_:2},1032,["href"])])),_:1},8,["label"]),c(R,{property:"alias",label:e.$t("channel.alias"),"min-width":"80",sortable:"custom"},null,8,["label"]),c(R,{property:"channelModel.name",label:e.$t("channel.channelModel"),"sort-by":"channelModel@model-name",display:"none",sortable:"custom","min-width":"60"},null,8,["label"]),c(R,{property:"articleModel.name",label:e.$t("channel.articleModel"),"sort-by":"articleModel@model-name",sortable:"custom","min-width":"60"},null,8,["label"]),c(R,{property:"processKey",label:e.$t("channel.processKey"),"min-width":"60",sortable:"custom","show-overflow-tooltip":""},{default:i((({row:e})=>[g(_(null!=e.processKey?q.value.find((l=>l.key===e.processKey))?.name:void 0),1)])),_:1},8,["label"]),c(R,{property:"nav",label:e.$t("channel.nav"),"min-width":"50"},{default:i((({row:e})=>[c(d,{modelValue:e.nav,"onUpdate:modelValue":l=>e.nav=l,size:"small",disabled:b(J)("channel:update"),onClick:()=>{return a=e.id,n=e.nav,void(N("channel:update")&&(Me(a,n),j.success(l("success"))));var a,n}},null,8,["modelValue","onUpdate:modelValue","disabled","onClick"])])),_:1},8,["label"]),c(R,{property:"real",label:e.$t("channel.real"),"min-width":"50"},{default:i((({row:e})=>[c(d,{modelValue:e.real,"onUpdate:modelValue":l=>e.real=l,size:"small",disabled:b(J)("channel:update"),onClick:()=>{return a=e.id,n=e.real,void(N("channel:update")&&(Ke(a,n),j.success(l("success"))));var a,n}},null,8,["modelValue","onUpdate:modelValue","disabled","onClick"])])),_:1},8,["label"]),c(R,{property:"id",label:"ID",width:"170",sortable:"custom"}),c(R,{width:"42"},{default:i((({row:e})=>[c(F,{class:ne(["text-lg align-middle",T.value||b(J)("channel:update")||e.children?.length>0?["cursor-not-allowed","text-gray-disabled"]:["cursor-move","text-gray-secondary","drag-handle"]])},{default:i((()=>[c(b(ue))])),_:2},1032,["class"])])),_:1}),c(R,{label:e.$t("table.action")},{default:i((({row:l})=>[c(t,{type:"primary",disabled:b(J)("channel:create")||!_e(l),size:"small",link:"",onClick:()=>Be(l)},{default:i((()=>[g(_(e.$t("addChild")),1)])),_:2},1032,["disabled","onClick"]),c(t,{type:"primary",disabled:b(J)("channel:update"),size:"small",link:"",onClick:()=>Qe(l.id)},{default:i((()=>[g(_(e.$t("edit")),1)])),_:2},1032,["disabled","onClick"]),c(z,{title:e.$t("confirmDelete"),onConfirm:()=>Oe([l.id])},{reference:i((()=>[c(t,{type:"primary",disabled:b(J)("channel:delete")||!_e(l),size:"small",link:""},{default:i((()=>[g(_(e.$t("delete")),1)])),_:2},1032,["disabled"])])),_:2},1032,["title","onConfirm"])])),_:1},8,["label"])])),_:1})])),_:1},8,["data","row-class-name"])),[[ye,y.value]])]),c(ll,{modelValue:f.value,"onUpdate:modelValue":n[9]||(n[9]=e=>f.value=e),"bean-id":k.value,"bean-ids":w.value,parent:V.value,onFinished:ze},null,8,["modelValue","bean-id","bean-ids","parent"]),c(dl,{modelValue:fe.value,"onUpdate:modelValue":n[10]||(n[10]=e=>fe.value=e),onFinished:ze},null,8,["modelValue"]),c(cl,{modelValue:ge.value,"onUpdate:modelValue":n[11]||(n[11]=e=>ge.value=e),onFinished:ze},null,8,["modelValue"])])),_:1})])),_:1})}}}))}}}));
