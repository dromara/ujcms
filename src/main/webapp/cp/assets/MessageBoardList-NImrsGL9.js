import{d as G,r as _,o as K,b as p,e as b,f as B,w as a,i as e,K as T,a7 as Q,a8 as O,ao as v,j as i,h as F,n as f,t as g,u as ue,aa as re,C as me,aA as ie,c as pe,k as P,aI as fe,ae as ge,aq as S,a_ as ve,E as H,ai as be,g as _e,S as ye,aG as ce,aH as Be}from"./index-B6OoDg6B.js";import{d as J,u as Ve,c as $e,a as ke,b as we,e as Ce}from"./interaction-BCiQ8biV.js";import{a as ze,_ as Se,b as Ue,c as qe}from"./QueryItem.vue_vue_type_script_setup_true_lang-Tf1Ym-Zs.js";import{h as Me}from"./config-DiPdhBV1.js";import{T as De}from"./Tinymce-B_tUWdg4.js";import{_ as Ie}from"./DialogForm.vue_vue_type_script_setup_true_lang-BCAZsuC3.js";const Te={key:0},Le=G({name:"MessageBoardForm",__name:"MessageBoardForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(L){const U=_(),l=_({}),$=_([]),q=async()=>{$.value=await Me()};return K(async()=>{q()}),(c,t)=>{const C=p("el-tag"),M=p("el-option"),k=p("el-select"),m=p("el-form-item"),r=p("el-col"),y=p("el-input"),D=p("el-switch"),E=p("el-date-picker"),z=p("el-row");return b(),B(Ie,{values:l.value,"onUpdate:values":t[11]||(t[11]=u=>l.value=u),name:c.$t("menu.interaction.messageBoard"),"query-bean":i(ke),"create-bean":i($e),"update-bean":i(Ve),"delete-bean":i(J),"bean-id":L.beanId,"bean-ids":L.beanIds,focus:U.value,"init-values":()=>{var u;return{typeId:(u=$.value[0])==null?void 0:u.id,userType:1,open:!0,status:0}},"to-values":u=>({...u}),perms:"messageBoard","model-value":L.modelValue,large:"","onUpdate:modelValue":t[12]||(t[12]=u=>c.$emit("update:modelValue",u)),onFinished:t[13]||(t[13]=()=>c.$emit("finished"))},{"header-status":a(({isEdit:u})=>[u?(b(),T(Q,{key:0},[l.value.status!=null?(b(),T("span",Te,[l.value.status===0?(b(),B(C,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[f(g(c.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):l.value.status===1?(b(),B(C,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[f(g(c.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):l.value.status===2?(b(),B(C,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[f(g(c.$t("messageBoard.status.".concat(l.value.status))),1)]),_:1})):(b(),B(C,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>t[14]||(t[14]=[f("unknown")])),_:1}))])):F("",!0)],64)):F("",!0)]),default:a(({isEdit:u})=>[e(z,null,{default:a(()=>[e(r,{span:24},{default:a(()=>[e(m,{prop:"typeId",rules:{required:!0,message:()=>c.$t("v.required")}},{label:a(()=>[e(v,{message:"messageBoard.type"})]),default:a(()=>[e(k,{modelValue:l.value.typeId,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.typeId=o),class:"w-full"},{default:a(()=>[(b(!0),T(Q,null,O($.value,o=>(b(),B(M,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"title",rules:{required:!0,message:()=>c.$t("v.required")}},{label:a(()=>[e(v,{message:"messageBoard.title"})]),default:a(()=>[e(y,{ref_key:"focus",ref:U,modelValue:l.value.title,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.title=o),maxlength:"150"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"text",rules:{required:!0,message:()=>c.$t("v.required")}},{label:a(()=>[e(v,{message:"messageBoard.text"})]),default:a(()=>[e(y,{modelValue:l.value.text,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.text=o),type:"textarea",rows:"8",maxlength:"65535"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),u?(b(),B(r,{key:0,span:24},{default:a(()=>[e(m,{prop:"replyText"},{label:a(()=>[e(v,{message:"messageBoard.replyText"})]),default:a(()=>[e(i(De),{modelValue:l.value.replyText,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.replyText=o),class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1})):F("",!0),e(r,{span:12},{default:a(()=>[e(m,{prop:"contact"},{label:a(()=>[e(v,{message:"messageBoard.contact"})]),default:a(()=>[e(y,{modelValue:l.value.contact,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.contact=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"nickname"},{label:a(()=>[e(v,{message:"messageBoard.nickname"})]),default:a(()=>[e(y,{modelValue:l.value.nickname,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.nickname=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"phone"},{label:a(()=>[e(v,{message:"messageBoard.phone"})]),default:a(()=>[e(y,{modelValue:l.value.phone,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.phone=o),maxlength:"30"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"email"},{label:a(()=>[e(v,{message:"messageBoard.email"})]),default:a(()=>[e(y,{modelValue:l.value.email,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.email=o),maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:24},{default:a(()=>[e(m,{prop:"address"},{label:a(()=>[e(v,{message:"messageBoard.address"})]),default:a(()=>[e(y,{modelValue:l.value.address,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.address=o),maxlength:"150"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"open"},{label:a(()=>[e(v,{message:"messageBoard.open"})]),default:a(()=>[e(D,{modelValue:l.value.open,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.open=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"recommended"},{label:a(()=>[e(v,{message:"messageBoard.recommended"})]),default:a(()=>[e(D,{modelValue:l.value.recommended,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.recommended=o)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replied"},{label:a(()=>[e(v,{message:"messageBoard.replied"})]),default:a(()=>[e(D,{"model-value":l.value.replied,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"ip"},{label:a(()=>[e(v,{message:"messageBoard.ip"})]),default:a(()=>[e(y,{"model-value":l.value.ip,disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"user"},{label:a(()=>[e(v,{message:"messageBoard.user"})]),default:a(()=>{var o;return[e(y,{"model-value":(o=l.value.user)==null?void 0:o.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"created"},{label:a(()=>[e(v,{message:"messageBoard.created"})]),default:a(()=>[e(E,{"model-value":l.value.created,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replyUser"},{label:a(()=>[e(v,{message:"messageBoard.replyUser"})]),default:a(()=>{var o;return[e(y,{"model-value":(o=l.value.replyUser)==null?void 0:o.username,disabled:""},null,8,["model-value"])]}),_:1})]),_:1}),e(r,{span:12},{default:a(()=>[e(m,{prop:"replyDate"},{label:a(()=>[e(v,{message:"messageBoard.replyDate"})]),default:a(()=>[e(E,{"model-value":l.value.replyDate,type:"datetime",class:"w-full",disabled:""},null,8,["model-value"])]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","init-values","to-values","model-value"])}}}),Ee={class:"mb-3"},Ne={class:"space-x-2"},he={class:"app-block"},Ae=G({name:"MessageBoardList",__name:"MessageBoardList",setup(L){var j;const{t:U}=ue(),l=_({}),$=_(),q=_(1),c=_(10),t=_(0),C=_(),M=_([]),k=_([]),m=_(!1),r=_(!1),y=_(),D=re(()=>M.value.map(s=>s.id)),E=me(),z=_(Number((j=E.query.status)!=null?j:"-1")),u=async()=>{m.value=!0;try{const{content:s,totalElements:n}=await we({...ie(l.value),Q_EQ_status:z.value!==-1?z.value:void 0,Q_OrderBy:$.value,page:q.value,pageSize:c.value});M.value=s,t.value=Number(n)}finally{m.value=!1}};K(u);const o=({column:s,prop:n,order:w})=>{var N;n&&w?$.value=((N=s.sortBy)!=null?N:n)+(w==="descending"?"_desc":""):$.value=void 0,u()},W=()=>u(),X=()=>{C.value.clearSort(),fe(l.value),$.value=void 0,u()},Z=()=>{y.value=void 0,r.value=!0},R=s=>{y.value=s,r.value=!0},Y=async s=>{await J(s),u(),H.success(U("success"))},x=async(s,n)=>{await Ce(s,n),u(),H.success(U("success"))};return(s,n)=>{const w=p("el-button"),N=p("el-icon"),ee=p("el-dropdown-item"),ae=p("el-dropdown-menu"),le=p("el-dropdown"),A=p("el-popconfirm"),h=p("el-radio-button"),se=p("el-radio-group"),V=p("el-table-column"),I=p("el-tag"),te=p("el-table"),oe=p("el-pagination"),de=pe("loading");return b(),T("div",null,[P("div",Ee,[e(i(Se),{params:l.value,onSearch:W,onReset:X},{default:a(()=>[e(i(ze),{label:s.$t("messageBoard.title"),name:"Q_Contains_title"},null,8,["label"])]),_:1},8,["params"])]),P("div",Ne,[e(w,{type:"primary",disabled:i(S)("messageBoard:create"),icon:i(ge),onClick:n[0]||(n[0]=()=>Z())},{default:a(()=>[f(g(s.$t("add")),1)]),_:1},8,["disabled","icon"]),e(le,{disabled:k.value.length<=0||i(S)("messageBoard:updateStatus")},{dropdown:a(()=>[e(ae,null,{default:a(()=>[(b(),T(Q,null,O([0,1,2],d=>e(ee,{key:d,onClick:()=>x(k.value.map(ne=>ne.id),d)},{default:a(()=>[f(g(s.$t("messageBoard.status.".concat(d))),1)]),_:2},1032,["onClick"])),64))]),_:1})]),default:a(()=>[e(w,{disabled:k.value.length<=0||i(S)("messageBoard:updateStatus")},{default:a(()=>[f(g(s.$t("messageBoard.op.status")),1),e(N,{class:"el-icon--right"},{default:a(()=>[e(i(ve))]),_:1})]),_:1},8,["disabled"])]),_:1},8,["disabled"]),e(A,{title:s.$t("confirmDelete"),onConfirm:n[1]||(n[1]=()=>Y(k.value.map(d=>d.id)))},{reference:a(()=>[e(w,{disabled:k.value.length<=0||i(S)("messageBoard:delete"),icon:i(be)},{default:a(()=>[f(g(s.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(i(Ue),{name:"messageBoard"})]),e(se,{modelValue:z.value,"onUpdate:modelValue":n[2]||(n[2]=d=>z.value=d),class:"mt-3",onChange:n[3]||(n[3]=()=>u())},{default:a(()=>[e(h,{value:-1},{default:a(()=>[f(g(s.$t("all")),1)]),_:1}),e(h,{value:0},{default:a(()=>[f(g(s.$t("messageBoard.status.0")),1)]),_:1}),e(h,{value:1},{default:a(()=>[f(g(s.$t("messageBoard.status.1")),1)]),_:1}),e(h,{value:2},{default:a(()=>[f(g(s.$t("messageBoard.status.2")),1)]),_:1})]),_:1},8,["modelValue"]),P("div",he,[_e((b(),B(te,{ref_key:"table",ref:C,data:M.value,onSelectionChange:n[4]||(n[4]=d=>k.value=d),onRowDblclick:n[5]||(n[5]=d=>R(d.id)),onSortChange:o},{default:a(()=>[e(i(qe),{name:"messageBoard"},{default:a(()=>[e(V,{type:"selection",width:"38"}),e(V,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(V,{property:"title",label:s.$t("messageBoard.title"),"min-width":"260",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(V,{property:"type.name",label:s.$t("messageBoard.type"),"min-width":"80","sort-by":"type@dict-name",sortable:"custom"},null,8,["label"]),e(V,{property:"user.username",label:s.$t("messageBoard.user"),"min-width":"80","sort-by":"user-username",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),e(V,{property:"created",label:s.$t("messageBoard.created"),"min-width":"120",sortable:"custom","show-overflow-tooltip":""},{default:a(({row:d})=>[f(g(i(ye)(d.created).format("YYYY-MM-DD HH:mm")),1)]),_:1},8,["label"]),e(V,{property:"replied",label:s.$t("messageBoard.replied"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[e(I,{type:d.replied?"success":"info",size:"small","disable-transitions":""},{default:a(()=>[f(g(s.$t(d.replied?"yes":"no")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(V,{property:"status",label:s.$t("messageBoard.status"),"min-width":"80",sortable:"custom"},{default:a(({row:d})=>[d.status===0?(b(),B(I,{key:0,type:"success",size:"small","disable-transitions":""},{default:a(()=>[f(g(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):d.status===1?(b(),B(I,{key:1,type:"info",size:"small","disable-transitions":""},{default:a(()=>[f(g(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):d.status===2?(b(),B(I,{key:2,type:"danger",size:"small","disable-transitions":""},{default:a(()=>[f(g(s.$t("messageBoard.status.".concat(d.status))),1)]),_:2},1024)):(b(),B(I,{key:3,type:"info",size:"small","disable-transitions":""},{default:a(()=>n[11]||(n[11]=[f("unknown")])),_:1}))]),_:1},8,["label"]),e(V,{label:s.$t("table.action")},{default:a(({row:d})=>[e(w,{type:"primary",disabled:i(S)("messageBoard:update"),size:"small",link:"",onClick:()=>R(d.id)},{default:a(()=>[f(g(s.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(A,{title:s.$t("confirmDelete"),onConfirm:()=>Y([d.id])},{reference:a(()=>[e(w,{type:"primary",disabled:i(S)("messageBoard:delete"),size:"small",link:""},{default:a(()=>[f(g(s.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[de,m.value]]),e(oe,{"current-page":q.value,"onUpdate:currentPage":n[6]||(n[6]=d=>q.value=d),pageSize:c.value,"onUpdate:pageSize":n[7]||(n[7]=d=>c.value=d),total:t.value,"page-sizes":i(Be),layout:i(ce),small:"",background:"",class:"justify-end px-3 py-2",onSizeChange:n[8]||(n[8]=()=>u()),onCurrentChange:n[9]||(n[9]=()=>u())},null,8,["current-page","pageSize","total","page-sizes","layout"])]),e(Le,{modelValue:r.value,"onUpdate:modelValue":n[10]||(n[10]=d=>r.value=d),"bean-id":y.value,"bean-ids":D.value,onFinished:u},null,8,["modelValue","bean-id","bean-ids"])])}}});export{Ae as default};
