import{d as Z,r as y,b as v,e as b,f as _,w as a,i as e,h as V,n as p,t as i,k as h,j as r,u as ee,aa as se,o as ae,aA as ne,c as le,K as G,aI as ue,ai as oe,aq as S,E as A,g as O,S as W,aG as re,aH as de,U as X,l as L,aZ as ie,ao as F,a7 as me,a8 as pe,V as fe}from"./index-B6OoDg6B.js";import{d as ve,e as be,u as ye,g as ce}from"./config-DiPdhBV1.js";import{a6 as ge,a7 as _e,a8 as x,a9 as ke,aa as $e,ab as he,ac as Ve}from"./content-2hwtLvQa.js";import{i as te,u as we,j as De,k as Se,l as Ce}from"./system-DEylFcMw.js";import{a as Ue,_ as qe,b as Ie,c as ze}from"./QueryItem.vue_vue_type_script_setup_true_lang-Tf1Ym-Zs.js";import{_ as He}from"./DialogForm.vue_vue_type_script_setup_true_lang-BCAZsuC3.js";const Fe={class:"whitespace-pre-wrap"},Ae=Z({name:"TaskForm",__name:"TaskForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(R){const t=y({});return(s,n)=>{const w=v("el-input"),d=v("el-form-item"),c=v("el-col"),z=v("el-date-picker"),C=v("el-option"),U=v("el-select"),q=v("el-tag"),P=v("el-row");return b(),_(He,{values:t.value,"onUpdate:values":n[7]||(n[7]=m=>t.value=m),name:s.$t("menu.system.task"),"query-bean":r(Se),"create-bean":r(De),"update-bean":r(we),"delete-bean":r(te),"bean-id":R.beanId,"bean-ids":R.beanIds,"init-values":()=>({user:{}}),"to-values":m=>({...m}),"disable-edit":()=>!0,addable:!1,perms:"task","model-value":R.modelValue,large:"","onUpdate:modelValue":n[8]||(n[8]=m=>s.$emit("update:modelValue",m)),onFinished:n[9]||(n[9]=()=>s.$emit("finished"))},{default:a(({})=>[e(P,null,{default:a(()=>[e(c,{span:12},{default:a(()=>[e(d,{prop:"name",label:s.$t("task.name")},{default:a(()=>[e(w,{modelValue:t.value.name,"onUpdate:modelValue":n[0]||(n[0]=m=>t.value.name=m)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"user.username",label:s.$t("task.user")},{default:a(()=>[e(w,{modelValue:t.value.user.username,"onUpdate:modelValue":n[1]||(n[1]=m=>t.value.user.username=m)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"beginDate",label:s.$t("task.beginDate")},{default:a(()=>[e(z,{modelValue:t.value.beginDate,"onUpdate:modelValue":n[2]||(n[2]=m=>t.value.beginDate=m),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"endDate",label:s.$t("task.endDate")},{default:a(()=>[e(z,{modelValue:t.value.endDate,"onUpdate:modelValue":n[3]||(n[3]=m=>t.value.endDate=m),type:"datetime"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"current",label:s.$t("task.current")},{default:a(()=>[e(w,{modelValue:t.value.current,"onUpdate:modelValue":n[4]||(n[4]=m=>t.value.current=m)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"processedIn",label:s.$t("task.processedIn")},{default:a(()=>[e(w,{modelValue:t.value.processedIn,"onUpdate:modelValue":n[5]||(n[5]=m=>t.value.processedIn=m)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{prop:"type",label:s.$t("task.type")},{default:a(()=>[t.value.type?(b(),_(U,{key:0,modelValue:t.value.type,"onUpdate:modelValue":n[6]||(n[6]=m=>t.value.type=m)},{default:a(()=>[e(C,{value:t.value.type,label:s.$t("task.type.".concat(t.value.type))},null,8,["value","label"])]),_:1},8,["modelValue"])):V("",!0)]),_:1},8,["label"])]),_:1}),e(c,{span:12},{default:a(()=>[e(d,{label:s.$t("task.status")},{default:a(()=>[t.value.status===0?(b(),_(q,{key:0,type:"info"},{default:a(()=>[p(i(s.$t("task.status.".concat(t.value.status))),1)]),_:1})):V("",!0),t.value.status===1?(b(),_(q,{key:1},{default:a(()=>[p(i(s.$t("task.status.".concat(t.value.status))),1)]),_:1})):V("",!0),t.value.status===2?(b(),_(q,{key:2,type:"danger"},{default:a(()=>[p(i(s.$t("task.status.".concat(t.value.status))),1)]),_:1})):V("",!0),t.value.status===3?(b(),_(q,{key:3,type:"warning"},{default:a(()=>[p(i(s.$t("task.status.".concat(t.value.status))),1)]),_:1})):V("",!0),t.value.status===4?(b(),_(q,{key:4,type:"success"},{default:a(()=>[p(i(s.$t("task.status.".concat(t.value.status))),1)]),_:1})):V("",!0)]),_:1},8,["label"])]),_:1}),t.value.errorInfo?(b(),_(c,{key:0,span:24},{default:a(()=>[e(d,{label:s.$t("task.errorInfo")},{default:a(()=>[h("pre",null,[h("code",Fe,i(t.value.errorInfo),1)])]),_:1},8,["label"])]),_:1})):V("",!0)]),_:1})]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","to-values","model-value"])}}}),Le={class:"mb-3"},Pe={class:"mt-3 app-block"},Re=Z({name:"TaskList",__name:"TaskList",setup(R,{expose:t}){const{t:s}=ee(),n=y({}),w=y(),d=y(1),c=y(10),z=y(0),C=y(),U=y([]),q=y([]),P=y(!1),m=y(!1),Y=y(),M=se(()=>U.value.map(l=>l.id)),I=async()=>{P.value=!0;try{const{content:l,totalElements:o}=await Ce({...ne(n.value),Q_OrderBy:w.value,page:d.value,pageSize:c.value});U.value=l,z.value=Number(o)}finally{P.value=!1}};ae(I);const E=({column:l,prop:o,order:k})=>{var H;o&&k?w.value=((H=l.sortBy)!=null?H:o)+(k==="descending"?"_desc":""):w.value=void 0,I()},N=()=>I(),j=()=>{C.value.clearSort(),ue(n.value),w.value=void 0,I()},B=l=>{Y.value=l,m.value=!0},f=async l=>{await te(l),I(),A.success(s("success"))};return t({fetchData:I}),(l,o)=>{const k=v("el-button"),H=v("el-popconfirm"),$=v("el-table-column"),D=v("el-tag"),T=v("el-table"),Q=v("el-pagination"),K=le("loading");return b(),G("div",null,[h("div",Le,[e(r(qe),{params:n.value,onSearch:N,onReset:j},{default:a(()=>[e(r(Ue),{label:l.$t("task.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),h("div",null,[e(H,{title:l.$t("confirmDelete"),onConfirm:o[0]||(o[0]=()=>f(q.value.map(u=>u.id)))},{reference:a(()=>[e(k,{disabled:q.value.length<=0||r(S)("task:delete"),icon:r(oe)},{default:a(()=>[p(i(l.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(r(Ie),{name:"task",class:"ml-2"})]),h("div",Pe,[O((b(),_(T,{ref_key:"table",ref:C,data:U.value,onSelectionChange:o[1]||(o[1]=u=>q.value=u),onRowDblclick:o[2]||(o[2]=u=>B(u.id)),onSortChange:E},{default:a(()=>[e(r(ze),{name:"task"},{default:a(()=>[e($,{type:"selection",width:"38"}),e($,{property:"id",label:"ID",width:"170",sortable:"custom"}),e($,{property:"name",label:l.$t("task.name"),sortable:"custom","min-width":"150","show-overflow-tooltip":""},null,8,["label"]),e($,{property:"beginDate",label:l.$t("task.beginDate"),sortable:"custom",width:"170"},{default:a(({row:u})=>[p(i(r(W)(u.beginDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e($,{property:"endDate",label:l.$t("task.endDate"),sortable:"custom",width:"170",display:"none"},{default:a(({row:u})=>[p(i(r(W)(u.endDate).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1},8,["label"]),e($,{property:"current",label:l.$t("task.current"),"min-width":"70",align:"right"},null,8,["label"]),e($,{property:"processedIn",label:l.$t("task.processedIn"),"min-width":"70",align:"right"},null,8,["label"]),e($,{property:"user.username",label:l.$t("task.user"),"sort-by":"user-username",sortable:"custom","min-width":"80",align:"right"},null,8,["label"]),e($,{property:"status",label:l.$t("task.status"),sortable:"custom",width:"80","show-overflow-tooltip":""},{default:a(({row:u})=>[u.status===0?(b(),_(D,{key:0,type:"info",size:"small"},{default:a(()=>[p(i(l.$t("task.status.".concat(u.status))),1)]),_:2},1024)):V("",!0),u.status===1?(b(),_(D,{key:1,size:"small"},{default:a(()=>[p(i(l.$t("task.status.".concat(u.status))),1)]),_:2},1024)):V("",!0),u.status===2?(b(),_(D,{key:2,type:"danger",size:"small"},{default:a(()=>[p(i(l.$t("task.status.".concat(u.status))),1)]),_:2},1024)):V("",!0),u.status===3?(b(),_(D,{key:3,type:"warning",size:"small"},{default:a(()=>[p(i(l.$t("task.status.".concat(u.status))),1)]),_:2},1024)):V("",!0),u.status===4?(b(),_(D,{key:4,type:"success",size:"small"},{default:a(()=>[p(i(l.$t("task.status.".concat(u.status))),1)]),_:2},1024)):V("",!0)]),_:1},8,["label"]),e($,{label:l.$t("table.action")},{default:a(({row:u})=>[e(k,{type:"primary",disabled:r(S)("task:show"),size:"small",link:"",onClick:()=>B(u.id)},{default:a(()=>[p(i(l.$t("detail")),1)]),_:2},1032,["disabled","onClick"]),e(H,{title:l.$t("confirmDelete"),onConfirm:()=>f([u.id])},{reference:a(()=>[e(k,{type:"primary",disabled:r(S)("task:delete"),size:"small",link:""},{default:a(()=>[p(i(l.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[K,P.value]]),e(Q,{"current-page":d.value,"onUpdate:currentPage":o[3]||(o[3]=u=>d.value=u),pageSize:c.value,"onUpdate:pageSize":o[4]||(o[4]=u=>c.value=u),total:z.value,"page-sizes":r(de),layout:r(re),small:"",background:"",class:"justify-end px-3 py-2",onSizeChange:o[5]||(o[5]=()=>I()),onCurrentChange:o[6]||(o[6]=()=>I())},null,8,["current-page","pageSize","total","page-sizes","layout"])]),e(Ae,{modelValue:m.value,"onUpdate:modelValue":o[7]||(o[7]=u=>m.value=u),"bean-id":Y.value,"bean-ids":M.value,onFinished:I},null,8,["modelValue","bean-id","bean-ids"])])}}}),Te={class:"p-3 app-block"},Ye={class:"p-3 mt-3 app-block"},Be={class:"pb-2 border-b text-gray-primary"},Ge={key:0,class:"p-3 mt-3 app-block"},Me={class:"pb-2 border-b text-gray-primary"},Ee={class:"p-3 mt-3 app-block"},Ne={class:"text-gray-primary"},We=Z({name:"GeneratorForm",__name:"GeneratorForm",setup(R){const{t}=ee(),s=y(!1),n=y(),w=y(),d=y({}),c=y(!1),z=y(),C=y({}),U=y(!1),q=async()=>{c.value=!0;try{d.value=await ve()}finally{c.value=!1}},P=async()=>{if(X("config:grey:show")){U.value=!0;try{C.value=await be()}finally{U.value=!1}}};ae(async()=>{q(),P()});const m=async()=>{s.value=!0;try{await ge(),await n.value.fetchData(),A.success(t("success"))}finally{s.value=!1}},Y=async()=>{s.value=!0;try{await _e(),await n.value.fetchData(),A.success(t("success"))}finally{s.value=!1}},M=async()=>{s.value=!0;try{await x(),await n.value.fetchData(),A.success(t("success"))}finally{s.value=!1}},I=async()=>{s.value=!0;try{await ke(),A.success(t("success"))}finally{s.value=!1}},E=async()=>{s.value=!0;try{await $e(),await n.value.fetchData(),A.success(t("success"))}finally{s.value=!1}},N=async()=>{s.value=!0;try{await he(),await n.value.fetchData(),A.success(t("success"))}finally{s.value=!1}},j=()=>{w.value&&w.value.validate(async f=>{if(f){c.value=!0;try{await ye(d.value),await x(),await n.value.fetchData(),A.success(t("success"))}finally{c.value=!1}}})},B=()=>{z.value&&z.value.validate(async f=>{if(f){U.value=!0;try{await ce(C.value),await Ve(),A.success(t("success"))}finally{U.value=!1}}})};return(f,l)=>{const o=v("el-button"),k=v("el-form-item"),H=v("el-form"),$=v("el-switch"),D=v("el-col"),T=v("el-input"),Q=v("el-option"),K=v("el-select"),u=v("el-row"),J=le("loading");return b(),G("div",null,[h("div",Te,[e(H,{"label-width":"200px"},{default:a(()=>[e(k,null,{label:a(()=>[e(F,{message:"generator.fulltext",help:""})]),default:a(()=>[e(o,{disabled:r(S)("generator:fulltext:reindexAll"),loading:s.value,type:"primary",plain:"",onClick:L(m,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.fulltext.reindexAll")),1)]),_:1},8,["disabled","loading"]),r(ie)("generator:fulltext:reindexSite")?(b(),_(o,{key:0,disabled:r(S)("generator:fulltext:reindexSite"),loading:s.value,type:"primary",plain:"",onClick:L(Y,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.fulltext.reindexSite")),1)]),_:1},8,["disabled","loading"])):V("",!0)]),_:1}),e(k,null,{label:a(()=>[e(F,{message:"generator.html",help:""})]),default:a(()=>[e(o,{disabled:r(S)("generator:html"),loading:s.value,type:"primary",plain:"",onClick:L(M,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.html.all")),1)]),_:1},8,["disabled","loading"]),l[7]||(l[7]=h("span",{class:"mx-2"},"|",-1)),e(o,{disabled:r(S)("generator:html"),loading:s.value,type:"primary",plain:"",onClick:L(I,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.html.home")),1)]),_:1},8,["disabled","loading"]),e(o,{disabled:r(S)("generator:html"),loading:s.value,type:"primary",plain:"",onClick:L(E,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.html.channel")),1)]),_:1},8,["disabled","loading"]),e(o,{disabled:r(S)("generator:html"),loading:s.value,type:"primary",plain:"",onClick:L(N,["prevent"])},{default:a(()=>[p(i(f.$t("generator.op.html.article")),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),h("div",Ye,[h("div",Be,i(f.$t("site.settings.html")),1),O((b(),_(H,{ref_key:"htmlForm",ref:w,class:"mt-3",model:d.value,disabled:r(S)("siteSettings:html:update"),"label-width":"200px"},{default:a(()=>[e(u,null,{default:a(()=>[e(D,{span:12},{default:a(()=>[e(k,{prop:"enabled",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"site.html.enabled",help:""})]),default:a(()=>[e($,{modelValue:d.value.enabled,"onUpdate:modelValue":l[0]||(l[0]=g=>d.value.enabled=g)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(D,{span:12},{default:a(()=>[e(k,{prop:"auto",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"site.html.auto",help:""})]),default:a(()=>[e($,{modelValue:d.value.auto,"onUpdate:modelValue":l[1]||(l[1]=g=>d.value.auto=g)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(D,{span:12},{default:a(()=>[e(k,{prop:"channel",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"site.html.channel",help:""})]),default:a(()=>[e(T,{modelValue:d.value.channel,"onUpdate:modelValue":l[2]||(l[2]=g=>d.value.channel=g),maxlength:"100"},{append:a(()=>l[8]||(l[8]=[p(".html")])),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(D,{span:12},{default:a(()=>[e(k,{prop:"article",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"site.html.article",help:""})]),default:a(()=>[e(T,{modelValue:d.value.article,"onUpdate:modelValue":l[3]||(l[3]=g=>d.value.article=g),maxlength:"100"},{append:a(()=>l[9]||(l[9]=[p(".html")])),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(D,{span:12},{default:a(()=>[e(k,{prop:"listPages",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"site.html.listPages",help:""})]),default:a(()=>[e(K,{modelValue:d.value.listPages,"onUpdate:modelValue":l[4]||(l[4]=g=>d.value.listPages=g),placeholder:"Select"},{default:a(()=>[(b(),G(me,null,pe([{label:"1",value:1},{label:"3",value:3},{label:"10",value:10},{label:"100",value:100},{label:"1000",value:1e3},{label:"全部",value:2147483647}],g=>e(Q,{key:g.value,label:g.label,value:g.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1},8,["rules"])]),_:1})]),_:1}),h("div",null,[e(o,{disabled:r(S)("siteSettings:html:update"),type:"primary","native-type":"submit",onClick:L(j,["prevent"])},{default:a(()=>[p(i(f.$t("submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model","disabled"])),[[J,c.value]])]),r(X)("config:grey:show")&&r(fe).epRank>=2?(b(),G("div",Ge,[h("div",Me,i(f.$t("config.settings.grey")),1),O((b(),_(H,{ref_key:"greyForm",ref:z,class:"mt-3",model:C.value,disabled:r(S)("config:grey:update"),"label-width":"200px"},{default:a(()=>[e(u,null,{default:a(()=>[e(D,{span:24},{default:a(()=>[e(k,{prop:"enabled",rules:{required:!0,message:()=>f.$t("v.required")}},{label:a(()=>[e(F,{message:"config.grey.enabled"})]),default:a(()=>[e($,{modelValue:C.value.enabled,"onUpdate:modelValue":l[5]||(l[5]=g=>C.value.enabled=g)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),e(D,{span:24},{default:a(()=>[e(k,{prop:"greyDates"},{label:a(()=>[e(F,{message:"config.grey.greyDates",help:""})]),default:a(()=>[e(T,{modelValue:C.value.greyDates,"onUpdate:modelValue":l[6]||(l[6]=g=>C.value.greyDates=g),maxlength:"1000"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),h("div",null,[e(o,{disabled:r(S)("config:grey:update"),type:"primary","native-type":"submit",onClick:L(B,["prevent"])},{default:a(()=>[p(i(f.$t("submit")),1)]),_:1},8,["disabled"])])]),_:1},8,["model","disabled"])),[[J,U.value]])])):V("",!0),h("div",Ee,[h("div",Ne,i(f.$t("generator.taskList")),1)]),e(Re,{ref_key:"taskListRef",ref:n,class:"mt-3"},null,512)])}}});export{We as default};
