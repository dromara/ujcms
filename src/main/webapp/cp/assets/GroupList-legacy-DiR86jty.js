System.register(["./index-legacy-CQEOokE5.js","./el-popover-legacy-C9sS1jAv.js","./user-legacy-B8b3b1V4.js","./QueryItem.vue_vue_type_script_setup_true_lang-legacy-DTLssd7y.js","./ListMove.vue_vue_type_script_setup_true_lang-legacy-DJMp98uN.js","./el-select-legacy-CL4hCdE4.js","./el-switch-legacy-BiBl0IYh.js","./DialogForm.vue_vue_type_script_setup_true_lang-legacy-DpwBBNYQ.js","./el-tree-legacy-LQ2ud7kH.js","./tree-legacy-D1Cv8xKE.js","./content-legacy-DpgkzqE7.js"],(function(e,l){"use strict";var a,u,t,s,o,d,n,i,r,c,p,m,v,b,y,f,g,_,h,V,$,k,w,C,P,A,j,U,x,F,I,q,S,E,G,D,z,B,N,Q,R,K,L,O,H,J,M,T,W,Z,X,Y,ee,le,ae,ue,te,se,oe,de;return{setters:[e=>{a=e.d,u=e.r,t=e.b,s=e.c,o=e.w,d=e.h,n=e.i,i=e.j,r=e.b3,c=e.P,p=e.aF,m=e.aG,v=e.k,b=e.A,y=e.u,f=e.ar,g=e.$,_=e.B,h=e.o,V=e.l,$=e.aO,k=e.v,w=e.x,C=e.m,P=e.t,A=e.E,j=e.b6,U=e.g,x=e.bi,F=e.bs,I=e.aW,q=e.b5,S=e.aZ,E=e.bI,G=e.e,D=e.y,z=e.aQ,B=e.aP},e=>{N=e.E},e=>{Q=e.F,R=e.G,K=e.H,L=e.I,O=e.J,H=e.K,J=e.b,M=e.L},e=>{T=e.E,W=e.a,Z=e._,X=e.b,Y=e.c},e=>{ee=e._},e=>{le=e.E,ae=e.a},e=>{ue=e.E},e=>{te=e._},e=>{se=e.E},e=>{oe=e.t},e=>{de=e.d}],execute:function(){const l=a({name:"GroupForm",__name:"GroupForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(e){const l=u(),a=u({});return(u,b)=>{const y=i,f=n,g=ue,_=ae,h=le;return t(),s(te,{values:a.value,"onUpdate:values":b[4]||(b[4]=e=>a.value=e),name:u.$t("menu.user.group"),"query-bean":v(L),"create-bean":v(K),"update-bean":v(R),"delete-bean":v(Q),"bean-id":e.beanId,"bean-ids":e.beanIds,focus:l.value,"init-values":()=>({type:2,allAccessPermission:!0}),"to-values":e=>({...e}),"disable-delete":e=>e.id<=10,perms:"group","model-value":e.modelValue,"onUpdate:modelValue":b[5]||(b[5]=e=>u.$emit("update:modelValue",e)),onFinished:b[6]||(b[6]=()=>u.$emit("finished"))},{default:o((({})=>[d(f,{prop:"name",label:u.$t("group.name"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:o((()=>[d(y,{ref_key:"focus",ref:l,modelValue:a.value.name,"onUpdate:modelValue":b[0]||(b[0]=e=>a.value.name=e),maxlength:"50"},null,8,["modelValue"])])),_:1},8,["label","rules"]),d(f,{prop:"description",label:u.$t("group.description")},{default:o((()=>[d(y,{modelValue:a.value.description,"onUpdate:modelValue":b[1]||(b[1]=e=>a.value.description=e),maxlength:"255"},null,8,["modelValue"])])),_:1},8,["label"]),d(f,{prop:"allAccessPermission"},{label:o((()=>[d(r,{message:"group.allAccessPermission"})])),default:o((()=>[d(g,{modelValue:a.value.allAccessPermission,"onUpdate:modelValue":b[2]||(b[2]=e=>a.value.allAccessPermission=e)},null,8,["modelValue"])])),_:1}),d(f,{prop:"type",label:u.$t("group.type"),rules:{required:!0,message:()=>u.$t("v.required")}},{default:o((()=>[d(h,{modelValue:a.value.type,"onUpdate:modelValue":b[3]||(b[3]=e=>a.value.type=e),disabled:1===a.value.type},{default:o((()=>[(t(),c(p,null,m([1,2],(e=>d(_,{key:e,disabled:1===e,label:u.$t(`group.type.${e}`),value:e},null,8,["disabled","label","value"]))),64))])),_:1},8,["modelValue","disabled"])])),_:1},8,["label","rules"])])),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","to-values","disable-delete","model-value"])}}}),ne={class:"border-t"},ie={class:"flex items-center justify-between"},re=a({name:"GroupPermissionForm",__name:"GroupPermissionForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null}},emits:{"update:modelValue":null,finished:null},setup(e,{emit:l}){const a=e,i=l,{beanId:m,modelValue:v}=b(a),{t:x}=y(),F=u(),I=u({}),q=u({}),S=u(!1),E=u(!0),G=u(!1),D=u(),z=u([]),B=f((()=>g.rank>I.value.rank));_(v,(()=>{v.value&&((async()=>{null!=m?.value&&(I.value=await L(m.value),q.value={...I.value})})(),(async()=>{if(null!=m?.value){const e=await O(m.value);D.value?.setCheckedKeys([]),e.forEach((e=>{D.value?.setChecked(e,!0,!1)}))}})())})),h((()=>{(async()=>{z.value=oe(await de())})()}));const N=(e,l,a,u)=>{a.forEach((a=>{a.children&&(l.getNode(a[u]).expanded=e,N(e,l,a.children,u))}))},Q=()=>{null!=D.value&&(q.value.accessPermissions=[...D.value.getCheckedNodes(),...D.value.getHalfCheckedNodes()].map((e=>e.id)))};return(l,a)=>{const u=ue,m=n,v=j,b=se,y=A,f=$,g=C,_=T;return t(),s(_,{title:l.$t("permissionSettings"),"model-value":e.modelValue,size:414,"onUpdate:modelValue":a[8]||(a[8]=e=>l.$emit("update:modelValue",e))},{default:o((()=>[d(y,{ref_key:"form",ref:F,model:q.value,disabled:B.value,"label-width":"150px"},{default:o((()=>[d(m,{prop:"allAccessPermission"},{label:o((()=>[d(r,{message:"group.allAccessPermission",help:""})])),default:o((()=>[d(u,{modelValue:q.value.allAccessPermission,"onUpdate:modelValue":a[0]||(a[0]=e=>q.value.allAccessPermission=e)},null,8,["modelValue"])])),_:1}),q.value.allAccessPermission?U("",!0):(t(),c(p,{key:0},[V("div",ne,[d(v,{modelValue:E.value,"onUpdate:modelValue":a[1]||(a[1]=e=>E.value=e),label:l.$t("expand/collapse"),onChange:a[2]||(a[2]=e=>N(e,D.value,z.value,"id"))},null,8,["modelValue","label"]),d(v,{modelValue:G.value,"onUpdate:modelValue":a[3]||(a[3]=e=>G.value=e),label:l.$t("checkAll/uncheckAll"),onChange:a[4]||(a[4]=e=>{((e,l,a,u)=>{l.setCheckedKeys(e?a.map((e=>e[u])):[])})(e,D.value,z.value,"id"),Q()})},null,8,["modelValue","label"])]),d(b,{ref_key:"accessPermissionTree",ref:D,data:z.value,"node-key":"id",props:{label:"name"},class:"border rounded","default-expand-all":"","show-checkbox":"",onCheck:a[5]||(a[5]=()=>Q())},null,8,["data"])],64))])),_:1},8,["model","disabled"])])),footer:o((()=>[V("div",ie,[V("div",null,[d(f,null,{default:o((()=>[k(w(q.value?.name),1)])),_:1})]),V("div",null,[d(g,{onClick:a[6]||(a[6]=()=>l.$emit("update:modelValue",!1))},{default:o((()=>[k(w(l.$t("cancel")),1)])),_:1}),d(g,{type:"primary",loading:S.value,disabled:B.value,onClick:a[7]||(a[7]=()=>{F.value.validate((async e=>{if(e){S.value=!0;try{await H(q.value),i("finished"),i("update:modelValue",!1),P.success(x("success"))}finally{S.value=!1}}}))})},{default:o((()=>[k(w(l.$t("save")),1)])),_:1},8,["loading","disabled"])])])])),_:1},8,["title","model-value"])}}}),ce={class:"mb-3"},pe={class:"mt-3 app-block"};e("default",a({name:"GroupList",__name:"GroupList",setup(e){const{t:a}=y(),n=u({}),i=u(),r=u(),p=u([]),m=u([]),b=u(!1),_=u(!1),A=u(!1),j=u(),R=f((()=>p.value.map((e=>e.id)))),K=u(!1),L=async()=>{b.value=!0;try{p.value=await J({...x(n.value),Q_OrderBy:i.value}),K.value=Object.values(n.value).filter((e=>void 0!==e&&""!==e)).length>0||void 0!==i.value}finally{b.value=!1}};h(L);const O=({column:e,prop:l,order:a})=>{i.value=l&&a?(e.sortBy??l)+("descending"===a?"_desc":""):void 0,L()},H=()=>L(),T=()=>{r.value.clearSort(),F(n.value),i.value=void 0,L()},le=()=>{j.value=void 0,_.value=!0},ae=e=>{j.value=e,_.value=!0},ue=e=>Number(e)>10,te=async e=>{const l=e.filter((e=>ue(e)));l.length>0&&(await Q(l),L(),P.success(a("success")))};return(e,a)=>{const u=C,i=N,y=z,f=$,h=B,P=D;return t(),c("div",null,[V("div",ce,[d(v(Z),{params:n.value,onSearch:H,onReset:T},{default:o((()=>[d(v(W),{label:e.$t("group.name"),name:"Q_Contains_name"},null,8,["label"]),d(v(W),{label:e.$t("group.description"),name:"Q_Contains_description"},null,8,["label"])])),_:1},8,["params"])]),V("div",null,[d(u,{type:"primary",disabled:v(q)("group:create"),icon:v(I),onClick:le},{default:o((()=>[k(w(e.$t("add")),1)])),_:1},8,["disabled","icon"]),d(i,{title:e.$t("confirmDelete"),onConfirm:a[0]||(a[0]=()=>te(m.value.map((e=>e.id))))},{reference:o((()=>[d(u,{disabled:m.value.filter((e=>ue(e.id))).length<=0||v(q)("group:delete"),icon:v(S)},{default:o((()=>[k(w(e.$t("delete")),1)])),_:1},8,["disabled","icon"])])),_:1},8,["title"]),d(ee,{class:"ml-2",disabled:m.value.length<=0||K.value||v(q)("org:update"),onMove:a[1]||(a[1]=e=>(async(e,l)=>{const a=E(e,p.value,l);await M(a.map((e=>e.id)))})(m.value,e))},null,8,["disabled"]),d(v(X),{name:"group",class:"ml-2"})]),V("div",pe,[G((t(),s(h,{ref_key:"table",ref:r,data:p.value,onSelectionChange:a[2]||(a[2]=e=>m.value=e),onRowDblclick:a[3]||(a[3]=e=>ae(e.id)),onSortChange:O},{default:o((()=>[d(v(Y),{name:"group"},{default:o((()=>[d(y,{type:"selection",width:"50"}),d(y,{property:"id",label:"ID",width:"170",sortable:"custom"}),d(y,{property:"name",label:e.$t("group.name"),sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),d(y,{property:"description",label:e.$t("group.description"),"min-width":"150",sortable:"custom","show-overflow-tooltip":""},null,8,["label"]),d(y,{property:"allAccessPermission",label:e.$t("group.allAccessPermission"),sortable:"custom"},{default:o((({row:l})=>[d(f,{type:l.allAccessPermission?"success":"info",size:"small"},{default:o((()=>[k(w(e.$t(l.allAccessPermission?"yes":"no")),1)])),_:2},1032,["type"])])),_:1},8,["label"]),d(y,{property:"type",label:e.$t("group.type"),sortable:"custom","show-overflow-tooltip":"",formatter:l=>e.$t(`group.type.${l.type}`)},null,8,["label","formatter"]),d(y,{label:e.$t("table.action")},{default:o((({row:l})=>[d(u,{type:"primary",disabled:v(q)("group:update"),size:"small",link:"",onClick:e=>ae(l.id)},{default:o((()=>[k(w(e.$t("edit")),1)])),_:2},1032,["disabled","onClick"]),v(g).epRank>0||v(g).epDisplay?(t(),s(u,{key:0,type:"primary",disabled:v(q)("group:updatePermission")||v(g).epRank<=0,title:v(g).epRank<=0?e.$t("error.enterprise.short"):void 0,size:"small",link:"",onClick:()=>{return e=l.id,j.value=e,void(A.value=!0);var e}},{default:o((()=>[k(w(e.$t("permissionSettings")),1)])),_:2},1032,["disabled","title","onClick"])):U("",!0),d(i,{title:e.$t("confirmDelete"),onConfirm:()=>te([l.id])},{reference:o((()=>[d(u,{type:"primary",disabled:!ue(l.id)||v(q)("group:delete"),size:"small",link:""},{default:o((()=>[k(w(e.$t("delete")),1)])),_:2},1032,["disabled"])])),_:2},1032,["title","onConfirm"])])),_:1},8,["label"])])),_:1})])),_:1},8,["data"])),[[P,b.value]])]),d(l,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=e=>_.value=e),"bean-id":j.value,"bean-ids":R.value,onFinished:L},null,8,["modelValue","bean-id","bean-ids"]),d(re,{modelValue:A.value,"onUpdate:modelValue":a[5]||(a[5]=e=>A.value=e),"bean-id":j.value,onFinished:L},null,8,["modelValue","bean-id"])])}}}))}}}));
