import{d as U,r as i,b,e as C,f as E,w as l,i as e,ao as I,j as t,u as K,aa as x,o as G,aA as H,E as q,aB as J,c as W,K as X,k,aI as Y,n as $,t as w,ae as Z,aq as _,ai as ee,g as ae,af as se,aD as le}from"./index-B6OoDg6B.js";import{S as te}from"./sortable.esm-DEaZq8gs.js";import{a7 as F,a8 as oe,a9 as ne,aa as de,h as ie,ab as re}from"./config-DiPdhBV1.js";import{a as ue,_ as me,b as pe,c as ce}from"./QueryItem.vue_vue_type_script_setup_true_lang-Tf1Ym-Zs.js";import{_ as be}from"./DialogForm.vue_vue_type_script_setup_true_lang-BCAZsuC3.js";const fe=U({name:"MessageBoardTypeForm",__name:"MessageBoardTypeForm",props:{modelValue:{type:Boolean,required:!0},beanId:{type:String,default:null},beanIds:{type:Array,required:!0}},emits:{"update:modelValue":null,finished:null},setup(B){const g=i(),r=i({});return(u,o)=>{const m=b("el-input"),f=b("el-form-item");return C(),E(be,{values:r.value,"onUpdate:values":o[2]||(o[2]=n=>r.value=n),name:u.$t("menu.config.messageBoardType"),"query-bean":t(de),"create-bean":t(ne),"update-bean":t(oe),"delete-bean":t(F),"bean-id":B.beanId,"bean-ids":B.beanIds,focus:g.value,"init-values":()=>({}),"to-values":n=>({...n}),"model-value":B.modelValue,perms:"messageBoardType","onUpdate:modelValue":o[3]||(o[3]=n=>u.$emit("update:modelValue",n)),onFinished:o[4]||(o[4]=()=>u.$emit("finished"))},{default:l(({})=>[e(f,{prop:"name",rules:{required:!0,message:()=>u.$t("v.required")}},{label:l(()=>[e(I,{message:"messageBoardType.name"})]),default:l(()=>[e(m,{ref_key:"focus",ref:g,modelValue:r.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>r.value.name=n),maxlength:"30"},null,8,["modelValue"])]),_:1},8,["rules"]),e(f,{prop:"description"},{label:l(()=>[e(I,{message:"messageBoardType.description"})]),default:l(()=>[e(m,{modelValue:r.value.description,"onUpdate:modelValue":o[1]||(o[1]=n=>r.value.description=n),type:"textarea",rows:3,maxlength:"300"},null,8,["modelValue"])]),_:1})]),_:1},8,["values","name","query-bean","create-bean","update-bean","delete-bean","bean-id","bean-ids","focus","to-values","model-value"])}}}),ve={class:"mb-3"},ye={class:"space-x-2"},ge={class:"mt-3 app-block"},Ve=U({name:"MessageBoardTypeList",__name:"MessageBoardTypeList",setup(B){const{t:g}=K(),r=i({}),u=i(),o=i(),m=i([]),f=i([]),n=i(!1),T=i(!1),V=i(),z=x(()=>m.value.map(a=>a.id)),M=i(!1),v=async()=>{n.value=!0;try{m.value=await ie({...H(r.value),Q_OrderBy:u.value}),M.value=u.value!==void 0}finally{n.value=!1}};let h;const A=()=>{const a=document.querySelector("#dataTable .el-table__body-wrapper tbody");h=te.create(a,{handle:".drag-handle",animation:200,chosenClass:"sortable-chosen",onEnd:async function(s){const{oldIndex:d,newIndex:c}=s;d!==c&&(await re(m.value[d].id,m.value[c].id),m.value.splice(c,0,m.value.splice(d,1)[0]),q.success(g("success")))}})};G(()=>{v(),A()}),J(()=>{h!==void 0&&h.destroy()});const L=({column:a,prop:s,order:d})=>{var c;s&&d?u.value=((c=a.sortBy)!=null?c:s)+(d==="descending"?"_desc":""):u.value=void 0,v()},N=()=>v(),R=()=>{o.value.clearSort(),Y(r.value),u.value=void 0,v()},O=()=>{V.value=void 0,T.value=!0},S=a=>{V.value=a,T.value=!0},D=async a=>{await F(a),v(),q.success(g("success"))};return(a,s)=>{const d=b("el-button"),c=b("el-popconfirm"),y=b("el-table-column"),P=b("el-icon"),Q=b("el-table"),j=W("loading");return C(),X("div",null,[k("div",ve,[e(t(me),{params:r.value,onSearch:N,onReset:s[0]||(s[0]=()=>R())},{default:l(()=>[e(t(ue),{label:a.$t("messageBoardType.name"),name:"Q_Contains_name"},null,8,["label"])]),_:1},8,["params"])]),k("div",ye,[e(d,{type:"primary",disabled:t(_)("messageBoardType:create"),icon:t(Z),onClick:s[1]||(s[1]=()=>O())},{default:l(()=>[$(w(a.$t("add")),1)]),_:1},8,["disabled","icon"]),e(c,{title:a.$t("confirmDelete"),onConfirm:s[2]||(s[2]=()=>D(f.value.map(p=>p.id)))},{reference:l(()=>[e(d,{disabled:f.value.length<=0||t(_)("messageBoardType:delete"),icon:t(ee)},{default:l(()=>[$(w(a.$t("delete")),1)]),_:1},8,["disabled","icon"])]),_:1},8,["title"]),e(t(pe),{name:"messageBoardType"})]),k("div",ge,[ae((C(),E(Q,{id:"dataTable",ref_key:"table",ref:o,"row-key":"id",data:m.value,onSelectionChange:s[3]||(s[3]=p=>f.value=p),onRowDblclick:s[4]||(s[4]=p=>S(p.id)),onSortChange:L},{default:l(()=>[e(t(ce),{name:"messageBoardType"},{default:l(()=>[e(y,{type:"selection",width:"38"}),e(y,{width:"42"},{default:l(()=>[e(P,{class:se(["text-lg align-middle",M.value||t(_)("messageBoardType:update")?["cursor-not-allowed","text-gray-disabled"]:["cursor-move","text-gray-secondary","drag-handle"]]),disalbed:""},{default:l(()=>[e(t(le))]),_:1},8,["class"])]),_:1}),e(y,{property:"id",label:"ID",width:"170",sortable:"custom"}),e(y,{property:"name",label:a.$t("messageBoardType.name"),sortable:"custom","min-width":120,"show-overflow-tooltip":""},null,8,["label"]),e(y,{property:"description",label:a.$t("messageBoardType.description"),sortable:"custom","min-width":240,"show-overflow-tooltip":""},null,8,["label"]),e(y,{label:a.$t("table.action")},{default:l(({row:p})=>[e(d,{type:"primary",disabled:t(_)("messageBoardType:update"),size:"small",link:"",onClick:()=>S(p.id)},{default:l(()=>[$(w(a.$t("edit")),1)]),_:2},1032,["disabled","onClick"]),e(c,{title:a.$t("confirmDelete"),onConfirm:()=>D([p.id])},{reference:l(()=>[e(d,{type:"primary",disabled:t(_)("messageBoardType:delete"),size:"small",link:""},{default:l(()=>[$(w(a.$t("delete")),1)]),_:1},8,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1})]),_:1},8,["data"])),[[j,n.value]])]),e(fe,{modelValue:T.value,"onUpdate:modelValue":s[5]||(s[5]=p=>T.value=p),"bean-id":V.value,"bean-ids":z.value,onFinished:s[6]||(s[6]=()=>v())},null,8,["modelValue","bean-id","bean-ids"])])}}});export{Ve as default};
