(e=>{"function"==typeof define&&define.amd?define(["jquery","load-image","load-image-meta","load-image-scale","load-image-exif","load-image-orientation","canvas-to-blob","./jquery.fileupload-process"],e):"object"==typeof exports?e(require("jquery"),require("blueimp-load-image/js/load-image"),require("blueimp-load-image/js/load-image-meta"),require("blueimp-load-image/js/load-image-scale"),require("blueimp-load-image/js/load-image-exif"),require("blueimp-load-image/js/load-image-orientation"),require("blueimp-canvas-to-blob"),require("./jquery.fileupload-process")):e(window.jQuery,window.loadImage)})(function(l,r){l.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",maxMetaDataSize:"@",disableImageHead:"@",disableMetaDataParsers:"@",disableExif:"@",disableExifOffsets:"@",includeExifTags:"@",excludeExifTags:"@",disableIptc:"@",disableIptcOffsets:"@",includeIptcTags:"@",excludeIptcTags:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:!0,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize",imageSmoothingQuality:"@imageSmoothingQuality"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"},{action:"deleteImageReferences",disabled:"@disableImageReferencesDeletion"}),l.widget("blueimp.fileupload",l.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png|svg\+xml)$/,loadImageMaxFileSize:1e7,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:!0,imageCrop:!1,disableImageResize:!0,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:!0,previewThumbnail:!0,previewCrop:!1,previewCanvas:!0},processActions:{loadImage:function(i,e){var a,t,n;return e.disabled||(a=this,t=i.files[i.index],n=l.Deferred(),"number"===l.type(e.maxFileSize)&&t.size>e.maxFileSize)||e.fileTypes&&!e.fileTypes.test(t.type)||!r(t,function(e){e.src&&(i.img=e),n.resolveWith(a,[i])},e)?i:n.promise()},resizeImage:function(i,a){if(a.disabled||!i.canvas&&!i.img)return i;a=l.extend({canvas:!0},a);function e(e){e&&(e.width!==s.width||e.height!==s.height||a.forceResize)&&(i[e.getContext?"canvas":"img"]=e),i.preview=e,o.resolveWith(n,[i])}var t,n=this,o=l.Deferred(),s=a.canvas&&i.canvas||i.img;return i.exif&&a.thumbnail&&(t=(t=i.exif.get("Thumbnail"))&&t.get("Blob"))?(a.orientation=i.exif.get("Orientation"),r(t,e,a),o.promise()):(i.orientation?delete a.orientation:i.orientation=a.orientation||r.orientation,s?(e(r.scale(s,a,i)),o.promise()):i)},saveImage:function(i,e){var a,t,n;return i.canvas&&!e.disabled&&(a=this,t=i.files[i.index],n=l.Deferred(),i.canvas.toBlob)?(i.canvas.toBlob(function(e){e.name||(t.type===e.type?e.name=t.name:t.name&&(e.name=t.name.replace(/\.\w+$/,"."+e.type.substr(6)))),t.type!==e.type&&delete i.imageHead,i.files[i.index]=e,n.resolveWith(a,[i])},e.type||t.type,e.quality),n.promise()):i},loadImageMetaData:function(i,e){var a,t;return e.disabled?i:(a=this,t=l.Deferred(),r.parseMetaData(i.files[i.index],function(e){l.extend(i,e),t.resolveWith(a,[i])},e),t.promise())},saveImageMetaData:function(i,e){var a,t,n;return i.imageHead&&i.canvas&&i.canvas.toBlob&&!e.disabled?(a=this,t=i.files[i.index],n=l.Deferred(),!0===i.orientation&&i.exifOffsets&&r.writeExifData(i.imageHead,i,"Orientation",1),r.replaceHead(t,i.imageHead,function(e){e.name=t.name,i.files[i.index]=e,n.resolveWith(a,[i])}),n.promise()):i},setImage:function(e,i){return e.preview&&!i.disabled&&(e.files[e.index][i.name||"preview"]=e.preview),e},deleteImageReferences:function(e,i){return i.disabled||(delete e.img,delete e.canvas,delete e.preview,delete e.imageHead),e}}})});